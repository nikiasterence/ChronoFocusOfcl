<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="Chronofocus.png" type="image/x-icon">
    <title>Ai cv by cozytustudios</title>
    <!-- External Libraries for Exporting CV -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://unpkg.com/html-to-docx/dist/html-to-docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #6b8cbc;
            --accent: #ff7e5f;
            --light: #f5f7fa;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .step-container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .step-number {
            background-color: var(--primary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .step-title {
            font-size: 1.5rem;
            color: var(--dark);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.2);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary);
        }
        
        .btn-secondary {
            background-color: #e9ecef;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background-color: #dde1e6;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .theme-options, .layout-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .theme-option, .layout-option {
            border: 2px solid #eee;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .theme-option:hover, .layout-option:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }
        
        .theme-option.active, .layout-option.active {
            border-color: var(--primary);
            background-color: rgba(74, 111, 165, 0.05);
        }
        
        .theme-preview {
            height: 30px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .basic-theme { background: linear-gradient(90deg, #f8f9fa, #e9ecef); }
        .work-theme { background: linear-gradient(90deg, #4a6fa5, #6b8cbc); }
        .pro-theme { background: linear-gradient(90deg, #2c3e50, #34495e); }
        .cozy-theme { background: linear-gradient(90deg, #e67e22, #f39c12); }
        .productive-theme { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .elegant-theme { background: linear-gradient(90deg, #9b59b6, #8e44ad); }
        
        .cv-preview-container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .cv-preview {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 30px;
            min-height: 800px;
            background: white;
        }
        
        .hidden {
            display: none;
        }
        
        .export-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .export-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .pdf-btn {
            background-color: #e74c3c;
            color: white;
        }
        
        .docx-btn {
            background-color: #2c3e50;
            color: white;
        }
        
        .png-btn {
            background-color: #3498db;
            color: white;
        }
        
        .section-title {
            font-size: 1.3rem;
            margin: 25px 0 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .personal-info {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .profile-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 25px;
            border: 3px solid var(--primary);
        }
        
        .name-title {
            flex: 1;
        }
        
        .name {
            font-size: 2rem;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .title {
            font-size: 1.2rem;
            color: var(--secondary);
        }
        
        .contact-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .timeline-item {
            margin-bottom: 20px;
            padding-left: 20px;
            border-left: 2px solid var(--primary);
        }
        
        .timeline-date {
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 5px;
        }
        
        .timeline-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .timeline-subtitle {
            color: #666;
            margin-bottom: 8px;
        }
        
        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .skill-tag {
            background-color: var(--light);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }
        
        .sidebar {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
        }
        
        .main-content {
            padding: 0 10px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .personal-info {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-img {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .theme-options, .layout-options {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI CV with Optichain</h1>
            <p class="subtitle">Create professional, creative, and customizable CVs in minutes</p>
        </header>
        
        <!-- Step 1: Personal Information -->
        <div class="step-container" id="step1">
            <div class="step-header">
                <div class="step-number">1</div>
                <h2 class="step-title">Personal Information</h2>
            </div>
            
            <form id="personalInfoForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <input type="text" id="fullName" placeholder="John Doe" required>
                    </div>
                    <div class="form-group">
                        <label for="profileImage">Profile Image</label>
                        <input type="file" id="profileImage" accept="image/*">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="dateOfBirth">Date of Birth</label>
                        <input type="date" id="dateOfBirth">
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" placeholder="+1 (123) 456-7890">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" placeholder="john.doe@example.com" required>
                </div>
                
                <div class="form-group">
                    <label for="address">Address</label>
                    <input type="text" id="address" placeholder="123 Main St, City, Country">
                </div>
                
                <div class="form-group">
                    <label for="careerObjective">Career Objective / Personal Statement</label>
                    <textarea id="careerObjective" placeholder="A brief summary of your career goals and what you bring to the table..."></textarea>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="btn btn-primary" onclick="nextStep(2)">Next Step</button>
                </div>
            </form>
        </div>
        
        <!-- Step 2: Education & Experience -->
        <div class="step-container hidden" id="step2">
            <div class="step-header">
                <div class="step-number">2</div>
                <h2 class="step-title">Education & Experience</h2>
            </div>
            
            <div class="form-group">
                <label for="education">Education Details</label>
                <textarea id="education" placeholder="University Name, Degree, Year, Grades..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="workExperience">Work Experience</label>
                <textarea id="workExperience" placeholder="Company, Role, Dates, Achievements..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="skills">Skills</label>
                <textarea id="skills" placeholder="Technical skills, soft skills, languages..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="projects">Projects</label>
                <textarea id="projects" placeholder="Academic, work, or personal projects..."></textarea>
            </div>
            
            <div class="btn-group">
                <button type="button" class="btn btn-secondary" onclick="prevStep(1)">Previous</button>
                <button type="button" class="btn btn-primary" onclick="nextStep(3)">Next Step</button>
            </div>
        </div>
        
        <!-- Step 3: Additional Information -->
        <div class="step-container hidden" id="step3">
            <div class="step-header">
                <div class="step-number">3</div>
                <h2 class="step-title">Additional Information</h2>
            </div>
            
            <div class="form-group">
                <label for="certifications">Certifications / Awards / Honors</label>
                <textarea id="certifications" placeholder="List any certifications, awards, or honors..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="hobbies">Hobbies & Interests</label>
                <textarea id="hobbies" placeholder="Your hobbies and interests..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="references">References</label>
                <textarea id="references" placeholder="References (if needed)..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="extra">Extra Information</label>
                <textarea id="extra" placeholder="For marriage CV: family background, religion, partner expectations, etc."></textarea>
            </div>
            
            <div class="btn-group">
                <button type="button" class="btn btn-secondary" onclick="prevStep(2)">Previous</button>
                <button type="button" class="btn btn-primary" onclick="nextStep(4)">Next Step</button>
            </div>
        </div>
        
        <!-- Step 4: CV Purpose -->
        <div class="step-container hidden" id="step4">
            <div class="step-header">
                <div class="step-number">4</div>
                <h2 class="step-title">Choose CV Purpose</h2>
            </div>
            
            <div class="form-group">
                <label>What type of CV do you need?</label>
                <div class="theme-options">
                    <div class="theme-option active" data-purpose="work">
                        <h3>Work</h3>
                        <p>Professional employment</p>
                    </div>
                    <div class="theme-option" data-purpose="academic">
                        <h3>Academic</h3>
                        <p>School / University</p>
                    </div>
                    <div class="theme-option" data-purpose="marriage">
                        <h3>Marriage</h3>
                        <p>Personal / Matrimonial</p>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button type="button" class="btn btn-secondary" onclick="prevStep(3)">Previous</button>
                <button type="button" class="btn btn-primary" onclick="nextStep(5)">Next Step</button>
            </div>
        </div>
        
        <!-- Step 5: Themes & Layouts -->
        <div class="step-container hidden" id="step5">
            <div class="step-header">
                <div class="step-number">5</div>
                <h2 class="step-title">Choose Theme & Layout</h2>
            </div>
            
            <div class="form-group">
                <label>Select a Theme</label>
                <div class="theme-options">
                    <div class="theme-option active" data-theme="basic">
                        <div class="theme-preview basic-theme"></div>
                        <h3>Basic</h3>
                        <p>Clean and simple</p>
                    </div>
                    <div class="theme-option" data-theme="work">
                        <div class="theme-preview work-theme"></div>
                        <h3>Work</h3>
                        <p>Professional</p>
                    </div>
                    <div class="theme-option" data-theme="pro">
                        <div class="theme-preview pro-theme"></div>
                        <h3>Pro</h3>
                        <p>Executive level</p>
                    </div>
                    <div class="theme-option" data-theme="cozy">
                        <div class="theme-preview cozy-theme"></div>
                        <h3>Cozy</h3>
                        <p>Warm and friendly</p>
                    </div>
                    <div class="theme-option" data-theme="productive">
                        <div class="theme-preview productive-theme"></div>
                        <h3>Productive</h3>
                        <p>Efficient and modern</p>
                    </div>
                    <div class="theme-option" data-theme="elegant">
                        <div class="theme-preview elegant-theme"></div>
                        <h3>Elegant</h3>
                        <p>Sophisticated style</p>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>Select a Layout</label>
                <div class="layout-options">
                    <div class="layout-option active" data-layout="minimalist">
                        <h3>Minimalist</h3>
                        <p>Clean and simple</p>
                    </div>
                    <div class="layout-option" data-layout="two-column">
                        <h3>Two-Column</h3>
                        <p>Balanced layout</p>
                    </div>
                    <div class="layout-option" data-layout="modern">
                        <h3>Modern</h3>
                        <p>Contemporary design</p>
                    </div>
                    <div class="layout-option" data-layout="classic">
                        <h3>Classic</h3>
                        <p>Traditional format</p>
                    </div>
                    <div class="layout-option" data-layout="infographic">
                        <h3>Infographic</h3>
                        <p>Visual elements</p>
                    </div>
                    <div class="layout-option" data-layout="bold">
                        <h3>Bold</h3>
                        <p>Strong visual impact</p>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button type="button" class="btn btn-secondary" onclick="prevStep(4)">Previous</button>
                <button type="button" class="btn btn-success" onclick="nextStep(6)">Generate CV</button>
            </div>
        </div>
        
        <!-- Step 6: CV Preview & Export -->
        <div class="step-container hidden" id="step6">
            <div class="step-header">
                <div class="step-number">6</div>
                <h2 class="step-title">Your CV Preview</h2>
            </div>
            
            <div class="cv-preview-container">
                <div class="cv-preview" id="cvPreview">
                    <!-- CV content will be generated here -->
                </div>
            </div>
            
            <div class="export-options">
                <button class="export-btn pdf-btn" onclick="exportCV('pdf')">
                    <span>Download PDF</span>
                </button>
                <button class="export-btn docx-btn" onclick="exportCV('docx')">
                    <span>Download DOCX</span>
                </button>
                <button class="export-btn png-btn" onclick="exportCV('png')">
                    <span>Download PNG</span>
                </button>
            </div>
            
            <div class="btn-group">
                <button type="button" class="btn btn-secondary" onclick="prevStep(5)">Edit Content</button>
                <button type="button" class="btn btn-primary" onclick="changeThemeLayout()">Change Theme/Layout</button>
            </div>
        </div>
    </div>

    <script>
        // Current step tracking
        let currentStep = 1;
        let selectedPurpose = 'work';
        let selectedTheme = 'basic';
        let selectedLayout = 'minimalist';
        let profileImageSrc = '';

        // Function to navigate to next step
        function nextStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
            
            // If we're going to the preview step, generate the CV
            if (step === 6) {
                generateCV();
            }
        }
        
        // Function to navigate to previous step
        function prevStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
        }
        
        // Function to change theme and layout
        function changeThemeLayout() {
            prevStep(5);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Add live preview listeners to all inputs
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', generateCV);
            });

            // Handle image upload
            const profileImageInput = document.getElementById('profileImage');
            profileImageInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        profileImageSrc = e.target.result;
                        generateCV();
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Set up theme, layout, and purpose selection
            setupSelection('.theme-option[data-theme]', 'active', (value) => { selectedTheme = value; generateCV(); });
            setupSelection('.layout-option[data-layout]', 'active', (value) => { selectedLayout = value; generateCV(); });
            setupSelection('.theme-option[data-purpose]', 'active', (value) => { selectedPurpose = value; generateCV(); });
        });

        // Helper for selection logic
        function setupSelection(selector, activeClass, callback) {
            const options = document.querySelectorAll(selector);
            options.forEach(option => {
                option.addEventListener('click', function() {
                    options.forEach(opt => opt.classList.remove(activeClass));
                    this.classList.add(activeClass);
                    callback(this.dataset[Object.keys(this.dataset)[0]]);
                });
            });
        }
        
        // Function to generate the CV preview
        function generateCV() {
            if (currentStep !== 6) return;

            const cvPreview = document.getElementById('cvPreview');
            
            // Get form values
            const formValues = {
                fullName: document.getElementById('fullName').value || 'Your Name',
                profileImage: profileImageSrc,
                dateOfBirth: document.getElementById('dateOfBirth').value,
                phone: document.getElementById('phone').value || '+1 (123) 456-7890',
                email: document.getElementById('email').value || 'your.email@example.com',
                address: document.getElementById('address').value || 'Your City, Country',
                careerObjective: document.getElementById('careerObjective').value || 'A motivated professional seeking new opportunities...',
                education: document.getElementById('education').value || 'University Name, Degree, Year, Grades',
                workExperience: document.getElementById('workExperience').value || 'Company, Role, Dates, Achievements',
                skills: document.getElementById('skills').value || 'Technical skills, soft skills, languages',
                projects: document.getElementById('projects').value || 'Academic, work, or personal projects',
                certifications: document.getElementById('certifications').value || 'Certifications, awards, honors',
                hobbies: document.getElementById('hobbies').value || 'Your hobbies and interests',
                references: document.getElementById('references').value || 'References available upon request',
                extra: document.getElementById('extra').value,
            };
            
            let cvHTML = '';
            
            if (selectedLayout === 'two-column') {
                cvHTML = generateTwoColumnCV(formValues);
            } else {
                cvHTML = generateStandardCV(formValues);
            }
            
            cvPreview.innerHTML = cvHTML;
            applyTheme(selectedTheme);
        }
        
        function generateStandardCV(data) {
            return `
                <div class="personal-info">
                    ${data.profileImage ? `<img src="${data.profileImage}" alt="Profile" class="profile-img">` : ''}
                    <div class="name-title">
                        <h1 class="name">${data.fullName}</h1>
                        <p class="title">${selectedPurpose === 'work' ? 'Professional' : selectedPurpose === 'academic' ? 'Student' : 'Personal'} CV</p>
                        <div class="contact-info">
                            ${data.phone ? `<div class="contact-item">📞 ${data.phone}</div>` : ''}
                            ${data.email ? `<div class="contact-item">✉️ ${data.email}</div>` : ''}
                            ${data.address ? `<div class="contact-item">📍 ${data.address}</div>` : ''}
                            ${data.dateOfBirth ? `<div class="contact-item">🎂 ${formatDate(data.dateOfBirth)}</div>` : ''}
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Career Objective</div>
                <p>${data.careerObjective}</p>
                
                ${data.education ? `
                <div class="section-title">Education</div>
                <div class="timeline">
                    ${formatTextAsTimeline(data.education)}
                </div>
                ` : ''}
                
                ${data.workExperience ? `
                <div class="section-title">Work Experience</div>
                <div class="timeline">
                    ${formatTextAsTimeline(data.workExperience)}
                </div>
                ` : ''}
                
                ${data.skills ? `
                <div class="section-title">Skills</div>
                <div class="skills-list">
                    ${formatTextAsSkills(data.skills)}
                </div>
                ` : ''}
                
                ${data.projects ? `
                <div class="section-title">Projects</div>
                <div class="timeline">
                    ${formatTextAsTimeline(data.projects)}
                </div>
                ` : ''}
                
                ${data.certifications ? `
                <div class="section-title">Certifications & Awards</div>
                <div class="timeline">
                    ${formatTextAsTimeline(data.certifications)}
                </div>
                ` : ''}
                
                ${data.hobbies ? `
                <div class="section-title">Hobbies & Interests</div>
                <p>${data.hobbies}</p>
                ` : ''}
                
                ${selectedPurpose === 'marriage' && data.extra ? `
                <div class="section-title">Additional Information</div>
                <p>${data.extra}</p>
                ` : ''}
                
                ${data.references ? `
                <div class="section-title">References</div>
                <p>${data.references}</p>
                ` : ''}
            `;
        }

        function generateTwoColumnCV(data) {
            return `
                <div class="personal-info">
                    ${data.profileImage ? `<img src="${data.profileImage}" alt="Profile" class="profile-img">` : ''}
                    <div class="name-title">
                        <h1 class="name">${data.fullName}</h1>
                        <p class="title">${selectedPurpose === 'work' ? 'Professional' : selectedPurpose === 'academic' ? 'Student' : 'Personal'} CV</p>
                    </div>
                </div>
                
                <div class="two-column">
                    <div class="sidebar">
                        <div class="section-title">Contact</div>
                        <div class="contact-info" style="flex-direction: column; gap: 10px;">
                            ${data.phone ? `<div class="contact-item">📞 ${data.phone}</div>` : ''}
                            ${data.email ? `<div class="contact-item">✉️ ${data.email}</div>` : ''}
                            ${data.address ? `<div class="contact-item">📍 ${data.address}</div>` : ''}
                            ${data.dateOfBirth ? `<div class="contact-item">🎂 ${formatDate(data.dateOfBirth)}</div>` : ''}
                        </div>
                        
                        ${data.skills ? `
                        <div class="section-title">Skills</div>
                        <div class="skills-list">
                            ${formatTextAsSkills(data.skills)}
                        </div>
                        ` : ''}
                        
                        ${data.hobbies ? `
                        <div class="section-title">Hobbies</div>
                        <p>${data.hobbies}</p>
                        ` : ''}
                        
                        ${data.certifications ? `
                        <div class="section-title">Certifications</div>
                        <div class="timeline">
                            ${formatTextAsTimeline(data.certifications)}
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="main-content">
                        <div class="section-title">Career Objective</div>
                        <p>${data.careerObjective}</p>
                        
                        ${data.education ? `
                        <div class="section-title">Education</div>
                        <div class="timeline">
                            ${formatTextAsTimeline(data.education)}
                        </div>
                        ` : ''}
                        
                        ${data.workExperience ? `
                        <div class="section-title">Work Experience</div>
                        <div class="timeline">
                            ${formatTextAsTimeline(data.workExperience)}
                        </div>
                        ` : ''}
                        
                        ${data.projects ? `
                        <div class="section-title">Projects</div>
                        <div class="timeline">
                            ${formatTextAsTimeline(data.projects)}
                        </div>
                        ` : ''}
                        
                        ${selectedPurpose === 'marriage' && data.extra ? `
                        <div class="section-title">Additional Information</div>
                        <p>${data.extra}</p>
                        ` : ''}
                        
                        ${data.references ? `
                        <div class="section-title">References</div>
                <p>${data.references}</p>
                        ` : ''}
                    </div>
                </div>
            `;
        }
        
        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }
        
        function formatTextAsTimeline(text) {
            if (!text) return '';
            return text.split('\n').filter(item => item.trim() !== '').map(item => {
                const [date, ...description] = item.split(':');
                return `
                    <div class="timeline-item">
                        <div class="timeline-date">${description.length > 0 ? date : ''}</div>
                        <div class="timeline-content">${description.join(':').trim() || date}</div>
                    </div>
                `;
            }).join('');
        }

        function formatTextAsSkills(text) {
            if (!text) return '';
            return text.split(',').filter(item => item.trim() !== '').map(item => `<div class="skill-tag">${item.trim()}</div>`).join('');
        }
        
        function applyTheme(theme) {
            const root = document.documentElement;
            const themes = {
                basic: { primary: '#4a6fa5', secondary: '#6b8cbc', accent: '#ff7e5f' },
                work: { primary: '#2c3e50', secondary: '#34495e', accent: '#e74c3c' },
                pro: { primary: '#1a1a1a', secondary: '#333333', accent: '#c29b0c' },
                cozy: { primary: '#e67e22', secondary: '#f39c12', accent: '#16a085' },
                productive: { primary: '#27ae60', secondary: '#2ecc71', accent: '#e74c3c' },
                elegant: { primary: '#9b59b6', secondary: '#8e44ad', accent: '#f1c40f' },
            };
            const selected = themes[theme] || themes.basic;
            Object.keys(selected).forEach(key => root.style.setProperty(`--${key}`, selected[key]));
        }

        async function exportCV(format) {
            const cvElement = document.getElementById('cvPreview');
            const fullName = document.getElementById('fullName').value.replace(/ /g, '_') || 'CV';

            switch (format) {
                case 'pdf':
                    const pdfOptions = {
                        margin: 0.5,
                        filename: `${fullName}.pdf`,
                        image: { type: 'jpeg', quality: 0.98 },
                        html2canvas: { scale: 2 },
                        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                    };
                    html2pdf().from(cvElement).set(pdfOptions).save();
                    break;
                
                case 'docx':
                    const docxContent = `<!DOCTYPE html><html><head><style>${Array.from(document.styleSheets).map(s => Array.from(s.cssRules).map(r => r.cssText).join('')).join('')}</style></head><body>${cvElement.innerHTML}</body></html>`;
                    const docxBlob = await htmlToDocx(docxContent, null, {
                        orientation: 'portrait',
                        margins: { top: 720, right: 720, bottom: 720, left: 720 },
                    });
                    const docxUrl = URL.createObjectURL(docxBlob);
                    const docxLink = document.createElement('a');
                    docxLink.href = docxUrl;
                    docxLink.download = `${fullName}.docx`;
                    docxLink.click();
                    URL.revokeObjectURL(docxUrl);
                    break;

                case 'png':
                    html2canvas(cvElement, { scale: 2 }).then(canvas => {
                        const pngUrl = canvas.toDataURL('image/png');
                        const pngLink = document.createElement('a');
                        pngLink.href = pngUrl;
                        pngLink.download = `${fullName}.png`;
                        pngLink.click();
                    });
                    break;
            }
        }
    </script>
</body>
</html>

