<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moodly AI - Your Wellness Companion</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- Base & Theme Variables --- */
        :root {
            --background-start: #fdf2e1;
            --background-end: #eaf6f8;
            --text-primary: #333;
            --text-secondary: rgba(60, 60, 67, 0.75);
            --accent-primary: #007AFF;
            --accent-secondary: #FF9F0A;
            --accent-red: #FF3B30;
            --accent-purple: #AF52DE;
            --glass-background: rgba(255, 255, 255, 0.45);
            --glass-border-color: rgba(255, 255, 255, 0.2);
            --glass-blur: 20px;
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            --border-radius-large: 24px;
            --border-radius-medium: 18px;
            --border-radius-small: 12px;
            --transition-smooth: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* Serene Theme */
        body.theme-serene {
            --background-start: #e0f2f1;
            --background-end: #e3f2fd;
            --text-primary: #1c313a;
            --accent-primary: #00897b;
            --accent-secondary: #fbc02d;
        }

        /* Focus Theme */
        body.theme-focus {
            --background-start: #f5f5f5;
            --background-end: #e0e0e0;
            --text-primary: #212121;
            --accent-primary: #d50000;
            --accent-secondary: #f57f17;
            --glass-background: rgba(255, 255, 255, 0.6);
        }


        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--background-start) 0%, var(--background-end) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 60px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            padding: 20px 0;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -1.5px;
        }

        .tagline {
            font-size: 1.15rem;
            color: var(--text-secondary);
            margin-bottom: 24px;
        }
        
        /* --- Theme Selector --- */
        .theme-selector {
            display: flex;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .theme-btn {
            padding: 8px 16px;
            border: 1px solid transparent;
            border-radius: 16px;
            cursor: pointer;
            background-color: transparent;
            color: var(--text-secondary);
            font-weight: 500;
            transition: var(--transition-smooth);
        }

        .theme-btn.active, .theme-btn:hover {
            background-color: var(--glass-background);
            border-color: var(--glass-border-color);
            color: var(--accent-primary);
        }


        .glass-card {
            background: var(--glass-background);
            border-radius: var(--border-radius-large);
            padding: 30px;
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border-color);
            box-shadow: var(--glass-shadow);
            transition: var(--transition-smooth);
        }
         .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.12);
        }

        footer {
            text-align: center;
            color: var(--text-secondary);
            padding: 40px 0 20px;
            font-size: 0.9rem;
            border-top: 1px solid rgba(0,0,0,0.05);
            margin-top: 60px;
        }

        /* --- ENHANCED AI ASSISTANT --- */
        .ai-assistant { margin: 30px 0; }
        .ai-assistant-card { padding: 25px; position: relative; }
        .ai-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .ai-avatar { width: 50px; height: 50px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-purple)); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; flex-shrink: 0;}
        .ai-title { font-size: 1.5rem; color: var(--text-primary); }

        .ai-chatbox {
            margin-top: 15px; padding: 20px; background: rgba(0, 122, 255, 0.05);
            border-radius: var(--border-radius-medium); border: 1px solid rgba(0, 122, 255, 0.1);
            min-height: 140px; line-height: 1.7;
        }

        #ai-response-content strong, #ai-response-content h4 { color: var(--accent-primary); font-weight: 600; margin-bottom: 10px; margin-top: 5px; }
        #ai-response-content ul { list-style-position: inside; padding-left: 10px; margin-top: 10px;}
        #ai-response-content li { margin-bottom: 8px; }

        .ai-thinking { display: flex; align-items: center; gap: 10px; color: var(--text-secondary); font-style: italic; }
        .thinking-dot { width: 8px; height: 8px; background: var(--text-secondary); border-radius: 50%; animation: bounce 1.4s infinite ease-in-out both; }
        .thinking-dot:nth-child(1) { animation-delay: -0.32s; } .thinking-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }

        .ai-input-container { position: relative; }
        .ai-input-area { display: flex; gap: 10px; margin-top: 20px; }
        #user-input {
            flex-grow: 1; padding: 15px; border: 1px solid var(--glass-border-color);
            border-radius: var(--border-radius-medium); font-size: 1rem;
            background: rgba(255, 255, 255, 0.8); transition: var(--transition-smooth);
        }
        #user-input:focus { outline: none; box-shadow: 0 0 0 2px var(--accent-primary); background: white; }
        #send-btn {
            background: var(--accent-primary); color: white; border: none; padding: 0 25px;
            border-radius: var(--border-radius-medium); cursor: pointer; font-size: 1rem; font-weight: 500;
            transition: var(--transition-smooth); box-shadow: 0 4px 10px rgba(0, 122, 255, 0.2);
        }
        #send-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0, 122, 255, 0.3); }

        /* Autocomplete Preset Suggestions Styling */
        #preset-suggestions-list {
            position: absolute; bottom: 100%; left: 0; right: 0;
            background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border-color);
            border-radius: var(--border-radius-medium);
            max-height: 250px; overflow-y: auto;
            z-index: 100; opacity: 0; visibility: hidden;
            transform: translateY(10px); transition: all 0.2s ease;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        #preset-suggestions-list.visible { opacity: 1; visibility: visible; transform: translateY(-10px); }
        .suggestion-item { padding: 12px 20px; cursor: pointer; border-bottom: 1px solid var(--glass-border-color); font-size: 0.95rem; color: var(--text-primary); }
        .suggestion-item:last-child { border-bottom: none; }
        .suggestion-item:hover { background-color: rgba(0, 122, 255, 0.1); }
        .suggestion-item mark { background-color: #ff9f0a80; border-radius: 3px; }

        /* --- Other Page Sections Styling --- */
        .section-title { font-size: 2rem; text-align: center; margin-bottom: 40px; font-weight: 600; }
        #exercises { margin-bottom: 60px; padding-top: 40px; }
        .exercise-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        .exercise-card { padding: 25px; }
        .exercise-card h3 { font-size: 1.4rem; margin-bottom: 15px; color: var(--accent-primary); }

        /* Breathing Exercise */
        .breathing-exercise-section { margin: 30px 0 60px; }
        .circle {
            width: 180px; height: 180px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%; margin: 20px auto; display: flex; align-items: center; justify-content: center;
            color: white; font-size: 24px; font-weight: 500; transition: var(--transition-smooth);
            box-shadow: 0 8px 30px rgba(0, 122, 255, 0.25); border: 2px solid rgba(255, 255, 255, 0.5);
            text-align: center;
            padding: 10px;
        }
        .controls { margin-top: 20px; display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; }
        .controls button, .controls a {
            background: var(--accent-primary); color: white; border: none; padding: 12px 24px;
            border-radius: 25px; cursor: pointer; font-size: 1rem; font-weight: 500;
            transition: var(--transition-smooth); box-shadow: 0 4px 10px rgba(0, 122, 255, 0.2);
            text-decoration: none; display: inline-block;
        }
        .controls button:hover, .controls a:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 122, 255, 0.3);
        }
        #stop-breathing { background-color: var(--accent-red); box-shadow: 0 4px 10px rgba(255, 59, 48, 0.2); }
        #stop-breathing:hover { box-shadow: 0 6px 15px rgba(255, 59, 48, 0.3); }
        .controls a {
            background-color: var(--accent-purple);
            box-shadow: 0 4px 10px rgba(175, 82, 222, 0.2);
        }
         .controls a:hover {
            box-shadow: 0 6px 15px rgba(175, 82, 222, 0.3);
        }

        /* --- Responsive Design for Phones --- */
        @media (max-width: 768px) {
            .logo { font-size: 2rem; }
            .tagline { font-size: 1rem; }
            .section-title { font-size: 1.8rem; }
            .glass-card { padding: 20px; }
            .ai-input-area { flex-direction: column; gap: 12px; }
            #send-btn { padding: 15px; }
            .exercise-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 480px) {
            .container { padding: 0 15px; }
            header { padding: 15px 0; }
            .ai-header { flex-direction: column; text-align: center; }
            .circle { width: 150px; height: 150px; font-size: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">moodly AI</div>
            <p class="tagline">Your intelligent guide to a clearer mind.</p>
             <div class="theme-selector">
                <button class="theme-btn active" data-theme="default">Default</button>
                <button class="theme-btn" data-theme="serene">Serene</button>
                <button class="theme-btn" data-theme="focus">Focus</button>
            </div>
        </header>

        <section class="ai-assistant">
            <div class="glass-card ai-assistant-card">
                <div class="ai-header">
                    <div class="ai-avatar"><i class="fas fa-brain"></i></div>
                    <h2 class="ai-title">Advanced Wellness Assistant</h2>
                </div>
                <p>Hello! I'm an advanced version of Moodly. Tell me what's on your mind. As you type, I can suggest questions you might want to ask.</p>
                <div class="ai-chatbox" id="ai-chatbox">
                    <div id="ai-response-content">How can I support you today?</div>
                    <div class="ai-thinking" id="ai-thinking-indicator" style="display: none;">
                        <span class="thinking-dot"></span><span class="thinking-dot"></span><span class="thinking-dot"></span>
                        <span>Moodly is considering...</span>
                    </div>
                </div>
                <div class="ai-input-container">
                    <div id="preset-suggestions-list"></div>
                    <div class="ai-input-area">
                        <input type="text" id="user-input" placeholder="e.g., I'm overwhelmed with studying...">
                        <button id="send-btn" title="Send message">Ask</button>
                    </div>
                </div>
            </div>
        </section>

        <main>
             <section id="exercises" class="breathing-exercise-section glass-card">
                <h2 style="text-align: center;">4-7-8 Breathing</h2>
                <p class="tagline" style="text-align: center;">A simple technique to calm your nerves.</p>
                <div class="circle" id="breath-circle">Start</div>
                <div class="controls">
                    <button id="start-breathing">Begin</button>
                    <button id="stop-breathing" style="display:none">Pause</button>
                    <a href="page14.html">Mind Exercise</a>
                </div>
            </section>

            <section class="exercises">
                <h2 class="section-title">Mindful Study Breaks</h2>
                <div class="exercise-grid">
                    <div class="glass-card exercise-card">
                        <h3>Pomodoro Technique</h3>
                        <p>Study for 25 minutes, then a 5-minute break. After four cycles, take a longer 15-30 minute break.</p>
                    </div>
                    <div class="glass-card exercise-card">
                        <h3>Desk Yoga</h3>
                        <p>Simple seated yoga poses to release tension in your neck, shoulders, and back during study sessions.</p>
                    </div>
                    <div class="glass-card exercise-card">
                        <h3>Five Senses Scan</h3>
                        <p>Notice 5 things you can see, 4 you can touch, 3 you can hear, 2 you can smell, and 1 you can taste.</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <footer>
       <p>© 2025 Moodly AI — Your companion for a clearer mind.</p>
    </footer>

    <script>
    // --- COMBINED AND FULLY FUNCTIONAL JAVASCRIPT ---

    // --- Part 1: ADVANCED AI ASSISTANT SCRIPT ---
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const chatboxContent = document.getElementById('ai-response-content');
    const thinkingIndicator = document.getElementById('ai-thinking-indicator');
    const suggestionsList = document.getElementById('preset-suggestions-list');
    
    // --- THEME SWITCHER LOGIC ---
    const themeButtons = document.querySelectorAll('.theme-btn');
    themeButtons.forEach(button => {
        button.addEventListener('click', () => {
            const theme = button.getAttribute('data-theme');
            document.body.className = theme === 'default' ? '' : `theme-${theme}`;

            themeButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
        });
    });

    let isAIThinking = false;
    
    // --- IMPROVED AI: String Similarity Function (Sørensen-Dice coefficient) ---
    function getStringSimilarity(a, b) {
        a = a.replace(/\s+/g, '')
        b = b.replace(/\s+/g, '')
        
        if (!a.length && !b.length) return 1;
        if (!a.length || !b.length) return 0;
        if (a === b) return 1;
        if (a.length === 1 && b.length === 1) return 0;
        if (a.length < 2 || b.length < 2) return 0;

        let firstBigrams = new Map();
        for (let i = 0; i < a.length - 1; i++) {
            const bigram = a.substring(i, i + 2);
            const count = firstBigrams.has(bigram) ? firstBigrams.get(bigram) + 1 : 1;
            firstBigrams.set(bigram, count);
        };

        let intersectionSize = 0;
        for (let i = 0; i < b.length - 1; i++) {
            const bigram = b.substring(i, i + 2);
            const count = firstBigrams.has(bigram) ? firstBigrams.get(bigram) : 0;
            if (count > 0) {
                firstBigrams.set(bigram, count - 1);
                intersectionSize++;
            }
        }
        return (2.0 * intersectionSize) / (a.length + b.length - 2);
    }


    const qa_database = {
       'exam_stress': {
            keywords: ['stressed about my exams', 'exam stress', 'overwhelmed with studying', 'study pressure'],
            title: "Managing Exam Stress",
            content: "Feeling stressed before exams is a sign that you care, but it can be overwhelming. The key is to manage it. Try the <strong>Pomodoro Technique</strong> to break your study sessions into manageable chunks:<ul><li>Work with intense focus for 25 minutes.</li><li>Take a 5-minute break completely away from your books.</li><li>After four cycles, take a longer 15-30 minute break.</li></ul>This prevents burnout and helps your brain absorb information more effectively."
        },
        'panic_attack': {
            keywords: ['panic attack', 'having a panic attack', 'I think I am having a panic attack'],
            title: "Grounding Yourself During a Panic Attack",
            content: "This can feel incredibly scary, but you are safe. Let's pull your focus into the present moment. Use the <strong>5-4-3-2-1 Technique</strong> right now:<ul><li>Name <strong>5</strong> things you can see.</li><li>Name <strong>4</strong> things you can feel (your feet on the floor, your shirt).</li><li>Name <strong>3</strong> things you can hear.</li><li>Name <strong>2</strong> things you can smell.</li><li>Name <strong>1</strong> positive quality about yourself.</li></ul>Focus on your breathing. You will get through this."
        },
        'anxiety_focus': {
            keywords: ['anxiety is making it hard to focus', 'anxious to focus', 'can\'t concentrate due to anxiety'],
            title: "Breaking the Anxiety-Focus Loop",
            content: "Anxiety and lack of focus are closely linked. When your mind is racing, it's impossible to concentrate. Let's interrupt that loop with a simple physical task. Stand up and do <strong>10 gentle neck rolls</strong>, five in each direction. Then, get a glass of cold water. This small reset can often provide just enough clarity to get back to your task."
        },
        'presentation_calm': {
            keywords: ['calm down before a presentation', 'presentation anxiety', 'nervous about public speaking'],
            title: "Calming Pre-Presentation Jitters",
            content: "It's totally normal to feel nervous! Use that energy. Just before you speak, find a private space and try <strong>'Power Posing'</strong> for 60 seconds (e.g., stand tall with your hands on your hips). Research suggests this can increase feelings of confidence. Also, take three slow, deep belly breaths to calm your nervous system right before you start."
        },
        // ... all other database entries remain the same
         'exam_stress': {
            keywords: ['stressed about my exams', 'exam stress'],
            title: "Managing Exam Stress",
            content: "Feeling stressed before exams is a sign that you care, but it can be overwhelming. The key is to manage it. Try the <strong>Pomodoro Technique</strong> to break your study sessions into manageable chunks:<ul><li>Work with intense focus for 25 minutes.</li><li>Take a 5-minute break completely away from your books.</li><li>After four cycles, take a longer 15-30 minute break.</li></ul>This prevents burnout and helps your brain absorb information more effectively."
        },
        'panic_attack': {
            keywords: ['panic attack', 'having a panic attack'],
            title: "Grounding Yourself During a Panic Attack",
            content: "This can feel incredibly scary, but you are safe. Let's pull your focus into the present moment. Use the <strong>5-4-3-2-1 Technique</strong> right now:<ul><li>Name <strong>5</strong> things you can see.</li><li>Name <strong>4</strong> things you can feel (your feet on the floor, your shirt).</li><li>Name <strong>3</strong> things you can hear.</li><li>Name <strong>2</strong> things you can smell.</li><li>Name <strong>1</strong> positive quality about yourself.</li></ul>Focus on your breathing. You will get through this."
        },
        'anxiety_focus': {
            keywords: ['anxiety is making it hard to focus', 'anxious to focus'],
            title: "Breaking the Anxiety-Focus Loop",
            content: "Anxiety and lack of focus are closely linked. When your mind is racing, it's impossible to concentrate. Let's interrupt that loop with a simple physical task. Stand up and do <strong>10 gentle neck rolls</strong>, five in each direction. Then, get a glass of cold water. This small reset can often provide just enough clarity to get back to your task."
        },
        'presentation_calm': {
            keywords: ['calm down before a presentation', 'presentation anxiety'],
            title: "Calming Pre-Presentation Jitters",
            content: "It's totally normal to feel nervous! Use that energy. Just before you speak, find a private space and try <strong>'Power Posing'</strong> for 60 seconds (e.g., stand tall with your hands on your hips). Research suggests this can increase feelings of confidence. Also, take three slow, deep belly breaths to calm your nervous system right before you start."
        },
        'pressure_succeed': {
            keywords: ['pressure to succeed'],
            title: "Easing the Pressure to Succeed",
            content: "That pressure can be paralyzing. Let's reframe your goal. Instead of focusing on the outcome (like a specific grade), focus on the <strong>process and effort</strong>. Did you put in a reasonable amount of time today? Did you try your best in this session? Celebrating consistent effort, not just flawless results, is a much more sustainable and compassionate way to achieve your goals."
        },
        'social_anxiety': {
            keywords: ['social anxiety', 'anxious about meeting new people'],
            title: "Navigating Social Anxiety",
            content: "Social anxiety often stems from focusing inward. A powerful technique is to <strong>shift your focus outward</strong>. When meeting someone, make it your mission to learn one interesting thing about them. Ask open-ended questions (starting with 'what,' 'how,' or 'why'). This takes the spotlight off you and can make conversations feel more natural."
        },
        'overthinking': {
            keywords: ['overthink everything', 'can\'t relax'],
            title: "Quieting an Overthinking Mind",
            content: "When you can't stop overthinking, your mind needs a clear instruction. Try this: acknowledge the thought by saying to yourself, 'Okay, I'm having a worried thought,' and then immediately engage your senses. Describe the room you're in to yourself in great detail. 'The wall is white, there's a black lamp...' This is a form of mindfulness that anchors you in the present, away from the spiral of thoughts."
        },
        'future_worry': {
            keywords: ['worried about the future'],
            title: "Managing Worry About the Future",
            content: "Worrying about the future pulls you out of the only moment you can control: right now. Do a quick <strong>'Circle of Control'</strong> exercise. Draw a circle on a piece of paper (or in your mind). Inside, list things you can control (your effort today, your attitude). Outside, list things you can't (the exact questions on a test, what others think). Pour your energy only into what's inside the circle."
        },
        'heart_racing': {
            keywords: ['heart is racing'],
            title: "When Your Heart is Racing",
            content: "A racing heart can be alarming and is a common sign of anxiety. You can directly influence your heart rate with your breath. Let's try <strong>4-7-8 Breathing</strong>, which stimulates the vagus nerve to calm the body:<ul><li>Breathe in quietly through your nose for <strong>4</strong> seconds.</li><li>Hold your breath for a count of <strong>7</strong> seconds.</li><li>Exhale completely through your mouth, making a whoosh sound, for <strong>8</strong> seconds.</li></ul>Repeat this three times."
        },
        'procrastinating': {
            keywords: ['can\'t stop procrastinating', 'avoiding'],
            title: "Breaking the Procrastination Cycle",
            content: "Procrastination is often caused by feeling overwhelmed by the task. Let's trick your brain by using the <strong>'2-Minute Rule'</strong>. Pick the task you're avoiding and commit to doing it for only two minutes. Anyone can do something for just two minutes. Often, starting is the hardest part, and you'll find you can continue for longer."
        },
        'unmotivated': {
            keywords: ['unmotivated to do anything'],
            title: "Finding a Spark of Motivation",
            content: "Motivation isn't something you wait for; it's something you create with action. Don't wait to 'feel' like it. Instead, focus on the smallest possible step and <strong>'celebrate the start.'</strong> Your goal isn't to finish the big task. Your goal is simply to open the book or write one sentence. Once you do that, give yourself credit. That small feeling of accomplishment is what builds momentum."
        },
        'workload_overwhelm': {
            keywords: ['overwhelmed by my workload', 'too much to do'],
            title: "Taming an Overwhelming Workload",
            content: "When you have too much to do, your brain can freeze. The first step is to get it all out of your head. Do a <strong>'Brain Dump'</strong>: write down every single task you can think of on a piece of paper. Don't organize it, just get it all out. Seeing it all on paper often makes it feel more manageable than the chaotic cloud of 'everything' in your mind. From there, you can pick just ONE thing to start."
        },
        'feeling_sad': {
            keywords: ['feeling sad and don\'t know why', 'feeling down'],
            title: "When You're Feeling Sad",
            content: "It's perfectly okay to feel sad, even without a clear reason. Don't fight the feeling; just acknowledge it with kindness. 'I'm feeling sad right now, and that's alright.' Try something gentle on your senses, like putting on a favorite comforting playlist or stepping outside for <strong>five minutes of fresh air</strong>. The goal isn't to force happiness, but to offer yourself a moment of comfort."
        },
        'boost_mood': {
            keywords: ['boost my mood', 'cheer up'],
            title: "For a Quick Mood Boost",
            content: "You can influence your mood with your body. Try a technique called <strong>'Smile Therapy.'</strong> Even if you don't feel like it, hold a gentle, genuine smile for 30 seconds. The physical act of using the smiling muscles can send signals to your brain that can help lift your emotional state. Pair it with standing up and stretching your arms high for an extra boost."
        },
        'feeling_lonely': {
            keywords: ['feel lonely'],
            title: "Navigating Feelings of Loneliness",
            content: "Loneliness is about a lack of connection, not a lack of people. A powerful antidote is to create a small moment of genuine connection. Think of one person you haven't spoken to in a while and send them a text with a specific question, like 'Hey, saw [this thing] and it made me think of you. How have you been?' Being proactive, even in a small way, can make a big difference."
        },
        'self_love': {
            keywords: ['practice self-love', 'critical of myself'],
            title: "Practicing Self-Love",
            content: "Self-love is often about practicing self-compassion. The next time you make a mistake or feel inadequate, ask yourself: <strong>'What would I say to a dear friend in this exact situation?'</strong> You would likely offer kindness, encouragement, and perspective. Now, try to offer those same words to yourself. Treat yourself with the same grace you give to others."
        },
        'negative_self_talk': {
            keywords: ['negative self-talk'],
            title: "Challenging Negative Self-Talk",
            content: "Our minds have a habit of negative chatter. To combat it, you need to challenge it like a lawyer. When a negative thought like 'I'm going to fail' appears, ask: <strong>'Where is the evidence for that thought? Is it 100% true?'</strong> Often, you'll find it's an exaggeration or a fear, not a fact. Then, come up with a more balanced, realistic thought, like 'This is challenging, but I am capable and I have prepared.'"
        },
        'cant_sleep': {
            keywords: ['can\'t fall asleep', 'trouble sleeping'],
            title: "Tips for Falling Asleep",
            content: "If you're struggling to sleep, creating a 'buffer zone' before bed is crucial. For the last 30-60 minutes of your day, declare a <strong>'No Screens'</strong> policy. The blue light from phones and computers disrupts melatonin, the hormone that signals sleep. Instead, read a physical book, do some light stretching, or listen to calming music to signal to your body and mind that it's time to wind down."
        },
        'always_tired': {
            keywords: ['tired all the time', 'no energy'],
            title: "On Feeling Tired all the Time",
            content: "Constant fatigue can be draining. While sleep is a major factor, don't overlook hydration and nutrition. Are you drinking enough water throughout the day? Dehydration is a major cause of fatigue. Also, ensure you're having regular meals to keep your blood sugar stable. A quick <strong>5-minute walk</strong> can also paradoxically boost your energy more effectively than sitting still."
        },
        'didnt_work': {
            keywords: ["didn't work", 'not helping', 'another idea'],
            title: "Let's Try a Different Approach",
            content: "I appreciate you telling me that. Not every technique works for everyone in every moment. Let's switch gears. If the last suggestion was more of a mental exercise, let's try something physical. Stand up and shake out your arms and legs for 30 seconds. If the last suggestion was physical, let's try something sensory: find one thing in the room that has a pleasant texture and focus on it for a moment. Sometimes a different pathway is all you need."
        },
        'advice': {
            keywords: ['advice', 'useful tip'],
            title: "A Generally Useful Tip",
            content: "Here’s a powerful productivity and wellness tip: the <strong>'One-Minute Rule.'</strong> If a task takes less than a minute to complete—like putting a cup in the dishwasher, replying to a quick text, or writing down a reminder—do it immediately instead of putting it off. This prevents small tasks from piling up and creating a sense of mental clutter and overwhelm."
        },
        const tips = [
  {
    keywords: ['advice', 'useful tip'],
    title: "The One-Minute Rule",
    content: "If a task takes less than a minute—like putting away your shoes or sending a text—do it immediately to prevent clutter and stress."
  },
  {
    keywords: ['focus', 'productivity'],
    title: "The Two-Minute Rule",
    content: "If something can be done in under two minutes, handle it now. Quick actions clear mental space for bigger tasks."
  },
  {
    keywords: ['wellness', 'mental health'],
    title: "Micro-Breaks Matter",
    content: "Take a 2–3 minute break every hour to stretch, breathe, or look away from your screen. It reduces fatigue and boosts focus."
  },
  {
    keywords: ['organization', 'productivity'],
    title: "Declutter Desk, Declutter Mind",
    content: "A tidy workspace reduces distractions and creates mental clarity. Spend 5 minutes each day organizing your desk."
  },
  {
    keywords: ['time management', 'planning'],
    title: "The Power of Planning Ahead",
    content: "Spend 5 minutes each evening planning tomorrow’s top 3 priorities. It reduces decision fatigue and increases focus."
  },
  {
    keywords: ['mindfulness', 'focus'],
    title: "The 5-4-3-2-1 Method",
    content: "Calm anxiety by naming 5 things you see, 4 you touch, 3 you hear, 2 you smell, and 1 you taste."
  },
  {
    keywords: ['energy', 'health'],
    title: "Hydration Reminder",
    content: "Drink a glass of water first thing in the morning. It jumpstarts metabolism and rehydrates your body after sleep."
  },
  {
    keywords: ['study', 'learning'],
    title: "Pomodoro Technique",
    content: "Work for 25 minutes, then rest for 5. After four rounds, take a longer break. Great for staying focused and avoiding burnout."
  },
  {
    keywords: ['motivation', 'goals'],
    title: "Visualize Success",
    content: "Spend a minute picturing your goal achieved. Visualization boosts motivation and helps align your daily actions with success."
  },
  {
    keywords: ['wellness', 'happiness'],
    title: "Gratitude Note",
    content: "Write down one thing you’re grateful for every day. It trains your brain to focus on positives and improves mood."
  }
const tips = [
  {
    keywords: ['advice', 'useful tip'],
    title: "The One-Minute Rule",
    content: "If a task takes less than a minute—like putting away your shoes or sending a text—do it immediately to prevent clutter and stress."
  },
  {
    keywords: ['focus', 'productivity'],
    title: "The Two-Minute Rule",
    content: "If something can be done in under two minutes, handle it now. Quick actions clear mental space for bigger tasks."
  },
  {
    keywords: ['wellness', 'mental health'],
    title: "Micro-Breaks Matter",
    content: "Take a 2–3 minute break every hour to stretch, breathe, or look away from your screen. It reduces fatigue and boosts focus."
  },
  {
    keywords: ['organization', 'productivity'],
    title: "Declutter Desk, Declutter Mind",
    content: "A tidy workspace reduces distractions and creates mental clarity. Spend 5 minutes each day organizing your desk."
  },
  {
    keywords: ['time management', 'planning'],
    title: "The Power of Planning Ahead",
    content: "Spend 5 minutes each evening planning tomorrow’s top 3 priorities. It reduces decision fatigue and increases focus."
  },
  {
    keywords: ['mindfulness', 'focus'],
    title: "The 5-4-3-2-1 Method",
    content: "Calm anxiety by naming 5 things you see, 4 you touch, 3 you hear, 2 you smell, and 1 you taste."
  },
  {
    keywords: ['energy', 'health'],
    title: "Hydration Reminder",
    content: "Drink a glass of water first thing in the morning. It jumpstarts metabolism and rehydrates your body after sleep."
  },
  {
    keywords: ['study', 'learning'],
    title: "Pomodoro Technique",
    content: "Work for 25 minutes, then rest for 5. After four rounds, take a longer break. Great for staying focused and avoiding burnout."
  },
  {
    keywords: ['motivation', 'goals'],
    title: "Visualize Success",
    content: "Spend a minute picturing your goal achieved. Visualization boosts motivation and helps align your daily actions with success."
  },
  {
    keywords: ['wellness', 'happiness'],
    title: "Gratitude Note",
    content: "Write down one thing you’re grateful for every day. It trains your brain to focus on positives and improves mood."
  },
  {
    keywords: ['productivity', 'decision making'],
    title: "Limit Daily Decisions",
    content: "Reduce decision fatigue by automating small choices—like meal prepping or planning outfits in advance."
  },
  {
    keywords: ['mental health', 'stress'],
    title: "Box Breathing",
    content: "Breathe in for 4 seconds, hold 4, exhale 4, hold 4. Repeat to calm nerves and sharpen focus."
  },
  {
    keywords: ['time management', 'efficiency'],
    title: "Batch Similar Tasks",
    content: "Group similar tasks (emails, calls, errands) together to save time and reduce mental switching."
  },
  {
    keywords: ['study', 'memory'],
    title: "Teach What You Learn",
    content: "Explain new knowledge to someone else. Teaching reinforces memory and deepens understanding."
  },
  {
    keywords: ['health', 'energy'],
    title: "Morning Movement",
    content: "Start your day with light stretching or a short walk to wake up your body and mind."
  },
  {
    keywords: ['organization', 'planning'],
    title: "Weekly Reset",
    content: "Set aside 15 minutes on Sunday to review goals, tidy up, and set intentions for the week."
  },
  {
    keywords: ['happiness', 'relationships'],
    title: "Send a Kind Message",
    content: "Text someone a quick note of appreciation. Small acts strengthen bonds and improve mood."
  },
  {
    keywords: ['focus', 'work'],
    title: "Single-Tasking Wins",
    content: "Multitasking reduces efficiency. Focus on one task at a time for better results."
  },
  {
    keywords: ['wellness', 'sleep'],
    title: "No Screens Before Bed",
    content: "Avoid screens 30 minutes before sleeping. Blue light disrupts melatonin and sleep quality."
  },
  {
    keywords: ['study', 'retention'],
    title: "Spaced Repetition",
    content: "Review material over increasing intervals. It strengthens long-term memory better than cramming."
  },
  {
    keywords: ['finance', 'savings'],
    title: "Automate Savings",
    content: "Set up an automatic transfer to savings right after payday to build wealth effortlessly."
  },
  {
    keywords: ['motivation', 'growth'],
    title: "Celebrate Small Wins",
    content: "Acknowledge progress, no matter how small. Momentum builds motivation."
  },
  {
    keywords: ['productivity', 'focus'],
    title: "Use Do Not Disturb",
    content: "Silence notifications during deep work sessions to protect your focus."
  },
  {
    keywords: ['energy', 'health'],
    title: "Stand and Stretch",
    content: "Stand up at least once an hour to improve circulation and avoid stiffness."
  },
  {
    keywords: ['learning', 'curiosity'],
    title: "Ask More Questions",
    content: "Stay curious—asking questions deepens understanding and sparks creativity."
  },
  {
    keywords: ['stress relief', 'focus'],
    title: "Quick Walk Reset",
    content: "When overwhelmed, take a 5-minute walk outside. Movement clears the mind."
  },
  {
    keywords: ['study', 'creativity'],
    title: "Change Study Spot",
    content: "A new environment can refresh focus and spark creativity."
  },
  {
    keywords: ['organization', 'decluttering'],
    title: "One In, One Out Rule",
    content: "For every new item you bring in, remove one old item. Keeps clutter under control."
  },
  {
    keywords: ['mental health', 'positivity'],
    title: "Affirmation Practice",
    content: "Repeat a positive statement daily. It rewires thought patterns over time."
  },
  {
    keywords: ['work', 'efficiency'],
    title: "Set Time Limits",
    content: "Give yourself a deadline, even for small tasks. Deadlines create urgency and focus."
  },
  {
    keywords: ['relationships', 'kindness'],
    title: "Listen Actively",
    content: "When someone speaks, listen fully without planning your reply. It deepens connections."
  },
  {
    keywords: ['finance', 'budget'],
    title: "Track Small Expenses",
    content: "Little purchases add up. Log them to see where your money really goes."
  },
  {
    keywords: ['health', 'fitness'],
    title: "Stretch Before Sleep",
    content: "Gentle stretches before bed relax muscles and improve sleep quality."
  },
  {
    keywords: ['focus', 'time management'],
    title: "Time Blocking",
    content: "Assign specific blocks of time to tasks. It prevents multitasking and distraction."
  },
  {
    keywords: ['productivity', 'work'],
    title: "Tackle Hardest Task First",
    content: "Do your most difficult task in the morning when willpower is strongest."
  },
  {
    keywords: ['mental health', 'stress'],
    title: "Journaling Release",
    content: "Write down worries before bed to clear your mind and sleep better."
  },
  {
    keywords: ['study', 'learning'],
    title: "Mind Map Notes",
    content: "Use diagrams instead of linear notes. It boosts memory and creativity."
  },
  {
    keywords: ['health', 'diet'],
    title: "Eat Protein Breakfast",
    content: "Protein-rich breakfasts keep you fuller and more focused than sugary ones."
  },
  {
    keywords: ['focus', 'productivity'],
    title: "Set 3 Priorities",
    content: "Pick your top 3 tasks for the day. Focus beats overwhelming to-do lists."
  },
  {
    keywords: ['motivation', 'growth'],
    title: "Progress Journal",
    content: "Track your small wins daily. Seeing progress fuels consistency."
  },
  {
    keywords: ['organization', 'planning'],
    title: "Night Prep",
    content: "Lay out clothes, prep meals, and plan tomorrow the night before to reduce stress."
  },
  {
    keywords: ['relationships', 'positivity'],
    title: "Compliment Someone",
    content: "Give a genuine compliment today. It brightens both your day and theirs."
  },
  {
    keywords: ['wellness', 'focus'],
    title: "Digital Detox Hour",
    content: "Set aside one hour a day screen-free. It refreshes your brain."
  },
  {
    keywords: ['health', 'hydration'],
    title: "Carry a Water Bottle",
    content: "Keep water with you at all times to avoid dehydration."
  },
  {
    keywords: ['learning', 'study'],
    title: "Review Before Sleep",
    content: "Go over key notes before bed. Your brain consolidates learning overnight."
  },
  {
    keywords: ['productivity', 'organization'],
    title: "Inbox Zero Habit",
    content: "Clear your email inbox daily or weekly to avoid digital clutter."
  },
  {
    keywords: ['mental health', 'happiness'],
    title: "Daily Sunlight",
    content: "Get at least 10 minutes of natural sunlight to boost mood and vitamin D."
  },
  {
    keywords: ['work', 'motivation'],
    title: "Reward Yourself",
    content: "After finishing a task, treat yourself with something small. Rewards build habits."
  }
];   
    };
     const dailyLifeAdviceDB = {}; // The rest of the large DB would be here

    const presetQuestions = [
      "I'm feeling stressed about my exams.", "How do I stop a panic attack?", "My anxiety is making it hard to focus.",
      "What's a quick way to calm down before a presentation?", "I feel a lot of pressure to succeed.", "How to deal with social anxiety?",
      "I overthink everything and can't relax.", "I'm worried about the future.", "My heart is racing, what should I do?",
      "I can't stop procrastinating.", "I feel so unmotivated to do anything.", "I feel overwhelmed by my workload.",
      "I'm feeling sad and don't know why.", "How can I boost my mood right now?", "I feel lonely even when I'm around people.",
      "How can I practice self-love?", "How to stop negative self-talk?", "I can't fall asleep at night.",
      "I feel tired all the time.", "That suggestion didn't work for me.", "Tell me another idea.", "Give me some advice."
  "I'm scared I'll fail my exams.",
  "How do I calm down when I'm nervous?",
  "I feel like I'm not good enough.",
  "Why do I always compare myself to others?",
  "I can't focus on studying no matter how hard I try.",
  "How can I stop procrastinating so much?",
  "I'm nervous about meeting new people.",
  "I feel like giving up on everything.",
  "What's a simple way to relax my mind?",
  "I can't stop thinking about past mistakes.",
  "How can I motivate myself to get out of bed?",
  "I feel like everyone expects too much from me.",
  "How do I stop worrying about things I can't control?",
  "I'm anxious before job interviews.",
  "I feel drained even after sleeping.",
  "What's the best way to calm my racing thoughts?",
  "I can't handle all this pressure anymore.",
  "How do I deal with constant overthinking?",
  "I feel insecure about how I look.",
  "How can I stop being afraid of failure?",
  "I'm losing interest in things I used to enjoy.",
  "Why do I feel so restless all the time?",
  "I feel nervous when speaking in front of people.",
  "How do I stop doubting myself?",
  "I'm stressed out about deadlines.",
  "I feel like I'm falling behind in life.",
  "How can I stop my mind from spiraling?",
  "I'm too tired to be productive.",
  "I feel like I don't belong anywhere.",
  "How do I boost my confidence quickly?",
  "I can't stop thinking negatively.",
  "I feel overwhelmed when I have too many tasks.",
  "How can I get motivated when I feel lazy?",
  "I worry too much about what people think of me.",
  "I feel anxious at night before sleeping.",
  "How do I deal with constant stress?",
  "I feel like I disappoint people.",
  "Why do I always feel so on edge?",
  "I can't stop replaying conversations in my head.",
  "How can I handle rejection better?",
  "I feel too shy to talk to people.",
  "I feel like I'm wasting my time.",
  "Why do I feel empty inside?",
  "I get nervous when people look at me.",
  "How do I find inner peace?",
  "I feel like my thoughts won't slow down.",
  "How can I stop being so hard on myself?",
  "I'm scared of making mistakes.",
  "I feel like I can't trust myself.",
  "How do I stop caring what others think?",
  "I get overwhelmed in crowded places.",
  "I feel like I can't do anything right.",
  "How can I stay positive during tough times?",
  "I'm worried I'll let everyone down.",
  "Why do I feel anxious in the morning?",
  "I can't stop biting my nails when stressed.",
  "How do I stop panicking over small things?",
  "I feel like I have no control over my life.",
  "What's a quick way to ground myself?",
  "I feel stuck in the same cycle every day.",
  "Why do I keep sabotaging myself?",
  "I can't concentrate on my work.",
  "I feel like crying for no reason.",
  "How do I stop doubting my decisions?",
  "I feel guilty for resting.",
  "Why do I always expect the worst?",
  "I can't stop worrying about the future.",
  "I feel like everyone else has it together but me.",
  "How do I stop comparing my life to others?",
  "I feel socially awkward.",
  "How can I deal with fear of public speaking?",
  "I can't find motivation to exercise.",
  "I feel like I'm underperforming.",
  "How do I stop my hands from shaking when nervous?",
  "I'm afraid people will judge me.",
  "I feel drained after socializing.",
  "How do I stop obsessing over mistakes?",
  "I feel like a burden to others.",
  "Why can't I relax even when I have free time?",
  "I feel pressure to be perfect.",
  "How do I cope with uncertainty?",
  "I feel like I can't handle change.",
  "Why do I feel nervous for no reason?",
  "I can't stop checking my phone.",
  "I feel like my mind is never quiet.",
  "How do I stop feeling restless?",
  "I feel like I have no motivation for anything.",
  "Why do I always overthink social situations?",
  "I feel like my anxiety controls me.",
  "How do I calm my nerves quickly?",
  "I feel nervous when I talk to authority figures.",
  "How do I stop putting things off?",
  "I feel pressure to always succeed.",
  "How can I stop being so self-critical?",
  "I feel like I'm not doing enough.",
  "How do I manage stress better?",
  "I feel like I can’t escape my worries.",
  "Why do I feel anxious even when things are fine?",
  "How do I stay calm in stressful situations?",
  "I feel like I'm losing control of my life."
    ];
    
    // --- UPDATED AI RESPONSE LOGIC ---
    function getAIResponse() {
        if (isAIThinking) return;
        const query = userInput.value.toLowerCase().trim();
        if (query === "") return;

        isAIThinking = true;
        chatboxContent.style.display = 'none';
        thinkingIndicator.style.display = 'flex';
        suggestionsList.classList.remove('visible');

        setTimeout(() => {
            let bestMatch = null;
            let highestScore = 0;
            const combinedDB = {...qa_database, ...dailyLifeAdviceDB};

            for (const id in combinedDB) {
                const item = combinedDB[id];
                for (const keyword of item.keywords) {
                    const currentScore = getStringSimilarity(query, keyword.toLowerCase());
                    if (currentScore > highestScore) {
                        highestScore = currentScore;
                        bestMatch = item;
                    }
                }
            }

            let responseHTML = "";
            const empatheticIntro = "I hear you. It sounds like a tough situation. Here's a thought that might help:";
            
            // Set a threshold for what's considered a good match
            if (bestMatch && highestScore > 0.3) {
                responseHTML = `${empatheticIntro} <h4>${bestMatch.title}</h4>${bestMatch.content}`;
            } else {
                responseHTML = "I'm not sure how to respond to that, but it sounds important. Could you perhaps rephrase it? Otherwise, the breathing exercise below can be a great way to find a moment of calm.";
            }
            
            chatboxContent.innerHTML = responseHTML;
            userInput.value = '';
            thinkingIndicator.style.display = 'none';
            chatboxContent.style.display = 'block';
            isAIThinking = false;
        }, 1200);
    }
    
    function displayPresetSuggestions() {
        const query = userInput.value.toLowerCase();
        if (query.length < 3) { suggestionsList.classList.remove('visible'); return; }
        const filtered = presetQuestions.filter(q => q.toLowerCase().includes(query)).slice(0, 5);
        if (filtered.length > 0) {
            suggestionsList.innerHTML = filtered.map(q => {
                const regex = new RegExp(`(${query})`, 'gi');
                const highlightedQ = q.replace(regex, `<mark>$1</mark>`);
                return `<div class="suggestion-item">${highlightedQ}</div>`;
            }).join('');
            suggestionsList.classList.add('visible');
        } else {
            suggestionsList.classList.remove('visible');
        }
    }

    sendBtn.addEventListener('click', getAIResponse);
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') getAIResponse(); });
    userInput.addEventListener('input', displayPresetSuggestions);

    suggestionsList.addEventListener('click', (e) => {
        if (e.target.classList.contains('suggestion-item')) {
            userInput.value = e.target.textContent;
            suggestionsList.classList.remove('visible');
            userInput.focus();
            getAIResponse();
        }
    });
    
    document.addEventListener('click', (e) => { if (!e.target.closest('.ai-input-container')) { suggestionsList.classList.remove('visible'); } });
    setTimeout(() => { chatboxContent.style.display = 'block'; }, 500);

    // --- Part 2: BREATHING EXERCISE SCRIPT ---
    const breathCircle = document.getElementById('breath-circle');
    const startButton = document.getElementById('start-breathing');
    const stopButton = document.getElementById('stop-breathing');
    let breathingTimeout;
    let isBreathing = false;
    let breathPhaseIndex = 0;
    const breathingSequence = [
        { text: "Breathe In", duration: 4000, scale: 1.1, background: "linear-gradient(135deg, #007AFF, #5856D6)" },
        { text: "Hold", duration: 7000, scale: 1.1, background: "linear-gradient(135deg, #5856D6, #FF9F0A)" },
        { text: "Breathe Out", duration: 8000, scale: 1.0, background: "linear-gradient(135deg, #FF9F0A, #FF3B30)" }
    ];
    function startBreathing() {
        if (isBreathing) return;
        isBreathing = true;
        startButton.style.display = 'none';
        stopButton.style.display = 'inline-block';
        breathPhaseIndex = 0;
        performBreathPhase();
    }
    function stopBreathing() {
        isBreathing = false;
        clearTimeout(breathingTimeout);
        startButton.style.display = 'inline-block';
        stopButton.style.display = 'none';
        breathCircle.textContent = "Paused";
        breathCircle.style.transform = 'scale(1)';
        breathCircle.style.background = 'linear-gradient(135deg, var(--accent-primary), var(--accent-secondary))';
        breathCircle.style.transition = `all 0.5s cubic-bezier(0.4, 0, 0.2, 1)`;
    }
    function performBreathPhase() {
        if (!isBreathing) return;
        const phase = breathingSequence[breathPhaseIndex];
        breathCircle.textContent = phase.text;
        breathCircle.style.transition = `all ${phase.duration / 1000}s cubic-bezier(0.4, 0, 0.2, 1)`;
        breathCircle.style.transform = `scale(${phase.scale})`;
        breathCircle.style.background = phase.background;
        breathingTimeout = setTimeout(() => {
            breathPhaseIndex = (breathPhaseIndex + 1) % breathingSequence.length;
            performBreathPhase();
        }, phase.duration);
    }
    startButton.addEventListener('click', startBreathing);
    stopButton.addEventListener('click', stopBreathing);

    </script>
</body>
</html>
