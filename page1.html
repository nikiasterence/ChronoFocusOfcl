<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="Chronofocus.png" type="image/x-icon">
  <title>Chrono Focus</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      /* A cozy, warm, and simple color palette */
      --background: #F5F0E6;    /* Soft Oat Milk */
      --surface: #FFFFFF;        /* Clean White */
      --primary-accent: #D4B996; /* Warm Taupe */
      --secondary-accent: #A2B2A2;/* Muted Sage Green */
      --text-primary: #5D504A;   /* Soft Walnut Brown */
      --text-secondary: #9B8D86; /* Lighter Brown */
      --border-color: #EAE0D3;
      --shadow-color: rgba(93, 80, 74, 0.1);
      
      --border-radius: 20px;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Nunito', sans-serif;
    }

    body {
      background-color: var(--background);
      color: var(--text-primary);
      min-height: 100vh;
      padding: 25px;
      overflow-x: hidden;
    }

    .app {
      max-width: 900px;
      margin: 0 auto;
      background-color: rgba(255, 255, 255, 0.6);
      border-radius: var(--border-radius);
      padding: 30px;
      border: 1px solid var(--border-color);
      box-shadow: 0 10px 40px var(--shadow-color);
    }

    /* --- Header --- */
    .app-header {
      text-align: center;
      margin-bottom: 40px;
    }
    .app-header h1 {
      font-size: 3rem;
      font-weight: 800;
      color: var(--text-primary);
    }
    .app-header p {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }
      
    /* --- General Section Styling --- */
    .section {
      background: var(--surface);
      padding: 25px;
      border-radius: var(--border-radius);
      margin-bottom: 30px;
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 20px var(--shadow-color);
    }
    .section h2 {
      color: var(--text-primary);
      margin-bottom: 20px;
      font-size: 1.7rem;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
    }
      
    /* --- Task Input --- */
    .task-box {
      display: grid;
      grid-template-columns: 1fr auto auto;
      gap: 15px;
      margin-bottom: 20px;
    }
    input[type="text"], input[type="number"], select {
      padding: 15px 20px;
      background: var(--background);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      font-size: 1rem;
      color: var(--text-primary);
      transition: all 0.3s ease;
    }
    input::placeholder { color: var(--text-secondary); }
    input:focus, select:focus {
      border-color: var(--primary-accent);
      outline: none;
      background: #fff;
      box-shadow: 0 0 0 4px rgba(212, 185, 150, 0.3);
    }
      
    /* --- Main Buttons / Links --- */
    .main-nav {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr; /* 3 columns for the buttons */
      gap: 20px;
      margin-bottom: 30px;
    }
    .main-nav-button {
      padding: 25px 15px; /* Adjusted padding */
      background: var(--surface);
      border-radius: var(--border-radius);
      text-align: center;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px var(--shadow-color);
      cursor: pointer;
      color: var(--text-primary);
      text-decoration: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .main-nav-button:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 30px var(--shadow-color);
    }
    .main-nav-button i {
      font-size: 2.2rem; /* Adjusted icon size */
      margin-bottom: 12px;
      color: var(--primary-accent);
    }
    .main-nav-button h2 {
      font-size: 1.2rem; /* Adjusted font size */
      font-weight: 700;
    }

    /* --- Task List --- */
    #taskList { list-style-type: none; }
    #taskList li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: rgba(245, 240, 230, 0.5);
      border-radius: 15px;
      margin-bottom: 12px;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
      animation: fadeIn 0.5s ease;
    }
    #taskList li:hover {
      background: #fff;
      transform: translateX(5px);
      box-shadow: 0 6px 15px var(--shadow-color);
    }
    .task-info { flex-grow: 1; }
    .task-text { font-size: 1.1rem; font-weight: 600; }
    .task-time { font-size: 0.9rem; color: var(--text-secondary); margin-top: 4px; }
    .completed .task-text { text-decoration: line-through; opacity: 0.6; }
      
    .task-actions { display: flex; gap: 10px; }
      
    /* --- General Button Styling --- */
    button {
      padding: 15px 25px;
      background: var(--surface);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px var(--shadow-color);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 15px var(--shadow-color);
      background-color: #fff;
    }
    button:active {
      transform: translateY(0);
      box-shadow: 0 4px 10px var(--shadow-color);
    }
      
    .task-actions button { padding: 10px 15px; font-size: 0.9rem; }
    .complete-btn:hover { background: #e8f5e9; }
    .delete-btn:hover { background: #ffebf0; }

    /* --- Timer Section --- */
    .timer { 
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .timer > div {
      background: var(--background);
      padding: 25px;
      border-radius: var(--border-radius);
      text-align: center;
    }
    .timer h3 {
      margin-bottom: 15px;
      font-size: 1.3rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .timer-input { margin-bottom: 15px; }
    .timer-input input { width: 100%; text-align: center; }
    .timer p {
      font-size: 2.8rem;
      font-weight: 700;
      color: var(--secondary-accent);
      margin: 20px 0 15px 0;
    }
    .progress-container {
      width: 100%;
      height: 8px;
      background: var(--border-color);
      border-radius: 4px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      background: var(--primary-accent);
      border-radius: 4px;
      width: 0%;
      transition: width 1s linear;
    }
      
    /* --- Other Elements --- */
    .logo-bar {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-bottom: 30px;
    }
    .logo-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.3s ease;
    }
    .logo-item:hover { color: var(--text-primary); transform: translateY(-4px); }
    .logo-icon { font-size: 1.8rem; }
      
    /* --- Spotify Player --- */
    .spotify-player-draggable {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 999;
        background: var(--surface);
        border: 1px solid var(--border-color);
        border-radius: 18px;
        box-shadow: 0 8px 30px var(--shadow-color);
        overflow: hidden;
    }
    .spotify-header {
      padding: 8px;
      text-align: center;
      cursor: move;
      font-size: 0.8rem;
      font-weight: 500;
      background: var(--background);
      color: var(--text-secondary);
    }
      
    /* --- Utility & Animations --- */
    .toast {
      position: fixed;
      bottom: -100px;
      right: 20px;
      padding: 15px 25px;
      background: var(--surface);
      color: var(--text-primary);
      border-radius: 15px;
      box-shadow: 0 10px 30px var(--shadow-color);
      border: 1px solid var(--border-color);
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.25, 1, 0.5, 1);
      z-index: 1000;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .toast.show {
      transform: translateY(-120px);
      opacity: 1;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .pulse { animation: pulse 2s infinite; }
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(162, 178, 162, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(162, 178, 162, 0); } 100% { box-shadow: 0 0 0 0 rgba(162, 178, 162, 0); } }

    /* --- Responsive Design --- */
    @media (max-width: 768px) {
      body { padding: 15px; }
      .app { padding: 20px; }
      .main-nav, .timer, .task-box { grid-template-columns: 1fr; }
      .logo-bar { flex-direction: column; gap: 20px; }
    }
      
  </style>
</head>
<body>
  
  <div class="app">
    <header class="app-header">
      <h1>Chrono Focus</h1>
      <p>Your simple and cozy productivity companion</p>
    </header>

    <section class="section task-section">
      <h2><i class="fas fa-tasks"></i> Task Manager</h2>
      <div class="task-box">
        <input id="taskInput" type="text" placeholder="Enter a new task..." />
        <div class="time-picker" style="display: flex; gap: 10px;">
          <select id="taskHours"><option value="0">0h</option><option value="1">1h</option><option value="2">2h</option></select>
          <select id="taskMinutes"><option value="0">0m</option><option value="5">5m</option><option value="10">10m</option><option value="15">15m</option><option value="20">20m</option><option value="25">25m</option><option value="30">30m</option><option value="45">45m</option></select>
        </div>
        <button onclick="addTask()"><i class="fas fa-plus"></i> Add Task</button>
      </div>
      <ul id="taskList"></ul>
    </section>

    <!-- Grouped Set of 3 Buttons -->
    <nav class="main-nav">
      <a href="page13.html" class="main-nav-button">
        <i class="fas fa-seedling"></i>
        <h2>Pomodoro</h2>
      </a>
      <a href="page2.html" class="main-nav-button">
        <i class="fas fa-graduation-cap"></i>
        <h2>Study Materials</h2>
      </a>
      <a href="page9.html" class="main-nav-button">
        <i class="fas fa-dharmachakra"></i>
        <h2>Deep Focus</h2>
      </a>
    </nav>

    <div class="logo-bar">
      <a href="https://talk.shapes.inc/chat/new?with=optichain" target="_blank" class="logo-item"><div class="logo-icon"><i class="fas fa-robot"></i></div><span>AI Assistant</span></a>
      <a href="page12.html" class="logo-item"><div class="logo-icon"><i class="fas fa-lightbulb"></i></div><span>Motivation</span></a>
    </div>

    <section class="section">
      <h2><i class="fas fa-clock"></i> Focus Timers</h2>
      <div class="timer">
        <div>
          <h3><i class="fas fa-hourglass-start"></i> Focus Timer</h3>
          <div class="timer-input"><input id="focusInput" type="number" placeholder="Minutes" min="1" max="120" /></div>
          <button onclick="startFocus()"><i class="fas fa-play"></i> Start Focus</button>
          <p id="focusTime">25:00</p>
          <div class="progress-container"><div id="focusProgress" class="progress-bar"></div></div>
        </div>
        <div>
          <h3><i class="fas fa-couch"></i> Rest Timer</h3>
          <div class="timer-input"><input id="restInput" type="number" placeholder="Minutes" min="1" max="30" /></div>
          <button onclick="startRest()"><i class="fas fa-play"></i> Start Rest</button>
          <p id="restTime">05:00</p>
          <div class="progress-container"><div id="restProgress" class="progress-bar"></div></div>
        </div>
      </div>
    </section>

  </div>

  <aside class="spotify-player-draggable" id="draggableSpotifyPlayer">
      <div class="spotify-header"><i class="fas fa-arrows-alt"></i> Music Player</div>
      <iframe style="border-radius:0 0 16px 16px;" src="https://open.spotify.com/embed/playlist/2YC8NnwfXuNJxZMDdIehkK?utm_source=generator" width="300" height="80" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
  </aside>

  <div id="toast" class="toast"></div>

<script>
    // --- APP INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', () => {
        loadTasks();
        dragElement(document.getElementById("draggableSpotifyPlayer"));
    });

    // --- TOAST NOTIFICATION ---
    function showToast(message, duration = 3000) {
        const toast = document.getElementById('toast');
        toast.innerHTML = `<i class="fas fa-bell"></i> ${message}`;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), duration);
    }

    // --- TASK MANAGEMENT (WITH LOCALSTORAGE) ---
    function getTasks() {
        return JSON.parse(localStorage.getItem('chronoFocusTasks')) || [];
    }

    function saveTasks(tasks) {
        localStorage.setItem('chronoFocusTasks', JSON.stringify(tasks));
    }

    function renderTask(task) {
        const taskList = document.getElementById('taskList');
        const li = document.createElement('li');
        li.setAttribute('id', task.id);
        if (task.completed) {
            li.classList.add('completed');
        }

        let timeText = '';
        if (task.hours > 0 || task.minutes > 0) {
            timeText = [task.hours > 0 ? `${task.hours}h` : '', task.minutes > 0 ? `${task.minutes}m` : ''].join(' ').trim();
        }

        li.innerHTML = `
            <div class="task-info">
                <div class="task-text">${task.text}</div>
                ${timeText ? `<div class="task-time"><i class="fas fa-clock"></i> ${timeText}</div>` : ''}
            </div>
            <div class="task-actions">
                <button class="complete-btn" onclick="toggleCompleteTask('${task.id}')"><i class="fas fa-check"></i></button>
                <button class="delete-btn" onclick="deleteTask('${task.id}')"><i class="fas fa-trash"></i></button>
            </div>
        `;
        taskList.appendChild(li);
    }

    function loadTasks() {
        const tasks = getTasks();
        document.getElementById('taskList').innerHTML = ''; // Clear list before loading
        tasks.forEach(task => renderTask(task));
    }
    
    function addTask() {
      const taskInput = document.getElementById('taskInput');
      const taskHours = document.getElementById('taskHours');
      const taskMinutes = document.getElementById('taskMinutes');
      const text = taskInput.value.trim();
      
      if (text === '') {
        showToast('Please enter a task!');
        return;
      }

      const tasks = getTasks();
      const newTask = {
          id: 'task-' + Date.now(),
          text: text,
          hours: parseInt(taskHours.value),
          minutes: parseInt(taskMinutes.value),
          completed: false
      };
      
      tasks.push(newTask);
      saveTasks(tasks);
      renderTask(newTask);
      
      taskInput.value = '';
      taskHours.value = '0';
      taskMinutes.value = '0';
      taskInput.focus();
      
      showToast('Task added successfully!');
    }
    
    function toggleCompleteTask(taskId) {
        let tasks = getTasks();
        const taskIndex = tasks.findIndex(t => t.id === taskId);
        if (taskIndex > -1) {
            tasks[taskIndex].completed = !tasks[taskIndex].completed;
            saveTasks(tasks);
            loadTasks();
            if (tasks[taskIndex].completed) {
                showToast('Task completed! Great job!');
            }
        }
    }
    
    function deleteTask(taskId) {
        let tasks = getTasks();
        tasks = tasks.filter(t => t.id !== taskId);
        saveTasks(tasks);

        const li = document.getElementById(taskId);
        if (li) {
          li.style.opacity = '0';
          setTimeout(() => {
              li.remove();
              showToast('Task deleted');
          }, 300);
        }
    }

    document.getElementById('taskInput').addEventListener('keypress', e => { if (e.key === 'Enter') addTask(); });
    
    // --- TIMER FUNCTIONALITY ---
    let focusInterval, restInterval;
    let focusSeconds = 25 * 60, restSeconds = 5 * 60;
    let focusTotal = 25 * 60, restTotal = 5 * 60;
    
    function startTimer(type) {
      const isFocus = type === 'focus';
      const inputEl = document.getElementById(isFocus ? 'focusInput' : 'restInput');
      const defaultMinutes = isFocus ? 25 : 5;
      const minutes = parseInt(inputEl.value) || defaultMinutes;
      
      if (minutes <= 0) return;

      if (isFocus) {
        clearInterval(focusInterval);
        focusSeconds = minutes * 60;
        focusTotal = minutes * 60;
      } else {
        clearInterval(restInterval);
        restSeconds = minutes * 60;
        restTotal = minutes * 60;
      }
      
      updateTime(type);
      updateProgress(isFocus ? 'focusProgress' : 'restProgress', 0);
      
      const interval = setInterval(() => {
        if (isFocus) {
          focusSeconds--;
        } else {
          restSeconds--;
        }

        updateTime(type);
        const currentSeconds = isFocus ? focusSeconds : restSeconds;
        const totalSeconds = isFocus ? focusTotal : restTotal;
        const progress = ((totalSeconds - currentSeconds) / totalSeconds) * 100;
        updateProgress(isFocus ? 'focusProgress' : 'restProgress', progress);
        
        if (currentSeconds <= 0) {
          clearInterval(interval);
          showToast(`${isFocus ? 'Focus' : 'Rest'} time completed!`);
          document.getElementById(isFocus ? 'focusProgress' : 'restProgress').style.width = '100%';
          
          const timerDiv = document.querySelector(`#${isFocus ? 'focusTime' : 'restTime'}`).closest('.timer > div');
          timerDiv.classList.add('pulse');
          setTimeout(() => timerDiv.classList.remove('pulse'), 4000);
        }
      }, 1000);

      if (isFocus) {
        focusInterval = interval;
      } else {
        restInterval = interval;
      }
    }
    
    const startFocus = () => startTimer('focus');
    const startRest = () => startTimer('rest');

    const pad = num => num.toString().padStart(2, '0');

    function updateTime(type) {
        if (type === 'focus') {
            document.getElementById('focusTime').textContent = `${pad(Math.floor(focusSeconds / 60))}:${pad(focusSeconds % 60)}`;
        } else {
            document.getElementById('restTime').textContent = `${pad(Math.floor(restSeconds / 60))}:${pad(restSeconds % 60)}`;
        }
    }

    function updateProgress(elementId, percentage) {
      document.getElementById(elementId).style.width = `${percentage}%`;
    }
    
    // --- DRAGGABLE PLAYER SCRIPT ---
    function dragElement(elmnt) {
        var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
        const header = elmnt.querySelector(".spotify-header");
        if (header) {
            header.onmousedown = dragMouseDown;
        } else {
            elmnt.onmousedown = dragMouseDown;
        }

        function dragMouseDown(e) {
            e.preventDefault();
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            document.onmousemove = elementDrag;
        }

        function elementDrag(e) {
            e.preventDefault();
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
            elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
        }

        function closeDragElement() {
            document.onmouseup = null;
            document.onmousemove = null;
        }
    }
</script>
</body>
</html>
