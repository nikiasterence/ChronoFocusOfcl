<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="Chronofocus.png" type="image/x-icon">
<title>Chrono Focus - Cozy Edition</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
/* --- Default Cozy Mocha Palette --- */
--background: #F9F5F0; /* Soft Cream */
--surface: #FFFFFF; /* White */
--primary: #8D6E63; /* Warm Taupe */
--primary-rgb: 141, 110, 99; /* For RGBA glows */
--primary-light: #EFEBE9; /* Lighter Taupe */
--secondary: #BCAAA4; /* Muted Brown */
--text-primary: #5D4037; /* Dark, soft brown */
--text-secondary: #9E8D86; /* Lighter brown for subtitles */
--border-color: #E7E0D9;
--success: #66BB6A;
--danger: #EF5350;
  --border-radius: 18px; /* Slightly rounder for a softer look */
  --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}

/* --- Theme Palettes --- */
body.theme-sage {
  --background: #F0F4F0;
  --primary: #819A82;
  --primary-rgb: 129, 154, 130;
  --primary-light: #E8EFE8;
  --text-primary: #4F6150;
  --text-secondary: #849385;
  --border-color: #E2E8E2;
}
body.theme-rose {
  --background: #FAF3F5;
  --primary: #C597A2;
  --primary-rgb: 197, 151, 162;
  --primary-light: #F8ECED;
  --text-primary: #7A5C63;
  --text-secondary: #A68F96;
  --border-color: #F1E5E7;
}
body.theme-mist {
    --background: #EFF3F8;
    --primary: #8FACC0;
    --primary-rgb: 143, 172, 192;
    --primary-light: #E8F0F5;
    --text-primary: #526676;
    --text-secondary: #8E9BA9;
    --border-color: #E1E7ED;
}


* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Poppins', sans-serif;
}

body {
  background-color: var(--background);
  color: var(--text-primary);
  min-height: 100vh;
  padding: 25px;
  overflow-x: hidden;
  transition: var(--transition);
}

.app {
  max-width: 900px;
  margin: 0 auto;
}

/* --- Header & Theme Picker --- */
.app-header {
  text-align: center;
  margin-bottom: 40px;
}
.app-header h1 {
  font-size: 2.8rem;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -1px;
}
.app-header p {
  color: var(--text-secondary);
  font-size: 1.1rem;
  margin-top: 5px;
  margin-bottom: 25px;
}
.color-palette {
  display: flex;
  justify-content: center;
  gap: 15px;
}
.color-swatch {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid rgba(0,0,0,0.05);
  transition: var(--transition);
}
.color-swatch:hover { transform: scale(1.15); }
.color-swatch.active {
  box-shadow: 0 0 0 4px var(--background), 0 0 15px 5px rgba(var(--primary-rgb), 0.5);
}


/* --- Dock / Navigation --- */
.main-dock {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 40px;
}
.dock-button {
  padding: 20px;
  background: var(--surface);
  border-radius: var(--border-radius);
  text-align: center;
  border: 1px solid var(--border-color);
  transition: var(--transition);
  box-shadow: 0 5px 20px rgba(var(--primary-rgb), 0.1);
  cursor: pointer;
  color: var(--text-primary);
  text-decoration: none;
}
.dock-button:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 30px rgba(var(--primary-rgb), 0.18);
  border-color: rgba(var(--primary-rgb), 0.3);
}
.dock-button i {
  font-size: 2rem;
  margin-bottom: 12px;
  color: var(--primary);
  background-color: var(--primary-light);
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
}
.dock-button:hover i {
  transform: scale(1.1) rotate(-5deg);
  box-shadow: 0 0 15px rgba(var(--primary-rgb), 0.4);
}
.dock-button h2 { font-size: 1.1rem; font-weight: 600; margin: 0; }
.dock-button p { font-size: 0.85rem; color: var(--text-secondary); }
  
/* --- General Section Styling --- */
.section {
  background: var(--surface);
  padding: 30px;
  border-radius: var(--border-radius);
  margin-bottom: 30px;
  border: 1px solid var(--border-color);
  box-shadow: 0 8px 30px rgba(var(--primary-rgb), 0.12);
}
.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}
.section-header h2 {
  color: var(--text-primary);
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 600;
  margin:0;
}
  
/* --- General Button & Input Styling --- */
button {
  padding: 12px 20px;
  background: var(--primary);
  color: #fff;
  border: none;
  border-radius: 14px;
  cursor: pointer;
  font-weight: 500;
  font-size: 1rem;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  box-shadow: 0 5px 15px rgba(var(--primary-rgb), 0.2);
}
button:hover {
  background: var(--text-primary);
  box-shadow: 0 8px 20px rgba(var(--primary-rgb), 0.3);
  transform: translateY(-3px);
}
input, select {
  padding: 12px 18px;
  background: var(--background);
  border: 1px solid var(--border-color);
  border-radius: 14px;
  font-size: 1rem;
  color: var(--text-primary);
  transition: var(--transition);
  width: 100%;
}
input::placeholder { color: var(--text-secondary); }
input:focus, select:focus {
  border-color: rgba(var(--primary-rgb), 0.5);
  outline: none;
  background: #fff;
  box-shadow: 0 0 0 4px rgba(var(--primary-rgb), 0.1);
}
  
/* --- Task Input --- */
.task-input-grid {
  display: grid;
  grid-template-columns: 1fr auto auto auto auto;
  gap: 15px;
  align-items: center;
  margin-bottom: 20px;
}

/* --- Task Filters --- */
.task-filters {
  display: flex;
  gap: 10px;
}
.task-filters button {
  background: none;
  color: var(--text-secondary);
  box-shadow: none;
  padding: 8px 15px;
  font-weight: 500;
  border: 1px solid var(--border-color);
}
.task-filters button:hover {
  background-color: var(--primary-light);
  color: var(--primary);
}
.task-filters button.active {
  background: var(--primary-light);
  color: var(--primary);
  border-color: rgba(var(--primary-rgb), 0.3);
}

/* --- Task List --- */
#taskList { list-style-type: none; }
#taskList li {
  display: flex;
  align-items: center;
  padding: 15px;
  border-radius: 14px;
  margin-bottom: 12px;
  border: 1px solid var(--border-color);
  transition: var(--transition);
  animation: fadeIn 0.5s ease;
  gap: 15px;
  background: rgba(var(--primary-rgb), 0.02);
}
#taskList li:hover {
  background: var(--surface);
  border-color: rgba(var(--primary-rgb), 0.3);
  transform: scale(1.02);
  box-shadow: 0 6px 15px rgba(var(--primary-rgb), 0.1);
}
.task-info-container {
    display: flex;
    align-items: center;
    gap: 15px;
    flex-grow: 1;
}
.task-icon-container {
    font-size: 1.2rem;
    color: var(--primary);
    background-color: var(--primary-light);
    width: 40px;
    height: 40px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}
.task-details { flex-grow: 1; }
.task-text {
  font-size: 1rem;
  font-weight: 500;
  color: var(--text-primary);
  cursor: pointer;
}
.task-datetime {
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-top: 2px;
}
li.completed {
    opacity: 0.7;
    background: transparent;
}
.completed .task-text { text-decoration: line-through; }
.completed:hover {
    opacity: 1;
}
.task-actions {
  display: flex;
  gap: 10px;
  opacity: 0;
  transition: var(--transition);
}
#taskList li:hover .task-actions {
  opacity: 1;
}
.task-actions button {
  background: none;
  box-shadow: none;
  color: var(--secondary);
  width: 35px;
  height: 35px;
  padding: 0;
  font-size: 1rem;
  border-radius: 10px;
}
.task-actions .complete-btn:hover { background: var(--primary-light); color: var(--success); }
.task-actions .edit-btn:hover { background: var(--primary-light); color: var(--primary); }
.task-actions .delete-btn:hover { background: rgba(239, 83, 80, 0.1); color: var(--danger); }
  
.completed .complete-btn {
    color: var(--success);
}
  
/* --- Toast Notification --- */
.toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  padding: 15px 25px;
  background: var(--surface);
  color: var(--text-primary);
  border-radius: 14px;
  box-shadow: 0 10px 40px rgba(var(--primary-rgb), 0.2);
  border: 1px solid var(--border-color);
  transform: translateY(200%);
  opacity: 0;
  transition: all 0.5s cubic-bezier(0.25, 1, 0.5, 1);
  z-index: 1000;
  font-weight: 500;
}
.toast.show {
  transform: translateY(0);
  opacity: 1;
}
  
/* --- Animations & Utilities --- */
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* --- Responsive Design --- */
@media (max-width: 768px) {
  body { padding: 15px; }
  .section { padding: 20px; }
  .task-input-grid { grid-template-columns: 1fr; }
  .task-input-grid > * { width: 100%; }
}
</style>
</head>
<body>

<div class="app">

<header class="app-header">
<h1>Chrono Focus</h1>
<p>Your calm and cozy productivity partner.</p>
<div class="color-palette" id="colorPalette">
<div class="color-swatch active" style="background-color: #d8683f;" data-theme="default" title="Mocha"></div>
<div class="color-swatch" style="background-color: #4a964d;" data-theme="theme-sage" title="Sage"></div>
<div class="color-swatch" style="background-color: #dc5373;" data-theme="theme-rose" title="Rose"></div>
<div class="color-swatch" style="background-color: #1b3546;" data-theme="theme-mist" title="Mist"></div>
</div>
</header>

<nav class="main-dock">
<a href="page13.html" class="dock-button">
<i class="fas fa-seedling"></i>
<div>
<h2>Pomodoro</h2>
<p>Focus Sprints</p>
</div>
</a>
<a href="page2.html" class="dock-button study-tools">
<i class="fas fa-graduation-cap"></i>
<div>
<h2>Study Materials</h2>
<p>Tools & Resources</p>
</div>
</a>
<a href="page9.html" class="dock-button">
<i class="fas fa-dharmachakra"></i>
<div>
<h2>Deep Focus</h2>
<p>Zen Mode</p>
</div>
</a>
</nav>

<section class="section task-section">
<div class="section-header">
<h2><i class="fas fa-tasks"></i> Task Manager</h2>
<div class="task-filters" id="taskFilters">
<button class="active" data-filter="all">All</button>
<button data-filter="active">Active</button>
<button data-filter="completed">Completed</button>
</div>
</div>

<div class="task-input-grid">
<input id="taskInput" type="text" placeholder="e.g., Read a chapter of a book..." />
<input id="taskDate" type="date" title="Due Date" />
<input id="taskTime" type="time" title="Due Time" />
<select id="taskIcon" title="Task Category">
<option value="fas fa-thumbtack">📌 General</option>
<option value="fas fa-book">📖 Study</option>
<option value="fas fa-briefcase">💼 Work</option>
<option value="fas fa-heartbeat">❤️ Health</option>
<option value="fas fa-shopping-cart">🛒 Shopping</option>
<option value="fas fa-home">🏠 Home</option>
</select>
<button onclick="addTask()"><i class="fas fa-plus"></i> Add Task</button>
</div>

<ul id="taskList">
<!-- Tasks will be rendered here by JavaScript -->
</ul>
</section>

</div>

<div id="toast" class="toast"></div>

<script>
// ALL JAVASCRIPT LOGIC REMAINS UNCHANGED FROM THE PREVIOUS VERSION.
// IT IS ALREADY OPTIMIZED FOR THE TASK MANAGER'S FUNCTIONALITY.

document.addEventListener('DOMContentLoaded', () => {
    initializeTheme();
    loadTasks();
    setupEventListeners();
});

// --- STATE MANAGEMENT ---
let currentFilter = 'all';

// --- TOAST NOTIFICATION ---
function showToast(message, duration = 3000) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), duration);
}

// --- THEME MANAGEMENT ---
function initializeTheme() {
    const savedTheme = localStorage.getItem('chronoFocusTheme') || 'default';
    setTheme(savedTheme);
}

function setTheme(themeName) {
    document.body.className = themeName === 'default' ? '' : themeName;
    
    document.querySelectorAll('.color-swatch').forEach(sw => sw.classList.remove('active'));
    const activeSwatch = document.querySelector(`.color-swatch[data-theme="${themeName}"]`);
    if(activeSwatch) activeSwatch.classList.add('active');

    localStorage.setItem('chronoFocusTheme', themeName);
}


// --- TASK MANAGEMENT (LocalStorage) ---
function getTasks() {
    return JSON.parse(localStorage.getItem('chronoFocusTasks')) || [];
}

function saveTasks(tasks) {
    localStorage.setItem('chronoFocusTasks', JSON.stringify(tasks));
}

function loadTasks() {
    const tasks = getTasks();
    const taskList = document.getElementById('taskList');
    taskList.innerHTML = '';

    // Advanced sorting: by completion, then by date/time
    tasks.sort((a, b) => {
        if (a.completed !== b.completed) return a.completed - b.completed;
        const dateTimeA = a.date && a.time ? `${a.date}T${a.time}` : a.date || '';
        const dateTimeB = b.date && b.time ? `${b.date}T${b.time}` : b.date || '';
        if (dateTimeA && !dateTimeB) return -1;
        if (!dateTimeA && dateTimeB) return 1;
        return dateTimeA.localeCompare(dateTimeB);
    });

    const filteredTasks = tasks.filter(task => {
        if (currentFilter === 'active') return !task.completed;
        if (currentFilter === 'completed') return task.completed;
        return true;
    });

    if (filteredTasks.length === 0) {
        const placeholder = document.createElement('li');
        placeholder.style.cssText = 'justify-content: center; color: var(--text-secondary); background: transparent;';
        placeholder.textContent = 'No tasks here. Add one to get started!';
        taskList.appendChild(placeholder);
    } else {
        filteredTasks.forEach(renderTask);
    }
}


function renderTask(task) {
    const taskList = document.getElementById('taskList');
    const li = document.createElement('li');
    li.dataset.id = task.id;
    if (task.completed) {
        li.classList.add('completed');
    }

    let dateTimeText = '';
    if (task.date) {
        const taskDate = new Date(task.date + 'T00:00:00'); // Mitigate timezone issues
        dateTimeText = taskDate.toLocaleDateDateString(undefined, {
            weekday: 'short', month: 'short', day: 'numeric'
        });
    }
    if (task.time) {
        let [hours, minutes] = task.time.split(':');
        let ampm = +hours >= 12 ? 'PM' : 'AM';
        hours = +hours % 12 || 12;
        dateTimeText += ` at ${hours}:${minutes} ${ampm}`;
    }

    li.innerHTML = `
        <div class="task-info-container">
            <div class="task-icon-container"><i class="${task.icon}"></i></div>
            <div class="task-details" ondblclick="editTask('${task.id}')">
                <div class="task-text">${task.text}</div>
                ${dateTimeText ? `<div class="task-datetime"><i class="far fa-calendar-alt"></i> ${dateTimeText}</div>` : ''}
            </div>
        </div>
        <div class="task-actions">
            <button class="complete-btn" onclick="toggleCompleteTask('${task.id}')" title="Complete Task"><i class="fas fa-check"></i></button>
            <button class="edit-btn" onclick="editTask('${task.id}')" title="Edit Task"><i class="fas fa-pencil-alt"></i></button>
            <button class="delete-btn" onclick="deleteTask('${task.id}')" title="Delete Task"><i class="fas fa-trash"></i></button>
        </div>
    `;
    taskList.appendChild(li);
}

function addTask() {
    const taskInput = document.getElementById('taskInput');
    if (taskInput.value.trim() === '') {
        showToast('Please enter a task description!');
        return;
    }

    const tasks = getTasks();
    const newTask = {
        id: 'task-' + Date.now(),
        text: taskInput.value.trim(),
        date: document.getElementById('taskDate').value,
        time: document.getElementById('taskTime').value,
        icon: document.getElementById('taskIcon').value,
        completed: false
    };
    tasks.push(newTask);
    saveTasks(tasks);
    loadTasks();
    
    // Reset form
    taskInput.value = '';
    document.getElementById('taskDate').value = '';
    document.getElementById('taskTime').value = '';
    taskInput.focus();

    showToast('Task added successfully!');
}

function deleteTask(taskId) {
    if (confirm('Are you sure you want to delete this task?')) {
        let tasks = getTasks().filter(t => t.id !== taskId);
        saveTasks(tasks);
        loadTasks();
        showToast('Task deleted.');
    }
}

function toggleCompleteTask(taskId) {
    let tasks = getTasks();
    const task = tasks.find(t => t.id === taskId);
    if (task) {
        task.completed = !task.completed;
        saveTasks(tasks);
        loadTasks();
        if(task.completed) showToast('Task completed! Great job! 🎉');
    }
}

function editTask(taskId) {
    let tasks = getTasks();
    const task = tasks.find(t => t.id === taskId);
    if(task) {
        const newText = prompt('Enter the new task text:', task.text);
        if (newText && newText.trim() !== '') {
            task.text = newText.trim();
            saveTasks(tasks);
            loadTasks();
            showToast('Task updated!');
        }
    }
}


// --- EVENT LISTENERS ---
function setupEventListeners() {
    document.getElementById('taskInput').addEventListener('keypress', e => {
        if (e.key === 'Enter') addTask();
    });
    
    document.getElementById('colorPalette').addEventListener('click', e => {
        if(e.target.classList.contains('color-swatch')) {
            setTheme(e.target.dataset.theme);
        }
    });

    document.getElementById('taskFilters').addEventListener('click', e => {
        if (e.target.tagName === 'BUTTON') {
            document.querySelectorAll('#taskFilters button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            currentFilter = e.target.dataset.filter;
            loadTasks();
        }
    });
}

</script>

</body>
</html>
