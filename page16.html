<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚úÖ</text></svg>" type="image/svg+xml">
<title>Chrono Focus Pro - Enhanced</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  /* Microsoft Fluent Design Colors */
  --primary-blue: #0078d4;
  --primary-blue-hover: #106ebe;
  --primary-blue-dark: #004578;
  --secondary-blue: #deecf9;
  --accent-purple: #881798;
  --accent-teal: #00bcf2;
  --accent-green: #107c10;
  --accent-orange: #ff8c00;
  --accent-red: #d13438;
  --accent-pink: #e3008c;

  /* Background Colors */
  --bg-primary: #ffffff;
  --bg-secondary: #f3f2f1;
  --bg-tertiary: #faf9f8;
  --bg-card: #ffffff;
  --bg-hover: #f3f2f1;
  --bg-active: #edebe9;
  --bg-selected: #deecf9;

  /* Text Colors */
  --text-primary: #323130;
  --text-secondary: #605e5c;
  --text-tertiary: #a19f9d;
  --text-disabled: #c8c6c4;
  --text-white: #ffffff;
  --text-accent: #0078d4;

  /* Border Colors */
  --border-light: #edebe9;
  --border-medium: #d2d0ce;
  --border-dark: #8a8886;
  --border-focus: #0078d4;

  /* Shadow */
  --shadow-light: 0 1.6px 3.6px 0 rgba(0,0,0,.132), 0 0.3px 0.9px 0 rgba(0,0,0,.108);
  --shadow-medium: 0 3.2px 7.2px 0 rgba(0,0,0,.132), 0 0.6px 1.8px 0 rgba(0,0,0,.108);
  --shadow-heavy: 0 6.4px 14.4px 0 rgba(0,0,0,.132), 0 1.2px 3.6px 0 rgba(0,0,0,.108);
  --shadow-flyout: 0 25.6px 57.6px 0 rgba(0,0,0,.22), 0 4.8px 14.4px 0 rgba(0,0,0,.18);

  /* Border Radius */
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 20px;
  --radius-xxl: 24px;

  /* Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 12px;
  --spacing-lg: 16px;
  --spacing-xl: 20px;
  --spacing-xxl: 24px;
  --spacing-xxxl: 32px;

  /* Typography */
  --font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-xxl: 20px;
  --font-size-xxxl: 24px;

  /* Transitions */
  --transition-fast: 0.1s ease-out;
  --transition-normal: 0.2s ease-out;
  --transition-slow: 0.3s ease-out;

  /* Z-index */
  --z-dropdown: 1000;
  --z-modal: 2000;
  --z-toast: 3000;

  /* Glass Effect */
  --glass-bg: rgba(255, 255, 255, 0.25);
  --glass-border: rgba(255, 255, 255, 0.18);
  --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
  --glass-blur: blur(10px);
}

/* Dark Theme */
body.theme-dark {
  --bg-primary: #1c1c1c;
  --bg-secondary: #252525;
  --bg-tertiary: #2d2d2d;
  --bg-card: #252525;
  --bg-hover: #2d2d2d;
  --bg-active: #363636;
  --bg-selected: #0f3a5c;

  --text-primary: #ffffff;
  --text-secondary: #c8c6c4;
  --text-tertiary: #8a8886;
  --text-disabled: #605e5c;
  --text-accent: #4cc2ff;

  --border-light: #323130;
  --border-medium: #484644;
  --border-dark: #605e5c;
  
  --glass-bg: rgba(0, 0, 0, 0.25);
  --glass-border: rgba(255, 255, 255, 0.1);
}

/* Yellow Theme */
body.theme-yellow {
  --primary-blue: #ffc107;
  --primary-blue-hover: #ffb300;
  --primary-blue-dark: #ff8f00;
  --secondary-blue: #fff8e1;
  --accent-purple: #7b1fa2;
  --accent-teal: #00bcd4;
  --accent-green: #388e3c;
  --accent-orange: #f57c00;
  --accent-red: #d32f2f;
  --accent-pink: #c2185b;

  --bg-primary: #fffde7;
  --bg-secondary: #fff9c4;
  --bg-tertiary: #fff59d;
  --bg-card: #ffffff;
  --bg-hover: #fff176;
  --bg-active: #ffee58;
  --bg-selected: #fff59d;

  --text-primary: #5d4037;
  --text-secondary: #795548;
  --text-tertiary: #8d6e63;
  --text-disabled: #a1887f;
  --text-accent: #ff8f00;
  
  --glass-bg: rgba(255, 253, 231, 0.7);
  --glass-border: rgba(255, 193, 7, 0.3);
}

/* Cotton Candy Theme */
body.theme-cotton-candy {
  --primary-blue: #ff6ec7;
  --primary-blue-hover: #ff4db8;
  --primary-blue-dark: #ff2aa9;
  --secondary-blue: #ffe6f2;
  --accent-purple: #b967ff;
  --accent-teal: #6effe8;
  --accent-green: #6effa8;
  --accent-orange: #ffb86c;
  --accent-red: #ff6e6e;
  --accent-pink: #ff6ec7;

  --bg-primary: #f9f7fe;
  --bg-secondary: #f0eafa;
  --bg-tertiary: #e8dff5;
  --bg-card: #ffffff;
  --bg-hover: #e6d9f2;
  --bg-active: #ddd2ee;
  --bg-selected: #e8dff5;

  --text-primary: #4a4453;
  --text-secondary: #6b6375;
  --text-tertiary: #8c8396;
  --text-disabled: #ada4b5;
  --text-accent: #b967ff;
  
  --glass-bg: rgba(249, 247, 254, 0.7);
  --glass-border: rgba(185, 103, 255, 0.3);
}

/* Ocean Theme */
body.theme-ocean {
  --primary-blue: #2196f3;
  --primary-blue-hover: #1976d2;
  --primary-blue-dark: #0d47a1;
  --secondary-blue: #e3f2fd;
  --accent-purple: #7c4dff;
  --accent-teal: #00bcd4;
  --accent-green: #4caf50;
  --accent-orange: #ff9800;
  --accent-red: #f44336;
  --accent-pink: #e91e63;

  --bg-primary: #e1f5fe;
  --bg-secondary: #b3e5fc;
  --bg-tertiary: #81d4fa;
  --bg-card: #ffffff;
  --bg-hover: #4fc3f7;
  --bg-active: #29b6f6;
  --bg-selected: #81d4fa;

  --text-primary: #01579b;
  --text-secondary: #0277bd;
  --text-tertiary: #0288d1;
  --text-disabled: #4fc3f7;
  --text-accent: #0d47a1;
  
  --glass-bg: rgba(225, 245, 254, 0.7);
  --glass-border: rgba(33, 150, 243, 0.3);
}

/* Forest Theme */
body.theme-forest {
  --primary-blue: #388e3c;
  --primary-blue-hover: #2e7d32;
  --primary-blue-dark: #1b5e20;
  --secondary-blue: #e8f5e9;
  --accent-purple: #7b1fa2;
  --accent-teal: #00695c;
  --accent-green: #388e3c;
  --accent-orange: #ef6c00;
  --accent-red: #c62828;
  --accent-pink: #ad1457;

  --bg-primary: #e8f5e9;
  --bg-secondary: #c8e6c9;
  --bg-tertiary: #a5d6a7;
  --bg-card: #ffffff;
  --bg-hover: #81c784;
  --bg-active: #66bb6a;
  --bg-selected: #a5d6a7;

  --text-primary: #1b5e20;
  --text-secondary: #2e7d32;
  --text-tertiary: #388e3c;
  --text-disabled: #81c784;
  --text-accent: #1b5e20;
  
  --glass-bg: rgba(232, 245, 233, 0.7);
  --glass-border: rgba(56, 142, 60, 0.3);
}

/* Global Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-family);
  font-size: var(--font-size-md);
  color: var(--text-primary);
  background-color: var(--bg-primary);
  line-height: 1.4;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color var(--transition-normal), color var(--transition-normal);
}

/* Glass Effect */
.glass-effect {
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-shadow);
}

/* App Container */
.app {
  display: flex;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
  background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
}

/* Sidebar */
.sidebar {
  width: 280px;
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-right: 1px solid var(--glass-border);
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
  overflow: hidden;
  transition: transform var(--transition-normal);
  z-index: 100;
  border-radius: 0 var(--radius-xl) var(--radius-xl) 0;
}

.sidebar.collapsed {
  transform: translateX(-100%);
}

/* App Header */
.app-header {
  padding: var(--spacing-lg);
  border-bottom: 1px solid var(--glass-border);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-radius: 0 var(--radius-xl) 0 0;
}

.app-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  font-size: var(--font-size-xl);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--spacing-md);
}

.app-icon {
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, var(--primary-blue), var(--accent-purple));
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: var(--font-size-lg);
}

.user-profile {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  padding: var(--spacing-md);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: all var(--transition-fast);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.user-profile:hover {
  background: var(--bg-hover);
  transform: translateY(-2px);
  box-shadow: var(--shadow-light);
}

.user-avatar {
  width: 40px;
  height: 40px;
  background: var(--primary-blue);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: var(--font-size-md);
  overflow: hidden;
  border: 2px solid var(--glass-border);
}

.user-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.user-info {
  flex: 1;
}

.user-name {
  font-weight: 500;
  font-size: var(--font-size-md);
  color: var(--text-primary);
}

.user-email {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

/* Navigation */
.nav-section {
  padding: var(--spacing-lg);
  flex: 1;
  overflow-y: auto;
}

.nav-group {
  margin-bottom: var(--spacing-xxl);
}

.nav-group-title {
  font-size: var(--font-size-xs);
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: var(--spacing-md);
  padding: 0 var(--spacing-md);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  padding: var(--spacing-md);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: all var(--transition-fast);
  margin-bottom: var(--spacing-xs);
  font-size: var(--font-size-md);
  color: var(--text-primary);
  text-decoration: none;
  border: none;
  background: none;
  width: 100%;
  text-align: left;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.nav-item:hover {
  background: var(--bg-hover);
  transform: translateX(5px);
  box-shadow: var(--shadow-light);
}

.nav-item.active {
  background: var(--bg-selected);
  color: var(--text-accent);
  font-weight: 500;
  box-shadow: var(--shadow-medium);
}

.nav-item i {
  width: 20px;
  text-align: center;
  font-size: var(--font-size-lg);
}

.nav-item-text {
  flex: 1;
}

.nav-item-count {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  background: var(--bg-tertiary);
  padding: 2px 8px;
  border-radius: 12px;
  min-width: 20px;
  text-align: center;
}

.nav-item.active .nav-item-count {
  background: var(--primary-blue);
  color: white;
}

/* Settings */
.sidebar-footer {
  padding: var(--spacing-lg);
  border-top: 1px solid var(--glass-border);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-radius: 0 0 var(--radius-xl) 0;
}

/* Main Content */
.main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: transparent;
}

/* Main Header */
.main-header {
  padding: var(--spacing-lg) var(--spacing-xxl);
  border-bottom: 1px solid var(--glass-border);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 64px;
  border-radius: 0 0 var(--radius-xl) var(--radius-xl);
}

.header-left {
  display: flex;
  align-items: center;
  gap: var(--spacing-lg);
}

.menu-btn {
  display: none;
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: var(--font-size-xl);
  cursor: pointer;
  padding: var(--spacing-sm);
  border-radius: var(--radius-md);
  transition: all var(--transition-fast);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.menu-btn:hover {
  background: var(--bg-hover);
  transform: scale(1.1);
}

.page-title {
  font-size: var(--font-size-xxl);
  font-weight: 600;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.page-title i {
  font-size: var(--font-size-xl);
}

.header-actions {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.header-btn {
  background: none;
  border: none;
  color: var(--text-secondary);
  font-size: var(--font-size-lg);
  cursor: pointer;
  padding: var(--spacing-sm);
  border-radius: var(--radius-md);
  transition: all var(--transition-fast);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.header-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  transform: scale(1.1);
}

/* Task Input */
.task-input-container {
  padding: var(--spacing-xl) var(--spacing-xxl);
  border-bottom: 1px solid var(--glass-border);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.task-input-wrapper {
  position: relative;
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-md);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-xl);
  padding: var(--spacing-lg);
  transition: all var(--transition-fast);
  box-shadow: var(--shadow-light);
}

.task-input-wrapper:focus-within {
  border-color: var(--border-focus);
  box-shadow: var(--shadow-medium);
  transform: translateY(-2px);
}

.task-checkbox-placeholder {
  width: 20px;
  height: 20px;
  border: 2px solid var(--border-medium);
  border-radius: 50%;
  flex-shrink: 0;
  margin-top: 2px;
}

.task-input {
  flex: 1;
  border: none;
  outline: none;
  background: none;
  font-size: var(--font-size-lg);
  font-family: inherit;
  color: var(--text-primary);
  resize: none;
  min-height: 24px;
  max-height: 120px;
  line-height: 1.4;
}

.task-input::placeholder {
  color: var(--text-tertiary);
}

.task-input-actions {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  opacity: 0;
  transition: opacity var(--transition-fast);
}

.task-input-wrapper:focus-within .task-input-actions,
.task-input-wrapper:hover .task-input-actions {
  opacity: 1;
}

.task-input-btn {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-sm);
  border-radius: var(--radius-md);
  font-size: var(--font-size-md);
  transition: all var(--transition-fast);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.task-input-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  transform: scale(1.1);
}

.task-input-btn.primary {
  background: var(--primary-blue);
  color: white;
}

.task-input-btn.primary:hover {
  background: var(--primary-blue-hover);
  transform: scale(1.1);
}

/* Task Options Panel */
.task-options-panel {
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-bottom: 1px solid var(--glass-border);
  padding: 0 var(--spacing-xxl) var(--spacing-lg);
  display: none;
  border-radius: 0 0 var(--radius-xl) var(--radius-xl);
}

.task-options-panel.visible {
  display: block;
  animation: slideDown 0.3s ease-out;
}

.task-options-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-lg);
}

.task-option-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.task-option-label {
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--text-secondary);
}

.task-option-select {
  padding: var(--spacing-sm) var(--spacing-md);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  color: var(--text-primary);
  font-size: var(--font-size-md);
  cursor: pointer;
  transition: border-color var(--transition-fast);
}

.task-option-select:focus {
  outline: none;
  border-color: var(--border-focus);
}

/* Task List */
.task-list-container {
  flex: 1;
  overflow-y: auto;
  background: transparent;
  padding: var(--spacing-xl);
}

.task-list-header {
  padding: var(--spacing-xl) var(--spacing-xxl) var(--spacing-lg);
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--glass-border);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  position: sticky;
  top: 0;
  z-index: 10;
  border-radius: var(--radius-xl) var(--radius-xl) 0 0;
}

.task-list-info {
  display: flex;
  align-items: center;
  gap: var(--spacing-lg);
}

.task-count {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

.task-filters {
  display: flex;
  gap: var(--spacing-sm);
}

.filter-btn {
  background: none;
  border: 1px solid var(--glass-border);
  color: var(--text-secondary);
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-lg);
  font-size: var(--font-size-sm);
  cursor: pointer;
  transition: all var(--transition-fast);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.filter-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  transform: translateY(-2px);
}

.filter-btn.active {
  background: var(--primary-blue);
  border-color: var(--primary-blue);
  color: white;
  box-shadow: var(--shadow-light);
}

.task-list {
  padding: 0 var(--spacing-xxl) var(--spacing-xl);
}

.task-item {
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-lg);
  padding: var(--spacing-lg);
  margin-bottom: var(--spacing-md);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-xl);
  cursor: pointer;
  transition: all var(--transition-fast);
  box-shadow: var(--shadow-light);
  position: relative;
  animation: slideInUp 0.3s ease-out;
}

.task-item:hover {
  box-shadow: var(--shadow-medium);
  transform: translateY(-3px);
  border-color: var(--border-medium);
}

.task-item.completed {
  opacity: 0.7;
}

.task-item.completed .task-content {
  text-decoration: line-through;
  color: var(--text-secondary);
}

.task-checkbox {
  width: 20px;
  height: 20px;
  border: 2px solid var(--border-medium);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--transition-fast);
  flex-shrink: 0;
  margin-top: 2px;
}

.task-checkbox:hover {
  border-color: var(--primary-blue);
  transform: scale(1.1);
}

.task-checkbox.checked {
  background: var(--primary-blue);
  border-color: var(--primary-blue);
  color: white;
  box-shadow: var(--shadow-light);
}

.task-checkbox i {
  font-size: 10px;
  opacity: 0;
  transition: opacity var(--transition-fast);
}

.task-checkbox.checked i {
  opacity: 1;
}

.task-content-wrapper {
  flex: 1;
  min-width: 0;
}

.task-content {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  margin-bottom: var(--spacing-xs);
}

.task-icon {
  color: var(--text-secondary);
  font-size: var(--font-size-md);
  width: 16px;
  text-align: center;
  flex-shrink: 0;
}

.task-text {
  font-size: var(--font-size-md);
  color: var(--text-primary);
  line-height: 1.4;
  word-break: break-word;
  flex: 1;
}

.task-meta {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  flex-wrap: wrap;
  margin-top: var(--spacing-xs);
}

.task-meta-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.task-priority {
  padding: 2px 8px;
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: 500;
  text-transform: uppercase;
}

.task-priority.high {
  background: rgba(209, 52, 56, 0.1);
  color: var(--accent-red);
}

.task-priority.medium {
  background: rgba(255, 140, 0, 0.1);
  color: var(--accent-orange);
}

.task-priority.low {
  background: rgba(16, 124, 16, 0.1);
  color: var(--accent-green);
}

.task-actions {
  display: flex;
  gap: var(--spacing-xs);
  opacity: 0;
  transition: opacity var(--transition-fast);
}

.task-item:hover .task-actions {
  opacity: 1;
}

.task-action-btn {
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: var(--spacing-xs);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
  transition: all var(--transition-fast);
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.task-action-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  transform: scale(1.1);
}

.task-action-btn.edit:hover {
  color: var(--primary-blue);
}

.task-action-btn.delete:hover {
  color: var(--accent-red);
}

.task-action-btn.star:hover {
  color: var(--accent-orange);
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: var(--spacing-xxxl);
  color: var(--text-secondary);
}

.empty-state-icon {
  font-size: 48px;
  color: var(--text-tertiary);
  margin-bottom: var(--spacing-lg);
}

.empty-state-title {
  font-size: var(--font-size-xl);
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: var(--spacing-sm);
}

.empty-state-text {
  font-size: var(--font-size-md);
  line-height: 1.5;
}

/* Modals */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.4);
  z-index: var(--z-modal);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-normal);
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
}

.modal-overlay.visible {
  opacity: 1;
  visibility: visible;
}

.modal {
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-flyout);
  max-width: 500px;
  width: 90%;
  max-height: 80vh;
  overflow: hidden;
  transform: scale(0.9);
  transition: transform var(--transition-normal);
  border: 1px solid var(--glass-border);
}

.modal-overlay.visible .modal {
  transform: scale(1);
}

.modal-header {
  padding: var(--spacing-xl);
  border-bottom: 1px solid var(--glass-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.modal-title {
  font-size: var(--font-size-xl);
  font-weight: 600;
  color: var(--text-primary);
}

.modal-close {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: var(--spacing-sm);
  border-radius: var(--radius-md);
  font-size: var(--font-size-lg);
  transition: all var(--transition-fast);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.modal-close:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  transform: scale(1.1);
}

.modal-content {
  padding: var(--spacing-xl);
  overflow-y: auto;
  max-height: 60vh;
}

.modal-footer {
  padding: var(--spacing-xl);
  border-top: 1px solid var(--glass-border);
  display: flex;
  justify-content: flex-end;
  gap: var(--spacing-md);
}

/* Login Modal */
.login-form {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.form-label {
  font-size: var(--font-size-md);
  font-weight: 500;
  color: var(--text-primary);
}

.form-input {
  padding: var(--spacing-md);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  color: var(--text-primary);
  font-size: var(--font-size-md);
  transition: border-color var(--transition-fast);
}

.form-input:focus {
  outline: none;
  border-color: var(--border-focus);
}

.avatar-upload {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.avatar-preview {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: var(--primary-blue);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: var(--font-size-lg);
  overflow: hidden;
  border: 2px solid var(--glass-border);
}

.avatar-preview img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.avatar-upload-btn {
  background: var(--bg-secondary);
  border: 1px solid var(--glass-border);
  color: var(--text-primary);
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-lg);
  font-size: var(--font-size-sm);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.avatar-upload-btn:hover {
  background: var(--bg-hover);
}

/* Settings Modal */
.settings-grid {
  display: grid;
  gap: var(--spacing-xl);
}

.setting-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.setting-group-title {
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--spacing-sm);
}

.setting-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-lg);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-radius: var(--radius-lg);
  border: 1px solid var(--glass-border);
}

.setting-info {
  flex: 1;
}

.setting-title {
  font-size: var(--font-size-md);
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: var(--spacing-xs);
}

.setting-description {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

/* Theme Selector */
.theme-selector {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: var(--spacing-md);
  margin-top: var(--spacing-md);
}

.theme-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-md);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: all var(--transition-fast);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--glass-border);
}

.theme-option:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-light);
}

.theme-option.active {
  border-color: var(--primary-blue);
  box-shadow: 0 0 0 2px var(--primary-blue);
}

.theme-preview {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: var(--font-size-sm);
}

.theme-name {
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--text-primary);
}

/* AI Summary Panel */
.ai-summary-panel {
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-xl);
  padding: var(--spacing-lg);
  margin-bottom: var(--spacing-lg);
  box-shadow: var(--shadow-light);
  animation: slideInDown 0.5s ease-out;
}

.ai-summary-header {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-md);
}

.ai-summary-icon {
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, var(--primary-blue), var(--accent-purple));
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: var(--font-size-md);
}

.ai-summary-title {
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
}

.ai-summary-content {
  font-size: var(--font-size-md);
  color: var(--text-secondary);
  line-height: 1.5;
}

/* Toggle Switch */
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--border-medium);
  transition: var(--transition-fast);
  border-radius: 12px;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: var(--transition-fast);
  border-radius: 50%;
}

input:checked + .toggle-slider {
  background-color: var(--primary-blue);
}

input:checked + .toggle-slider:before {
  transform: translateX(20px);
}

/* Buttons */
.btn {
  padding: var(--spacing-sm) var(--spacing-lg);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  font-size: var(--font-size-md);
  font-weight: 500;
  cursor: pointer;
  transition: all var(--transition-fast);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  text-decoration: none;
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  color: var(--text-primary);
}

.btn:hover {
  background: var(--bg-hover);
  transform: translateY(-2px);
  box-shadow: var(--shadow-light);
}

.btn.primary {
  background: var(--primary-blue);
  border-color: var(--primary-blue);
  color: white;
}

.btn.primary:hover {
  background: var(--primary-blue-hover);
  border-color: var(--primary-blue-hover);
  transform: translateY(-2px);
}

.btn.secondary {
  background: var(--bg-secondary);
  border-color: var(--glass-border);
}

.btn.danger {
  background: var(--accent-red);
  border-color: var(--accent-red);
  color: white;
}

.btn.danger:hover {
  background: #b02a2e;
  transform: translateY(-2px);
}

/* Toast Notifications */
.toast-container {
  position: fixed;
  top: var(--spacing-xl);
  right: var(--spacing-xl);
  z-index: var(--z-toast);
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
  max-width: 400px;
}

.toast {
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-heavy);
  padding: var(--spacing-lg);
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  transform: translateX(120%);
  transition: transform var(--transition-normal);
}

.toast.show {
  transform: translateX(0);
}

.toast-icon {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-sm);
  flex-shrink: 0;
}

.toast.success .toast-icon {
  background: var(--accent-green);
  color: white;
}

.toast.error .toast-icon {
  background: var(--accent-red);
  color: white;
}

.toast.info .toast-icon {
  background: var(--primary-blue);
  color: white;
}

.toast-content {
  flex: 1;
}

.toast-title {
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: var(--spacing-xs);
}

.toast-message {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

.toast-close {
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: var(--spacing-xs);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
  transition: all var(--transition-fast);
}

.toast-close:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

/* Animations */
@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.9);
  }
}

@keyframes pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.05);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes float {
  0% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-5px);
  }
  100% {
    transform: translateY(0px);
  }
}

.fade-out {
  animation: fadeOut 0.2s ease-out forwards;
}

.pulse {
  animation: pulse 2s infinite;
}

.float {
  animation: float 3s ease-in-out infinite;
}

/* Blur Effect */
.blur-effect {
  filter: blur(5px);
  transition: filter 0.3s ease-out;
}

.blur-effect-removing {
  filter: blur(0);
}

/* Liquid Glass Effect */
.liquid-glass {
  position: relative;
  overflow: hidden;
}

.liquid-glass::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  animation: liquidFlow 3s infinite;
}

@keyframes liquidFlow {
  0% {
    left: -100%;
  }
  100% {
    left: 100%;
  }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    left: 0;
    top: 0;
    height: 100vh;
    z-index: 200;
    transform: translateX(-100%);
  }

  .sidebar.visible {
    transform: translateX(0);
  }

  .menu-btn {
    display: block;
  }

  .main-header {
    padding: var(--spacing-lg);
  }

  .page-title {
    font-size: var(--font-size-xl);
  }

  .task-input-container {
    padding: var(--spacing-lg);
  }

  .task-list-header {
    padding: var(--spacing-lg);
  }

  .task-list {
    padding: 0 var(--spacing-lg) var(--spacing-lg);
  }

  .task-item {
    padding: var(--spacing-md);
  }

  .toast-container {
    top: var(--spacing-lg);
    right: var(--spacing-lg);
    left: var(--spacing-lg);
    max-width: none;
  }

  .modal {
    width: 95%;
    margin: var(--spacing-lg);
  }

  .task-options-grid {
    grid-template-columns: 1fr;
  }

  .task-input {
    font-size: 16px; /* Prevent zoom on iOS */
  }
  
  .theme-selector {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .app-header {
    padding: var(--spacing-md);
  }

  .app-title {
    font-size: var(--font-size-lg);
  }

  .nav-section {
    padding: var(--spacing-md);
  }

  .task-meta {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--spacing-xs);
  }

  .task-actions {
    position: absolute;
    top: var(--spacing-md);
    right: var(--spacing-md);
    opacity: 1;
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    -webkit-backdrop-filter: var(--glass-blur);
    border-radius: var(--radius-md);
    padding: var(--spacing-xs);
    box-shadow: var(--shadow-light);
  }
  
  .theme-selector {
    grid-template-columns: 1fr;
  }
}

/* Dark theme specific adjustments */
body.theme-dark .toast {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
}

body.theme-dark .modal {
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-tertiary);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--border-medium);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--border-dark);
}

/* Focus styles for accessibility */
button:focus,
input:focus,
select:focus,
.task-item:focus {
  outline: 2px solid var(--primary-blue);
  outline-offset: 2px;
}

/* Print styles */
@media print {
  .sidebar,
  .header-actions,
  .task-actions,
  .task-input-container,
  .task-options-panel,
  .ai-summary-panel {
    display: none !important;
  }

  .main-content {
    margin: 0;
  }

  .task-item {
    break-inside: avoid;
    box-shadow: none;
    border: 1px solid #ccc;
  }
}

/* Drag and drop styles */
.task-item.dragging {
  opacity: 0.5;
  transform: rotate(2deg);
  z-index: 1000;
}

.drop-zone {
  min-height: 60px;
  border: 2px dashed var(--border-medium);
  border-radius: var(--radius-xl);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: var(--spacing-md) 0;
  color: var(--text-secondary);
  font-size: var(--font-size-md);
  transition: all var(--transition-fast);
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.drop-zone.drag-over {
  border-color: var(--primary-blue);
  background: var(--bg-selected);
  color: var(--text-accent);
}

/* Loading states */
.loading {
  position: relative;
  overflow: hidden;
}

.loading::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% {
    left: -100%;
  }
  100% {
    left: 100%;
  }
}
</style>
</head>
<body class="theme-dark">

<!-- App Container -->
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <!-- App Header -->
    <header class="app-header">
      <div class="app-title">
        <div class="app-icon">
          <i class="fas fa-check"></i>
        </div>
        Chrono Focus Pro
      </div>
      
      <div class="user-profile" id="userProfile">
        <div class="user-avatar" id="userAvatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-info">
          <div class="user-name" id="userName">Guest</div>
          <div class="user-email" id="userEmail">Click to login</div>
        </div>
        <i class="fas fa-chevron-right" style="color: var(--text-tertiary);"></i>
      </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-section">
      <div class="nav-group">
        <div class="nav-group-title">Tasks</div>
        <button class="nav-item active" data-view="my-day">
          <i class="fas fa-sun"></i>
          <span class="nav-item-text">My Day</span>
          <span class="nav-item-count" id="myDayCount">0</span>
        </button>
        <button class="nav-item" data-view="important">
          <i class="fas fa-star"></i>
          <span class="nav-item-text">Important</span>
          <span class="nav-item-count" id="importantCount">0</span>
        </button>
        <button class="nav-item" data-view="planned">
          <i class="fas fa-calendar-alt"></i>
          <span class="nav-item-text">Planned</span>
          <span class="nav-item-count" id="plannedCount">0</span>
        </button>
        <button class="nav-item" data-view="assigned">
          <i class="fas fa-user"></i>
          <span class="nav-item-text">Assigned to me</span>
          <span class="nav-item-count" id="assignedCount">0</span>
        </button>
        <button class="nav-item" data-view="tasks">
          <i class="fas fa-home"></i>
          <span class="nav-item-text">Tasks</span>
          <span class="nav-item-count" id="tasksCount">0</span>
        </button>
      </div>

      <div class="nav-group">
        <div class="nav-group-title">Lists</div>
        <div id="customLists">
          <!-- Custom lists will be added here -->
        </div>
      </div>
    </nav>

    <!-- Settings -->
    <footer class="sidebar-footer">
      <button class="nav-item" id="settingsBtn">
        <i class="fas fa-cog"></i>
        <span class="nav-item-text">Settings</span>
      </button>
    </footer>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Main Header -->
    <header class="main-header">
      <div class="header-left">
        <button class="menu-btn" id="menuBtn" aria-label="Toggle Menu">
          <i class="fas fa-bars"></i>
        </button>
        <h1 class="page-title" id="pageTitle">
          <i class="fas fa-sun"></i>
          My Day
        </h1>
      </div>
      <div class="header-actions">
        <button class="header-btn" id="sortBtn" title="Sort" aria-label="Sort tasks">
          <i class="fas fa-sort"></i>
        </button>
        <button class="header-btn" id="viewBtn" title="View options" aria-label="View options">
          <i class="fas fa-th-list"></i>
        </button>
        <button class="header-btn" id="shareBtn" title="Share list" aria-label="Share list">
          <i class="fas fa-share-alt"></i>
        </button>
        <button class="header-btn" id="moreBtn" title="More options" aria-label="More options">
          <i class="fas fa-ellipsis-h"></i>
        </button>
      </div>
    </header>

    <!-- AI Summary Panel -->
    <div class="ai-summary-panel" id="aiSummaryPanel" style="display: none;">
      <div class="ai-summary-header">
        <div class="ai-summary-icon">
          <i class="fas fa-robot"></i>
        </div>
        <div class="ai-summary-title">Your Monthly Task Summary</div>
      </div>
      <div class="ai-summary-content" id="aiSummaryContent">
        <!-- AI-generated summary will appear here -->
      </div>
    </div>

    <!-- Task Input -->
    <section class="task-input-container">
      <div class="task-input-wrapper">
        <div class="task-checkbox-placeholder"></div>
        <textarea 
          class="task-input" 
          id="taskInput" 
          placeholder="Add a task"
          rows="1"
          aria-label="Add a new task"
        ></textarea>
        <div class="task-input-actions">
          <button class="task-input-btn" id="taskOptionsBtn" title="Add options" aria-label="Task options">
            <i class="fas fa-plus"></i>
          </button>
          <button class="task-input-btn primary" id="addTaskBtn" title="Add task" aria-label="Add task">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- Task Options Panel -->
    <section class="task-options-panel" id="taskOptionsPanel">
      <div class="task-options-grid">
        <div class="task-option-group">
          <label class="task-option-label">Priority</label>
          <select class="task-option-select" id="taskPriority" aria-label="Task priority">
            <option value="low">Low</option>
            <option value="medium" selected>Normal</option>
            <option value="high">High</option>
          </select>
        </div>
        <div class="task-option-group">
          <label class="task-option-label">Category</label>
          <select class="task-option-select" id="taskCategory" aria-label="Task category">
            <option value="general">üìã General</option>
            <option value="work">üíº Work</option>
            <option value="personal">üë§ Personal</option>
            <option value="shopping">üõí Shopping</option>
            <option value="health">‚ù§Ô∏è Health</option>
            <option value="learning">üìö Learning</option>
          </select>
        </div>
        <div class="task-option-group">
          <label class="task-option-label">Due Date</label>
          <input type="date" class="task-option-select" id="taskDueDate" aria-label="Task due date">
        </div>
        <div class="task-option-group">
          <label class="task-option-label">Reminder</label>
          <input type="datetime-local" class="task-option-select" id="taskReminder" aria-label="Task reminder">
        </div>
      </div>
    </section>

    <!-- Task List -->
    <section class="task-list-container">
      <div class="task-list-header">
        <div class="task-list-info">
          <span class="task-count" id="taskCount">0 tasks</span>
        </div>
        <div class="task-filters">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="active">Active</button>
          <button class="filter-btn" data-filter="completed">Completed</button>
        </div>
      </div>

      <div class="task-list" id="taskList">
        <!-- Tasks will be rendered here -->
      </div>

      <!-- Empty State -->
      <div class="empty-state" id="emptyState" style="display: none;">
        <div class="empty-state-icon">
          <i class="fas fa-clipboard-check"></i>
        </div>
        <div class="empty-state-title">No tasks yet</div>
        <div class="empty-state-text">
          Add a task above to get started with your productivity journey.
        </div>
      </div>
    </section>
  </main>
</div>

<!-- Login Modal -->
<div class="modal-overlay" id="loginModal">
  <div class="modal">
    <div class="modal-header">
      <h2 class="modal-title">Welcome to Chrono Focus Pro</h2>
      <button class="modal-close" id="closeLoginModal" aria-label="Close login">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-content">
      <div class="login-form">
        <div class="form-group">
          <label class="form-label" for="loginName">Your Name</label>
          <input type="text" class="form-input" id="loginName" placeholder="Enter your name">
        </div>
        
        <div class="form-group">
          <label class="form-label" for="loginEmail">Email (optional)</label>
          <input type="email" class="form-input" id="loginEmail" placeholder="Enter your email">
        </div>
        
        <div class="form-group">
          <label class="form-label">Profile Picture</label>
          <div class="avatar-upload">
            <div class="avatar-preview" id="avatarPreview">
              <i class="fas fa-user"></i>
            </div>
            <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
            <button class="avatar-upload-btn" id="avatarUploadBtn">Choose Image</button>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn primary" id="saveLoginBtn">Get Started</button>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div class="modal-overlay" id="settingsModal">
  <div class="modal">
    <div class="modal-header">
      <h2 class="modal-title">Settings</h2>
      <button class="modal-close" id="closeSettingsModal" aria-label="Close settings">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-content">
      <div class="settings-grid">
        <!-- Theme Settings -->
        <div class="setting-group">
          <div class="setting-group-title">Theme</div>
          
          <div class="theme-selector">
            <div class="theme-option active" data-theme="dark">
              <div class="theme-preview" style="background: linear-gradient(135deg, #1c1c1c, #252525);">
                <i class="fas fa-moon"></i>
              </div>
              <div class="theme-name">Dark</div>
            </div>
            <div class="theme-option" data-theme="yellow">
              <div class="theme-preview" style="background: linear-gradient(135deg, #ffc107, #ffb300);">
                <i class="fas fa-sun"></i>
              </div>
              <div class="theme-name">Sunshine</div>
            </div>
            <div class="theme-option" data-theme="cotton-candy">
              <div class="theme-preview" style="background: linear-gradient(135deg, #ff6ec7, #b967ff);">
                <i class="fas fa-cloud"></i>
              </div>
              <div class="theme-name">Cotton Candy</div>
            </div>
            <div class="theme-option" data-theme="ocean">
              <div class="theme-preview" style="background: linear-gradient(135deg, #2196f3, #0d47a1);">
                <i class="fas fa-water"></i>
              </div>
              <div class="theme-name">Ocean</div>
            </div>
            <div class="theme-option" data-theme="forest">
              <div class="theme-preview" style="background: linear-gradient(135deg, #388e3c, #1b5e20);">
                <i class="fas fa-tree"></i>
              </div>
              <div class="theme-name">Forest</div>
            </div>
          </div>
        </div>

        <!-- Appearance Settings -->
        <div class="setting-group">
          <div class="setting-group-title">Appearance</div>
          
          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Glass Effect</div>
              <div class="setting-description">Enable frosted glass appearance</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="glassEffectToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Rounded Corners</div>
              <div class="setting-description">Use rounded UI elements</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="roundedCornersToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Animations</div>
              <div class="setting-description">Enable smooth animations</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="animationsToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <!-- Sound Settings -->
        <div class="setting-group">
          <div class="setting-group-title">Sound</div>
          
          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Sound Effects</div>
              <div class="setting-description">Play sounds for actions</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="soundEffectsToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Task Completion Sound</div>
              <div class="setting-description">Play sound when completing tasks</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="completionSoundToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Notification Sounds</div>
              <div class="setting-description">Play sounds for notifications</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="notificationSoundToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <!-- Task Settings -->
        <div class="setting-group">
          <div class="setting-group-title">Tasks</div>
          
          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Auto-complete Subtasks</div>
              <div class="setting-description">Automatically complete parent task when all subtasks are done</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="autoCompleteToggle">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Move Completed Tasks</div>
              <div class="setting-description">Move completed tasks to the bottom of the list</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="moveCompletedToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Smart Suggestions</div>
              <div class="setting-description">Show task suggestions based on your history</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="smartSuggestionsToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <!-- Notifications -->
        <div class="setting-group">
          <div class="setting-group-title">Notifications</div>
          
          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Desktop Notifications</div>
              <div class="setting-description">Show notifications for reminders and deadlines</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="desktopNotificationsToggle">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">Daily Summary</div>
              <div class="setting-description">Get a daily summary of your tasks</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="dailySummaryToggle">
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-info">
              <div class="setting-title">AI Monthly Summary</div>
              <div class="setting-description">Show AI-generated monthly task summary</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="aiSummaryToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn secondary" id="resetSettingsBtn">Reset to Default</button>
      <button class="btn primary" id="saveSettingsBtn">Save Changes</button>
    </div>
  </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Audio Elements -->
<audio id="taskCompleteSound" preload="auto">
  <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2v2MbBjiR2O/NdSgEIXHA9eGVSwwQU6vmu3MgBCl+zPLOeSEEIF/A7+OYTw4WXrPh5oxLEAk+ltryxXUiBC19zPLNeSMEJHfH8N+QQAkUXrTp66hWFAlFn+D2wGQaBS2w7ur1sIA0==" type="audio/wav">
</audio>

<audio id="taskAddSound" preload="auto">
  <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2v2MbBjiR2O/NdSgEIXHA9eGVSwwQU6vmu3MgBCl+zPLOeSEEIF/A7+OYTw4WXrPh5oxLEAk+ltryxXUiBC19zPLNeSMEJHfH8N+QQAkUXrTp66hWFAlFn+D2wGQaBS2w7ur1sIA0=" type="audio/wav">
</audio>

<audio id="taskDeleteSound" preload="auto">
  <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2v2MbBjiR2O/NdSgEIXHA9eGVSwwQU6vmu3MgBCl+zPLOeSEEIF/A7+OYTw4WXrPh5oxLEAk+ltryxXUiBC19zPLNeSMEJHfH8N+QQAkUXrTp66hWFAlFn+D2wGQaBS2w7ur1sIA0=" type="audio/wav">
</audio>

<audio id="notificationSound" preload="auto">
  <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2v2MbBjiR2O/NdSgEIXHA9eGVSwwQU6vmu3MgBCl+zPLOeSEEIF/A7+OYTw4WXrPh5oxLEAk+ltryxXUiBC19zPLNeSMEJHfH8N+QQAkUXrTp66hWFAlFn+D2wGQaBS2w7ur1sIA0=" type="audio/wav">
</audio>

<script>
class ChronoFocusPro {
  constructor() {
    this.currentView = 'my-day';
    this.currentFilter = 'all';
    this.settings = this.loadSettings();
    this.tasks = this.loadTasks();
    this.user = this.loadUser();
    this.draggedTask = null;
    this.avatarFile = null;
    
    this.initializeElements();
    this.setupEventListeners();
    this.applySettings();
    this.updateView();
    this.setupAutoResize();
    this.requestNotificationPermission();
    this.startReminderChecker();
    
    // Show login modal if user is not logged in
    if (!this.user.name) {
      this.showLogin();
    } else {
      this.updateUserProfile();
    }
    
    // Apply blur effect on initial load
    this.applyBlurEffect();
  }

  initializeElements() {
    this.elements = {
      // Layout
      sidebar: document.getElementById('sidebar'),
      menuBtn: document.getElementById('menuBtn'),
      
      // Navigation
      navItems: document.querySelectorAll('.nav-item[data-view]'),
      pageTitle: document.getElementById('pageTitle'),
      
      // User Profile
      userProfile: document.getElementById('userProfile'),
      userAvatar: document.getElementById('userAvatar'),
      userName: document.getElementById('userName'),
      userEmail: document.getElementById('userEmail'),
      
      // Task Input
      taskInput: document.getElementById('taskInput'),
      addTaskBtn: document.getElementById('addTaskBtn'),
      taskOptionsBtn: document.getElementById('taskOptionsBtn'),
      taskOptionsPanel: document.getElementById('taskOptionsPanel'),
      taskPriority: document.getElementById('taskPriority'),
      taskCategory: document.getElementById('taskCategory'),
      taskDueDate: document.getElementById('taskDueDate'),
      taskReminder: document.getElementById('taskReminder'),
      
      // Task List
      taskList: document.getElementById('taskList'),
      taskCount: document.getElementById('taskCount'),
      emptyState: document.getElementById('emptyState'),
      filterBtns: document.querySelectorAll('.filter-btn'),
      
      // AI Summary
      aiSummaryPanel: document.getElementById('aiSummaryPanel'),
      aiSummaryContent: document.getElementById('aiSummaryContent'),
      
      // Login
      loginModal: document.getElementById('loginModal'),
      closeLoginModal: document.getElementById('closeLoginModal'),
      saveLoginBtn: document.getElementById('saveLoginBtn'),
      loginName: document.getElementById('loginName'),
      loginEmail: document.getElementById('loginEmail'),
      avatarPreview: document.getElementById('avatarPreview'),
      avatarUpload: document.getElementById('avatarUpload'),
      avatarUploadBtn: document.getElementById('avatarUploadBtn'),
      
      // Settings
      settingsBtn: document.getElementById('settingsBtn'),
      settingsModal: document.getElementById('settingsModal'),
      closeSettingsModal: document.getElementById('closeSettingsModal'),
      saveSettingsBtn: document.getElementById('saveSettingsBtn'),
      resetSettingsBtn: document.getElementById('resetSettingsBtn'),
      
      // Setting toggles
      glassEffectToggle: document.getElementById('glassEffectToggle'),
      roundedCornersToggle: document.getElementById('roundedCornersToggle'),
      animationsToggle: document.getElementById('animationsToggle'),
      soundEffectsToggle: document.getElementById('soundEffectsToggle'),
      completionSoundToggle: document.getElementById('completionSoundToggle'),
      notificationSoundToggle: document.getElementById('notificationSoundToggle'),
      autoCompleteToggle: document.getElementById('autoCompleteToggle'),
      moveCompletedToggle: document.getElementById('moveCompletedToggle'),
      smartSuggestionsToggle: document.getElementById('smartSuggestionsToggle'),
      desktopNotificationsToggle: document.getElementById('desktopNotificationsToggle'),
      dailySummaryToggle: document.getElementById('dailySummaryToggle'),
      aiSummaryToggle: document.getElementById('aiSummaryToggle'),
      
      // Theme options
      themeOptions: document.querySelectorAll('.theme-option'),
      
      // Audio
      taskCompleteSound: document.getElementById('taskCompleteSound'),
      taskAddSound: document.getElementById('taskAddSound'),
      taskDeleteSound: document.getElementById('taskDeleteSound'),
      notificationSound: document.getElementById('notificationSound'),
      
      // Toast
      toastContainer: document.getElementById('toastContainer'),
      
      // Counters
      myDayCount: document.getElementById('myDayCount'),
      importantCount: document.getElementById('importantCount'),
      plannedCount: document.getElementById('plannedCount'),
      assignedCount: document.getElementById('assignedCount'),
      tasksCount: document.getElementById('tasksCount')
    };
  }

  setupEventListeners() {
    // Mobile menu
    this.elements.menuBtn.addEventListener('click', () => this.toggleSidebar());
    
    // Navigation
    this.elements.navItems.forEach(item => {
      item.addEventListener('click', () => this.switchView(item.dataset.view));
    });
    
    // User profile
    this.elements.userProfile.addEventListener('click', () => this.showLogin());
    
    // Task input
    this.elements.taskInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        this.addTask();
      }
    });
    
    this.elements.addTaskBtn.addEventListener('click', () => this.addTask());
    this.elements.taskOptionsBtn.addEventListener('click', () => this.toggleTaskOptions());
    
    // Task filters
    this.elements.filterBtns.forEach(btn => {
      btn.addEventListener('click', () => this.setFilter(btn.dataset.filter));
    });
    
    // Login
    this.elements.closeLoginModal.addEventListener('click', () => this.hideLogin());
    this.elements.saveLoginBtn.addEventListener('click', () => this.saveLogin());
    this.elements.avatarUploadBtn.addEventListener('click', () => this.elements.avatarUpload.click());
    this.elements.avatarUpload.addEventListener('change', (e) => this.handleAvatarUpload(e));
    
    // Settings
    this.elements.settingsBtn.addEventListener('click', () => this.showSettings());
    this.elements.closeSettingsModal.addEventListener('click', () => this.hideSettings());
    this.elements.saveSettingsBtn.addEventListener('click', () => this.saveSettings());
    this.elements.resetSettingsBtn.addEventListener('click', () => this.resetSettings());
    
    // Settings toggles
    Object.keys(this.settings).forEach(key => {
      const toggle = document.getElementById(key + 'Toggle');
      if (toggle) {
        toggle.addEventListener('change', () => {
          this.settings[key] = toggle.checked;
          this.applySettings();
        });
      }
    });
    
    // Theme selection
    this.elements.themeOptions.forEach(option => {
      option.addEventListener('click', () => this.selectTheme(option.dataset.theme));
    });
    
    // Close modals when clicking outside
    this.elements.loginModal.addEventListener('click', (e) => {
      if (e.target === this.elements.loginModal) {
        this.hideLogin();
      }
    });
    
    this.elements.settingsModal.addEventListener('click', (e) => {
      if (e.target === this.elements.settingsModal) {
        this.hideSettings();
      }
    });
    
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey || e.metaKey) {
        switch (e.key) {
          case 'n':
            e.preventDefault();
            this.elements.taskInput.focus();
            break;
          case ',':
            e.preventDefault();
            this.showSettings();
            break;
        }
      }
    });
  }

  // User Management
  loadUser() {
    const defaultUser = {
      name: '',
      email: '',
      avatar: null
    };
    
    const saved = localStorage.getItem('chronoFocusUser');
    return saved ? { ...defaultUser, ...JSON.parse(saved) } : defaultUser;
  }

  saveUser() {
    localStorage.setItem('chronoFocusUser', JSON.stringify(this.user));
  }

  showLogin() {
    this.elements.loginName.value = this.user.name || '';
    this.elements.loginEmail.value = this.user.email || '';
    this.updateAvatarPreview();
    this.elements.loginModal.classList.add('visible');
  }

  hideLogin() {
    this.elements.loginModal.classList.remove('visible');
  }

  saveLogin() {
    const name = this.elements.loginName.value.trim();
    if (!name) {
      this.showToast('Please enter your name', 'error');
      return;
    }
    
    this.user.name = name;
    this.user.email = this.elements.loginEmail.value.trim();
    
    if (this.avatarFile) {
      const reader = new FileReader();
      reader.onload = (e) => {
        this.user.avatar = e.target.result;
        this.saveUser();
        this.updateUserProfile();
        this.hideLogin();
        this.showToast(`Welcome, ${name}!`, 'success');
      };
      reader.readAsDataURL(this.avatarFile);
    } else {
      this.saveUser();
      this.updateUserProfile();
      this.hideLogin();
      this.showToast(`Welcome, ${name}!`, 'success');
    }
  }

  handleAvatarUpload(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    if (!file.type.startsWith('image/')) {
      this.showToast('Please select an image file', 'error');
      return;
    }
    
    this.avatarFile = file;
    this.updateAvatarPreview();
  }

  updateAvatarPreview() {
    if (this.avatarFile) {
      const reader = new FileReader();
      reader.onload = (e) => {
        this.elements.avatarPreview.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
      };
      reader.readAsDataURL(this.avatarFile);
    } else if (this.user.avatar) {
      this.elements.avatarPreview.innerHTML = `<img src="${this.user.avatar}" alt="Avatar">`;
    } else {
      this.elements.avatarPreview.innerHTML = '<i class="fas fa-user"></i>';
    }
  }

  updateUserProfile() {
    this.elements.userName.textContent = this.user.name || 'Guest';
    this.elements.userEmail.textContent = this.user.email || 'Click to login';
    
    if (this.user.avatar) {
      this.elements.userAvatar.innerHTML = `<img src="${this.user.avatar}" alt="${this.user.name}">`;
    } else {
      this.elements.userAvatar.innerHTML = '<i class="fas fa-user"></i>';
    }
  }

  // Task Management
  addTask() {
    const text = this.elements.taskInput.value.trim();
    if (!text) return;
    
    const task = {
      id: this.generateId(),
      text,
      completed: false,
      important: false,
      priority: this.elements.taskPriority.value,
      category: this.elements.taskCategory.value,
      dueDate: this.elements.taskDueDate.value || null,
      reminder: this.elements.taskReminder.value || null,
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString(),
      myDay: this.currentView === 'my-day'
    };
    
    this.tasks.push(task);
    this.saveTasks();
    this.updateView();
    this.updateCounts();
    this.generateAISummary();
    
    // Clear input
    this.elements.taskInput.value = '';
    this.elements.taskInput.style.height = 'auto';
    this.elements.taskDueDate.value = '';
    this.elements.taskReminder.value = '';
    this.hideTaskOptions();
    
    // Play sound
    this.playSound('taskAdd');
    
    // Show toast
    this.showToast('Task added successfully!', 'success');
    
    // Set reminder if specified
    if (task.reminder) {
      this.scheduleReminder(task);
    }
  }

  toggleTask(taskId) {
    const task = this.tasks.find(t => t.id === taskId);
    if (!task) return;
    
    task.completed = !task.completed;
    task.updatedAt = new Date().toISOString();
    
    if (task.completed) {
      task.completedAt = new Date().toISOString();
      this.playSound('taskComplete');
      this.showToast('Task completed! üéâ', 'success');
    } else {
      delete task.completedAt;
    }
    
    this.saveTasks();
    this.updateView();
    this.updateCounts();
    this.generateAISummary();
  }

  toggleImportant(taskId) {
    const task = this.tasks.find(t => t.id === taskId);
    if (!task) return;
    
    task.important = !task.important;
    task.updatedAt = new Date().toISOString();
    
    this.saveTasks();
    this.updateView();
    this.updateCounts();
    this.generateAISummary();
    
    this.playSound('notification');
    this.showToast(task.important ? 'Added to Important' : 'Removed from Important', 'info');
  }

  editTask(taskId) {
    const task = this.tasks.find(t => t.id === taskId);
    if (!task) return;
    
    const newText = prompt('Edit task:', task.text);
    if (newText && newText.trim() !== task.text) {
      task.text = newText.trim();
      task.updatedAt = new Date().toISOString();
      this.saveTasks();
      this.updateView();
      this.generateAISummary();
      this.showToast('Task updated!', 'success');
    }
  }

  deleteTask(taskId) {
    if (!confirm('Are you sure you want to delete this task?')) return;
    
    this.tasks = this.tasks.filter(t => t.id !== taskId);
    this.saveTasks();
    this.updateView();
    this.updateCounts();
    this.generateAISummary();
    
    this.playSound('taskDelete');
    this.showToast('Task deleted', 'success');
  }

  addToMyDay(taskId) {
    const task = this.tasks.find(t => t.id === taskId);
    if (!task) return;
    
    task.myDay = true;
    task.updatedAt = new Date().toISOString();
    
    this.saveTasks();
    this.updateView();
    this.updateCounts();
    this.generateAISummary();
    
    this.showToast('Added to My Day', 'info');
  }

  // View Management
  switchView(view) {
    this.currentView = view;
    
    // Update navigation
    this.elements.navItems.forEach(item => {
      item.classList.toggle('active', item.dataset.view === view);
    });
    
    // Update page title
    const titles = {
      'my-day': { icon: 'fas fa-sun', text: 'My Day' },
      'important': { icon: 'fas fa-star', text: 'Important' },
      'planned': { icon: 'fas fa-calendar-alt', text: 'Planned' },
      'assigned': { icon: 'fas fa-user', text: 'Assigned to me' },
      'tasks': { icon: 'fas fa-home', text: 'Tasks' }
    };
    
    const title = titles[view];
    this.elements.pageTitle.innerHTML = `<i class="${title.icon}"></i> ${title.text}`;
    
    this.updateView();
    this.closeSidebar();
  }

  updateView() {
    const tasks = this.getFilteredTasks();
    this.renderTasks(tasks);
    this.updateTaskCount(tasks.length);
    
    // Show/hide empty state
    this.elements.emptyState.style.display = tasks.length === 0 ? 'block' : 'none';
  }

  getFilteredTasks() {
    let filtered = [...this.tasks];
    
    // Filter by view
    switch (this.currentView) {
      case 'my-day':
        filtered = filtered.filter(task => task.myDay && !task.completed);
        break;
      case 'important':
        filtered = filtered.filter(task => task.important);
        break;
      case 'planned':
        filtered = filtered.filter(task => task.dueDate);
        break;
      case 'assigned':
        // For now, show all tasks as "assigned to me"
        break;
      case 'tasks':
        // Show all tasks
        break;
    }
    
    // Filter by completion status
    if (this.currentFilter === 'active') {
      filtered = filtered.filter(task => !task.completed);
    } else if (this.currentFilter === 'completed') {
      filtered = filtered.filter(task => task.completed);
    }
    
    // Sort tasks
    filtered.sort((a, b) => {
      // Completed tasks go to bottom if setting is enabled
      if (this.settings.moveCompleted && a.completed !== b.completed) {
        return a.completed - b.completed;
      }
      
      // Important tasks go to top
      if (a.important !== b.important) {
        return b.important - a.important;
      }
      
      // Sort by priority
      const priorityOrder = { high: 0, medium: 1, low: 2 };
      if (a.priority !== b.priority) {
        return priorityOrder[a.priority] - priorityOrder[b.priority];
      }
      
      // Sort by due date
      if (a.dueDate && b.dueDate) {
        return new Date(a.dueDate) - new Date(b.dueDate);
      }
      if (a.dueDate && !b.dueDate) return -1;
      if (!a.dueDate && b.dueDate) return 1;
      
      // Sort by creation date (newest first)
      return new Date(b.createdAt) - new Date(a.createdAt);
    });
    
    return filtered;
  }

  renderTasks(tasks) {
    this.elements.taskList.innerHTML = '';
    
    tasks.forEach(task => {
      const taskElement = this.createTaskElement(task);
      this.elements.taskList.appendChild(taskElement);
    });
  }

  createTaskElement(task) {
    const taskItem = document.createElement('div');
    taskItem.className = 'task-item';
    taskItem.dataset.taskId = task.id;
    
    if (task.completed) {
      taskItem.classList.add('completed');
    }
    
    // Format due date
    let dueDateText = '';
    if (task.dueDate) {
      const dueDate = new Date(task.dueDate);
      const today = new Date();
      const tomorrow = new Date(today);
      tomorrow.setDate(today.getDate() + 1);
      
      if (dueDate.toDateString() === today.toDateString()) {
        dueDateText = 'Today';
      } else if (dueDate.toDateString() === tomorrow.toDateString()) {
        dueDateText = 'Tomorrow';
      } else {
        dueDateText = dueDate.toLocaleDateString();
      }
    }
    
    // Category icons
    const categoryIcons = {
      general: 'üìã',
      work: 'üíº',
      personal: 'üë§',
      shopping: 'üõí',
      health: '‚ù§Ô∏è',
      learning: 'üìö'
    };
    
    taskItem.innerHTML = `
      <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-action="toggle">
        <i class="fas fa-check"></i>
      </div>
      
      <div class="task-content-wrapper">
        <div class="task-content">
          <span class="task-icon">${categoryIcons[task.category] || 'üìã'}</span>
          <span class="task-text">${this.escapeHtml(task.text)}</span>
        </div>
        
        <div class="task-meta">
          ${task.priority !== 'medium' ? `
            <div class="task-meta-item">
              <span class="task-priority ${task.priority}">${task.priority}</span>
            </div>
          ` : ''}
          
          ${task.dueDate ? `
            <div class="task-meta-item">
              <i class="fas fa-calendar"></i>
              <span>${dueDateText}</span>
            </div>
          ` : ''}
          
          ${task.reminder ? `
            <div class="task-meta-item">
              <i class="fas fa-bell"></i>
              <span>Reminder</span>
            </div>
          ` : ''}
          
          <div class="task-meta-item">
            <span>${task.category.charAt(0).toUpperCase() + task.category.slice(1)}</span>
          </div>
        </div>
      </div>
      
      <div class="task-actions">
        ${!task.myDay ? `
          <button class="task-action-btn" data-action="add-to-my-day" title="Add to My Day">
            <i class="fas fa-sun"></i>
          </button>
        ` : ''}
        
        <button class="task-action-btn star ${task.important ? 'active' : ''}" 
                data-action="toggle-important" 
                title="${task.important ? 'Remove from Important' : 'Mark as Important'}">
          <i class="fas fa-star"></i>
        </button>
        
        <button class="task-action-btn edit" data-action="edit" title="Edit">
          <i class="fas fa-edit"></i>
        </button>
        
        <button class="task-action-btn delete" data-action="delete" title="Delete">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    `;
    
    // Add event listeners
    taskItem.addEventListener('click', (e) => {
      const action = e.target.closest('[data-action]')?.dataset.action;
      if (!action) return;
      
      e.stopPropagation();
      
      switch (action) {
        case 'toggle':
          this.toggleTask(task.id);
          break;
        case 'toggle-important':
          this.toggleImportant(task.id);
          break;
        case 'edit':
          this.editTask(task.id);
          break;
        case 'delete':
          this.deleteTask(task.id);
          break;
        case 'add-to-my-day':
          this.addToMyDay(task.id);
          break;
      }
    });
    
    // Drag and drop
    taskItem.draggable = true;
    taskItem.addEventListener('dragstart', (e) => {
      this.draggedTask = task;
      taskItem.classList.add('dragging');
    });
    
    taskItem.addEventListener('dragend', () => {
      taskItem.classList.remove('dragging');
      this.draggedTask = null;
    });
    
    return taskItem;
  }

  setFilter(filter) {
    this.currentFilter = filter;
    
    this.elements.filterBtns.forEach(btn => {
      btn.classList.toggle('active', btn.dataset.filter === filter);
    });
    
    this.updateView();
  }

  updateTaskCount(count) {
    const text = count === 1 ? '1 task' : `${count} tasks`;
    this.elements.taskCount.textContent = text;
  }

  updateCounts() {
    const counts = {
      myDay: this.tasks.filter(t => t.myDay && !t.completed).length,
      important: this.tasks.filter(t => t.important && !t.completed).length,
      planned: this.tasks.filter(t => t.dueDate && !t.completed).length,
      assigned: this.tasks.filter(t => !t.completed).length,
      tasks: this.tasks.filter(t => !t.completed).length
    };
    
    this.elements.myDayCount.textContent = counts.myDay;
    this.elements.importantCount.textContent = counts.important;
    this.elements.plannedCount.textContent = counts.planned;
    this.elements.assignedCount.textContent = counts.assigned;
    this.elements.tasksCount.textContent = counts.tasks;
  }

  // AI Summary
  generateAISummary() {
    if (!this.settings.aiSummary) {
      this.elements.aiSummaryPanel.style.display = 'none';
      return;
    }
    
    const currentMonth = new Date().getMonth();
    const currentYear = new Date().getFullYear();
    
    // Get tasks from current month
    const monthTasks = this.tasks.filter(task => {
      const taskDate = new Date(task.createdAt);
      return taskDate.getMonth() === currentMonth && taskDate.getFullYear() === currentYear;
    });
    
    if (monthTasks.length === 0) {
      this.elements.aiSummaryPanel.style.display = 'none';
      return;
    }
    
    const completedTasks = monthTasks.filter(task => task.completed);
    const importantTasks = monthTasks.filter(task => task.important);
    const highPriorityTasks = monthTasks.filter(task => task.priority === 'high');
    
    // Generate summary text
    let summary = `This month, you've completed <strong>${completedTasks.length}</strong> out of <strong>${monthTasks.length}</strong> tasks. `;
    
    if (completedTasks.length > 0) {
      const completionRate = Math.round((completedTasks.length / monthTasks.length) * 100);
      summary += `That's a <strong>${completionRate}%</strong> completion rate! `;
      
      if (completionRate >= 80) {
        summary += `üéâ Excellent progress! Keep up the great work.`;
      } else if (completionRate >= 60) {
        summary += `üëç Good job! You're making steady progress.`;
      } else {
        summary += `üí™ Keep going! Every task completed is a step forward.`;
      }
    }
    
    if (importantTasks.length > 0) {
      summary += ` You have <strong>${importantTasks.length}</strong> important tasks this month.`;
    }
    
    if (highPriorityTasks.length > 0) {
      const highPriorityCompleted = highPriorityTasks.filter(task => task.completed).length;
      summary += ` <strong>${highPriorityCompleted}</strong> out of <strong>${highPriorityTasks.length}</strong> high priority tasks are completed.`;
    }
    
    // Show the panel
    this.elements.aiSummaryContent.innerHTML = summary;
    this.elements.aiSummaryPanel.style.display = 'block';
  }

  // UI Helpers
  toggleSidebar() {
    this.elements.sidebar.classList.toggle('visible');
  }

  closeSidebar() {
    if (window.innerWidth <= 768) {
      this.elements.sidebar.classList.remove('visible');
    }
  }

  toggleTaskOptions() {
    this.elements.taskOptionsPanel.classList.toggle('visible');
  }

  hideTaskOptions() {
    this.elements.taskOptionsPanel.classList.remove('visible');
  }

  setupAutoResize() {
    this.elements.taskInput.addEventListener('input', () => {
      this.elements.taskInput.style.height = 'auto';
      this.elements.taskInput.style.height = Math.min(this.elements.taskInput.scrollHeight, 120) + 'px';
    });
  }

  // Settings Management
  loadSettings() {
    const defaultSettings = {
      glassEffect: true,
      roundedCorners: true,
      animations: true,
      soundEffects: true,
      completionSound: true,
      notificationSound: true,
      compactView: false,
      autoComplete: false,
      moveCompleted: true,
      smartSuggestions: true,
      desktopNotifications: false,
      dailySummary: false,
      aiSummary: true,
      theme: 'dark'
    };
    
    const saved = localStorage.getItem('chronoFocusSettings');
    return saved ? { ...defaultSettings, ...JSON.parse(saved) } : defaultSettings;
  }

  saveSettings() {
    localStorage.setItem('chronoFocusSettings', JSON.stringify(this.settings));
    this.hideSettings();
    this.showToast('Settings saved!', 'success');
  }

  resetSettings() {
    if (!confirm('Reset all settings to default?')) return;
    
    this.settings = {
      glassEffect: true,
      roundedCorners: true,
      animations: true,
      soundEffects: true,
      completionSound: true,
      notificationSound: true,
      compactView: false,
      autoComplete: false,
      moveCompleted: true,
      smartSuggestions: true,
      desktopNotifications: false,
      dailySummary: false,
      aiSummary: true,
      theme: 'dark'
    };
    
    this.applySettings();
    this.loadSettingsUI();
    this.showToast('Settings reset to default', 'info');
  }

  applySettings() {
    // Apply theme
    document.body.className = `theme-${this.settings.theme}`;
    
    // Apply glass effect
    if (this.settings.glassEffect) {
      document.body.classList.add('glass-effect');
    } else {
      document.body.classList.remove('glass-effect');
    }
    
    // Apply rounded corners
    if (this.settings.roundedCorners) {
      document.body.classList.add('rounded-corners');
    } else {
      document.body.classList.remove('rounded-corners');
    }
    
    // Apply animations
    if (this.settings.animations) {
      document.body.classList.add('animations-enabled');
    } else {
      document.body.classList.remove('animations-enabled');
    }
    
    // Request notification permission if enabled
    if (this.settings.desktopNotifications && 'Notification' in window) {
      Notification.requestPermission();
    }
    
    // Update AI summary
    this.generateAISummary();
  }

  loadSettingsUI() {
    Object.keys(this.settings).forEach(key => {
      const toggle = document.getElementById(key + 'Toggle');
      if (toggle) {
        toggle.checked = this.settings[key];
      }
    });
    
    // Set active theme
    this.elements.themeOptions.forEach(option => {
      option.classList.toggle('active', option.dataset.theme === this.settings.theme);
    });
  }

  selectTheme(theme) {
    this.settings.theme = theme;
    this.applySettings();
    
    // Update UI
    this.elements.themeOptions.forEach(option => {
      option.classList.toggle('active', option.dataset.theme === theme);
    });
  }

  showSettings() {
    this.loadSettingsUI();
    this.elements.settingsModal.classList.add('visible');
  }

  hideSettings() {
    this.elements.settingsModal.classList.remove('visible');
  }

  // Blur Effect
  applyBlurEffect() {
    const mainContent = document.querySelector('.main-content');
    mainContent.classList.add('blur-effect');
    
    setTimeout(() => {
      mainContent.classList.remove('blur-effect');
      mainContent.classList.add('blur-effect-removing');
      
      setTimeout(() => {
        mainContent.classList.remove('blur-effect-removing');
      }, 300);
    }, 500);
  }

  // Sound Management
  playSound(type) {
    if (!this.settings.soundEffects) return;
    
    let audio = null;
    
    switch (type) {
      case 'taskComplete':
        if (this.settings.completionSound) {
          audio = this.elements.taskCompleteSound;
        }
        break;
      case 'taskAdd':
        audio = this.elements.taskAddSound;
        break;
      case 'taskDelete':
        audio = this.elements.taskDeleteSound;
        break;
      case 'notification':
        if (this.settings.notificationSound) {
          audio = this.elements.notificationSound;
        }
        break;
    }
    
    if (audio) {
      audio.currentTime = 0;
      audio.play().catch(() => {
        // Ignore audio play errors (user hasn't interacted with page yet)
      });
    }
  }

  // Notifications & Reminders
  requestNotificationPermission() {
    if ('Notification' in window && this.settings.desktopNotifications) {
      Notification.requestPermission();
    }
  }

  showNotification(title, body, icon = null) {
    if (!this.settings.desktopNotifications || !('Notification' in window) || Notification.permission !== 'granted') {
      return;
    }
    
    new Notification(title, {
      body,
      icon: icon || '/favicon.ico',
      tag: 'chrono-focus-reminder'
    });
    
    this.playSound('notification');
  }

  scheduleReminder(task) {
    const reminderTime = new Date(task.reminder);
    const now = new Date();
    
    if (reminderTime <= now) return;
    
    const timeUntilReminder = reminderTime - now;
    
    setTimeout(() => {
      this.showNotification(
        'Task Reminder',
        `Don't forget: ${task.text}`,
      );
      
      this.showToast(`Reminder: ${task.text}`, 'info');
    }, timeUntilReminder);
  }

  startReminderChecker() {
    // Check for due reminders every minute
    setInterval(() => {
      const now = new Date();
      const reminderTasks = this.tasks.filter(task => 
        task.reminder && 
        !task.completed && 
        new Date(task.reminder) <= now &&
        !task.reminderShown
      );
      
      reminderTasks.forEach(task => {
        this.showNotification(
          'Task Reminder',
          `Don't forget: ${task.text}`
        );
        
        this.showToast(`Reminder: ${task.text}`, 'info');
        
        // Mark reminder as shown
        task.reminderShown = true;
        this.saveTasks();
      });
    }, 60000); // Check every minute
  }

  // Toast Notifications
  showToast(message, type = 'info', duration = 3000) {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    
    const icons = {
      success: 'fa-check-circle',
      error: 'fa-exclamation-circle',
      info: 'fa-info-circle'
    };
    
    const titles = {
      success: 'Success',
      error: 'Error',
      info: 'Info'
    };
    
    toast.innerHTML = `
      <div class="toast-icon">
        <i class="fas ${icons[type]}"></i>
      </div>
      <div class="toast-content">
        <div class="toast-title">${titles[type]}</div>
        <div class="toast-message">${this.escapeHtml(message)}</div>
      </div>
      <button class="toast-close">
        <i class="fas fa-times"></i>
      </button>
    `;
    
    const closeBtn = toast.querySelector('.toast-close');
    closeBtn.addEventListener('click', () => this.removeToast(toast));
    
    this.elements.toastContainer.appendChild(toast);
    
    // Show toast
    setTimeout(() => toast.classList.add('show'), 100);
    
    // Auto remove
    setTimeout(() => this.removeToast(toast), duration);
    
    return toast;
  }

  removeToast(toast) {
    toast.classList.remove('show');
    setTimeout(() => {
      if (toast.parentNode) {
        toast.parentNode.removeChild(toast);
      }
    }, 300);
  }

  // Data Management
  loadTasks() {
    const saved = localStorage.getItem('chronoFocusTasks');
    return saved ? JSON.parse(saved) : [];
  }

  saveTasks() {
    localStorage.setItem('chronoFocusTasks', JSON.stringify(this.tasks));
  }

  generateId() {
    return 'task_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
  }

  escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
}

// Initialize app when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  window.chronoFocusPro = new ChronoFocusPro();
});

// Handle window resize
window.addEventListener('resize', () => {
  if (window.innerWidth > 768 && window.chronoFocusPro) {
    window.chronoFocusPro.elements.sidebar.classList.remove('visible');
  }
});
</script>

</body>
</html>

