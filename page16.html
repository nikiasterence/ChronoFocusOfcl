<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="Chronofocus.png" type="image/x-icon">
<title>Chrono Focus Pro - Advanced Task & Calendar Manager</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  /* Cozy Theme (Default) */
  --primary: #8B5FBF;
  --primary-light: #E8DEF8;
  --primary-dark: #6750A4;
  --secondary: #7B9EA8;
  --accent: #FF9E6D;
  --background: #FFFBFE;
  --surface: #FFFFFF;
  --surface-elevated: #FFFFFF;
  --text-primary: #1C1B1F;
  --text-secondary: #49454F;
  --text-disabled: #79747E;
  --border-color: #E7E0EC;
  --success: #0D7377;
  --warning: #FFB740;
  --danger: #B3261E;
  --hover-overlay: rgba(139, 95, 191, 0.08);
  --active-overlay: rgba(139, 95, 191, 0.12);
  
  /* Task Priority Colors */
  --priority-high: #FF5252;
  --priority-medium: #FFB740;
  --priority-low: #0D7377;
  
  /* Calendar Colors */
  --today-bg: var(--primary-light);
  --today-text: var(--primary-dark);
  --weekend-bg: #F5F5F5;
  --weekend-text: var(--text-secondary);
  
  /* Rounded corners */
  --border-radius-sm: 8px;
  --border-radius: 16px;
  --border-radius-lg: 24px;
  --border-radius-xl: 28px;
  
  /* Shadows */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.12);
  --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.15);
  --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.2);
  
  /* Transition */
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Zen Theme */
body.theme-zen {
  --primary: #4A7C59;
  --primary-light: #E8F5E9;
  --primary-dark: #2E5D3A;
  --secondary: #8DAB7F;
  --accent: #C8E6C9;
  --background: #F9F7F4;
  --surface: #FFFFFF;
  --surface-elevated: #FFFFFF;
  --text-primary: #2E3229;
  --text-secondary: #5A6650;
  --text-disabled: #8A9785;
  --border-color: #E0E0E0;
  --hover-overlay: rgba(74, 124, 89, 0.08);
  --active-overlay: rgba(74, 124, 89, 0.12);
  --today-bg: #E8F5E9;
  --today-text: #2E5D3A;
  --weekend-bg: #F5F5F5;
}

/* Aurora Theme */
body.theme-aurora {
  --primary: #5D8AA8;
  --primary-light: #E3F2FD;
  --primary-dark: #1565C0;
  --secondary: #80CBC4;
  --accent: #B2EBF2;
  --background: linear-gradient(135deg, #E3F2FD, #B3E5FC);
  --surface: rgba(255, 255, 255, 0.9);
  --surface-elevated: rgba(255, 255, 255, 0.95);
  --text-primary: #0D47A1;
  --text-secondary: #546E7A;
  --text-disabled: #90A4AE;
  --border-color: rgba(179, 229, 252, 0.5);
  --hover-overlay: rgba(93, 138, 168, 0.08);
  --active-overlay: rgba(93, 138, 168, 0.12);
  --today-bg: #E1F5FE;
  --today-text: #0277BD;
  --weekend-bg: rgba(179, 229, 252, 0.3);
}

/* Global Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--background);
  color: var(--text-primary);
  line-height: 1.5;
  transition: var(--transition);
  overflow-x: hidden;
  background-size: cover;
  background-attachment: fixed;
  background-repeat: no-repeat;
  scroll-behavior: smooth;
}

/* App Layout */
.app-container {
  display: flex;
  min-height: 100vh;
  overflow: auto;
}

/* Header */
.main-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  padding: 16px 24px;
  background: var(--surface);
  border-bottom: 1px solid var(--border-color);
  display: flex;
  align-items: center;
  justify-content: space-between;
  z-index: 100;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.header-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary);
  display: flex;
  align-items: center;
  gap: 12px;
}

.header-controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

.header-btn {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  border-radius: var(--border-radius);
  color: var(--text-secondary);
  cursor: pointer;
  transition: var(--transition);
  font-size: 1.1rem;
}

.header-btn:hover {
  background: var(--hover-overlay);
  color: var(--text-primary);
}

/* Main Content */
.main-content {
  margin-top: 80px;
  padding: 24px;
  width: 100%;
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}

.content-grid {
  display: grid;
  grid-template-columns: 1fr 350px;
  gap: 24px;
}

/* Tasks Section */
.tasks-section {
  background: var(--surface);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.tasks-header {
  padding: 24px;
  border-bottom: 1px solid var(--border-color);
  background: var(--surface-elevated);
}

.task-input-container {
  display: flex;
  gap: 12px;
  align-items: flex-start;
  margin-bottom: 20px;
}

.task-input-wrapper {
  flex: 1;
  position: relative;
}

.task-input {
  width: 100%;
  padding: 16px 20px;
  border: 2px solid var(--border-color);
  border-radius: var(--border-radius-lg);
  font-size: 1rem;
  background: var(--surface-elevated);
  color: var(--text-primary);
  transition: var(--transition);
  resize: none;
  font-family: inherit;
  line-height: 1.5;
  min-height: 56px;
  max-height: 120px;
}

.task-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(139, 95, 191, 0.1);
}

.task-input::placeholder {
  color: var(--text-secondary);
}

.add-task-btn {
  padding: 16px 24px;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: var(--border-radius-lg);
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  box-shadow: var(--shadow-sm);
}

.add-task-btn:hover {
  opacity: 0.9;
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}

.add-task-btn:active {
  transform: translateY(0);
}

.task-options {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.task-option-select {
  padding: 8px 16px;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  background: var(--surface);
  color: var(--text-primary);
  font-size: 0.875rem;
  cursor: pointer;
  transition: var(--transition);
}

.task-option-select:focus {
  outline: none;
  border-color: var(--primary);
}

/* Task List */
.tasks-content {
  padding: 0 24px 24px;
}

.task-list-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  padding-top: 20px;
  position: sticky;
  top: 0;
  background: var(--surface);
  z-index: 10;
  padding-bottom: 10px;
}

.task-count {
  color: var(--text-secondary);
  font-size: 0.875rem;
  font-weight: 500;
}

.task-filters {
  display: flex;
  gap: 8px;
}

.filter-btn {
  padding: 6px 12px;
  background: none;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  color: var(--text-secondary);
  font-size: 0.875rem;
  cursor: pointer;
  transition: var(--transition);
}

.filter-btn:hover {
  background: var(--hover-overlay);
}

.filter-btn.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.tasks-list {
  list-style: none;
}

.task-item {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 16px;
  background: var(--surface);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-lg);
  margin-bottom: 12px;
  transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  cursor: pointer;
  opacity: 0;
  animation: slideInUp 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
}

.task-item:nth-child(1) { animation-delay: 0.05s; }
.task-item:nth-child(2) { animation-delay: 0.1s; }
.task-item:nth-child(3) { animation-delay: 0.15s; }
.task-item:nth-child(4) { animation-delay: 0.2s; }
.task-item:nth-child(5) { animation-delay: 0.25s; }

.task-item.fade-out {
  animation: fadeOut 0.4s forwards;
}

.task-item:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
  border-color: rgba(139, 95, 191, 0.3);
}

.task-item.completed {
  opacity: 0.7;
  background: rgba(128,128,128,0.05);
}

.task-item.completed .task-text-content {
  text-decoration: line-through;
  color: var(--text-secondary);
}

.task-item.dragging {
  transform: rotate(5deg) scale(1.05);
  box-shadow: var(--shadow-xl);
  z-index: 1000;
}

.task-checkbox {
  width: 20px;
  height: 20px;
  border: 2px solid var(--border-color);
  border-radius: 50%;
  cursor: pointer;
  transition: var(--transition);
  flex-shrink: 0;
  position: relative;
  margin-top: 2px;
}

.task-checkbox:hover {
  border-color: var(--primary);
}

.task-checkbox.checked {
  background: var(--primary);
  border-color: var(--primary);
}

.task-checkbox.checked::after {
  content: '✓';
  color: white;
  font-size: 12px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-weight: bold;
}

.task-content {
  flex: 1;
  min-width: 0;
}

.task-text-content {
  display: flex;
  align-items: center;
  gap: 10px;
}

.task-icon {
  font-size: 1.1rem;
  color: var(--text-secondary);
  transition: color 0.3s;
  cursor: pointer;
}

.task-item:hover .task-icon {
  color: var(--primary);
}

.task-item.completed .task-icon {
  color: var(--text-disabled);
}

.task-text {
  font-size: 1rem;
  color: var(--text-primary);
  line-height: 1.5;
  word-wrap: break-word;
  margin-bottom: 4px;
}

.task-notes {
  font-size: 0.875rem;
  color: var(--text-secondary);
  margin-top: 8px;
  padding: 8px 12px;
  background: rgba(139, 95, 191, 0.05);
  border-radius: var(--border-radius-sm);
  border-left: 3px solid var(--primary);
}

.task-meta {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 0.75rem;
  color: var(--text-secondary);
  flex-wrap: wrap;
  margin-top: 8px;
}

.task-priority {
  padding: 2px 8px;
  border-radius: 12px;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.task-priority.high {
  background: rgba(255, 82, 82, 0.1);
  color: var(--priority-high);
}

.task-priority.medium {
  background: rgba(255, 183, 64, 0.1);
  color: var(--priority-medium);
}

.task-priority.low {
  background: rgba(13, 115, 119, 0.1);
  color: var(--priority-low);
}

.task-date {
  display: flex;
  align-items: center;
  gap: 4px;
}

.task-actions {
  display: flex;
  gap: 8px;
  opacity: 0;
  transition: var(--transition);
}

.task-item:hover .task-actions {
  opacity: 1;
}

.task-action-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  border-radius: var(--border-radius);
  color: var(--text-secondary);
  cursor: pointer;
  transition: var(--transition);
  font-size: 0.875rem;
}

.task-action-btn:hover {
  background: var(--hover-overlay);
  color: var(--text-primary);
}

.task-action-btn.edit:hover {
  color: var(--primary);
}

.task-action-btn.delete:hover {
  color: var(--danger);
}

.task-action-btn.notes:hover {
  color: var(--success);
}

/* Calendar Section */
.calendar-section {
  background: var(--surface);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
  height: fit-content;
}

.calendar-header {
  padding: 20px;
  border-bottom: 1px solid var(--border-color);
  text-align: center;
  background: var(--surface-elevated);
}

.calendar-top-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.calendar-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-grow: 1;
}

.calendar-nav button {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: 8px;
  border-radius: var(--border-radius);
  transition: var(--transition);
  font-size: 1.1rem;
}

.calendar-nav button:hover {
  background: var(--hover-overlay);
  color: var(--text-primary);
}

.calendar-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-primary);
}

.calendar-grid {
  padding: 20px;
}

.calendar-weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  margin-bottom: 8px;
}

.calendar-weekday {
  padding: 8px 4px;
  text-align: center;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.calendar-days {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
}

.calendar-day {
  aspect-ratio: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-radius: var(--border-radius);
  transition: var(--transition);
  position: relative;
  font-size: 0.875rem;
  font-weight: 500;
  background: transparent;
  border: 1px solid transparent;
}

.calendar-day:hover {
  background: var(--hover-overlay);
}

.calendar-day.today {
  background: var(--today-bg);
  color: var(--today-text);
  font-weight: 600;
}

.calendar-day.selected {
  background: var(--primary);
  color: white;
}

.calendar-day.other-month {
  color: var(--text-disabled);
}

.calendar-day.has-tasks::after {
  content: '';
  width: 6px;
  height: 6px;
  background: var(--primary);
  border-radius: 50%;
  position: absolute;
  bottom: 2px;
  left: 50%;
  transform: translateX(-50%);
}

/* Dock */
.dock {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--surface);
  border-radius: var(--border-radius-lg);
  padding: 12px 20px;
  box-shadow: var(--shadow-lg);
  display: flex;
  gap: 16px;
  z-index: 90;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--border-color);
  transition: var(--transition);
}

.dock-item {
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--surface-elevated);
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: var(--transition);
  color: var(--text-secondary);
  font-size: 1.2rem;
  position: relative;
}

.dock-item:hover {
  transform: translateY(-5px);
  color: var(--primary);
  background: var(--hover-overlay);
}

.dock-item.active {
  color: var(--primary);
  background: var(--primary-light);
}

.dock-item .badge {
  position: absolute;
  top: -5px;
  right: -5px;
  background: var(--danger);
  color: white;
  border-radius: 50%;
  width: 18px;
  height: 18px;
  font-size: 0.7rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Settings Panel */
.settings-panel {
  position: fixed;
  top: 0;
  right: -400px;
  width: 400px;
  height: 100vh;
  background: var(--surface);
  border-left: 1px solid var(--border-color);
  box-shadow: var(--shadow-xl);
  z-index: 200;
  transition: var(--transition);
  overflow-y: auto;
  padding: 24px;
}

.settings-panel.open {
  right: 0;
}

.settings-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border-color);
}

.settings-title {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-primary);
}

.close-settings {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 1.2rem;
  padding: 8px;
  border-radius: var(--border-radius);
  transition: var(--transition);
}

.close-settings:hover {
  background: var(--hover-overlay);
  color: var(--text-primary);
}

.settings-section {
  margin-bottom: 32px;
}

.settings-section-title {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text-primary);
}

.theme-options {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.theme-option {
  padding: 16px;
  border: 2px solid var(--border-color);
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: var(--transition);
  text-align: center;
}

.theme-option:hover {
  border-color: var(--primary);
}

.theme-option.active {
  border-color: var(--primary);
  background: var(--primary-light);
}

.theme-preview {
  width: 100%;
  height: 60px;
  border-radius: var(--border-radius-sm);
  margin-bottom: 8px;
}

.theme-name {
  font-size: 0.875rem;
  font-weight: 500;
}

/* AI Panel */
.ai-panel {
  position: fixed;
  bottom: 100px;
  right: 24px;
  width: 350px;
  max-width: calc(100vw - 48px);
  background: var(--surface);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-xl);
  padding: 20px;
  z-index: 99;
  transform: translateY(20px);
  opacity: 0;
  visibility: hidden;
  transition: var(--transition);
}

.ai-panel.visible {
  transform: translateY(0);
  opacity: 1;
  visibility: visible;
}

.ai-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border-color);
}

.ai-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-primary);
}

.ai-status {
  font-size: 0.75rem;
  padding: 2px 8px;
  background: var(--success);
  color: white;
  border-radius: 12px;
}

.ai-messages {
  max-height: 300px;
  overflow-y: auto;
  margin-bottom: 16px;
}

.ai-message {
  padding: 12px;
  margin-bottom: 12px;
  border-radius: var(--border-radius);
  font-size: 0.9rem;
  line-height: 1.4;
}

.ai-message.user {
  background: var(--primary-light);
  color: var(--primary);
  margin-left: 20px;
}

.ai-message.assistant {
  background: var(--surface-elevated);
  color: var(--text-primary);
  margin-right: 20px;
}

.ai-input-container {
  display: flex;
  gap: 8px;
}

.ai-input {
  flex: 1;
  padding: 12px;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  background: var(--surface);
  color: var(--text-primary);
  font-size: 0.9rem;
  resize: none;
  font-family: inherit;
}

.ai-input:focus {
  outline: none;
  border-color: var(--primary);
}

.ai-send {
  padding: 12px 16px;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: var(--transition);
}

.ai-send:hover {
  opacity: 0.9;
}

.ai-commands {
  margin-top: 12px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.ai-command {
  padding: 6px 12px;
  background: var(--surface-elevated);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  font-size: 0.8rem;
  cursor: pointer;
  transition: var(--transition);
}

.ai-command:hover {
  background: var(--hover-overlay);
}

/* Toast Notifications */
.toast-container {
  position: fixed;
  bottom: 100px;
  right: 24px;
  z-index: 2000;
}

.toast {
  background: var(--surface-elevated);
  color: var(--text-primary);
  padding: 16px 20px;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-xl);
  border: 1px solid var(--border-color);
  margin-bottom: 12px;
  transform: translateX(120%);
  opacity: 0;
  transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
  max-width: 320px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.toast::before {
  font-family: "Font Awesome 6 Free";
  font-weight: 900;
  font-size: 1.2rem;
}

.toast.show {
  transform: translateX(0);
  opacity: 1;
}

.toast.success {
  border-left: 4px solid var(--success);
}

.toast.success::before {
  content: "\f058";
  color: var(--success);
}

.toast.error {
  border-left: 4px solid var(--danger);
}

.toast.error::before {
  content: "\f071";
  color: var(--danger);
}

/* Animations */
@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeOut {
  from {
    opacity: 0.7;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.9);
    height: 0;
    padding: 0;
    margin: 0;
    border: 0;
  }
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: var(--text-secondary);
  display: none;
}

.empty-state i {
  font-size: 3rem;
  margin-bottom: 16px;
  color: var(--text-disabled);
}

.empty-state h3 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text-primary);
}

.empty-state p {
  font-size: 0.875rem;
  line-height: 1.5;
}

/* Responsive Design */
@media (max-width: 992px) {
  .content-grid {
    grid-template-columns: 1fr;
  }
  
  .calendar-section {
    order: 2;
  }
  
  .tasks-section {
    order: 1;
  }
  
  .dock {
    padding: 10px 16px;
    gap: 12px;
  }
  
  .dock-item {
    width: 44px;
    height: 44px;
    font-size: 1.1rem;
  }
  
  .settings-panel {
    width: 100%;
    right: -100%;
  }
}

@media (max-width: 768px) {
  .main-content {
    padding: 16px;
    margin-top: 70px;
  }
  
  .tasks-header, .tasks-content {
    padding-left: 16px;
    padding-right: 16px;
  }
  
  .task-input-container {
    flex-direction: column;
    align-items: stretch;
  }
  
  .task-options {
    flex-direction: column;
    align-items: stretch;
  }
  
  .task-option-select {
    width: 100%;
  }
  
  .theme-options {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .ai-panel {
    width: calc(100vw - 32px);
    right: 16px;
    bottom: 90px;
  }
  
  .dock {
    bottom: 10px;
    padding: 8px 12px;
    gap: 8px;
  }
  
  .dock-item {
    width: 40px;
    height: 40px;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .main-header {
    padding: 12px 16px;
  }
  
  .header-title {
    font-size: 1.3rem;
  }
  
  .header-btn {
    width: 36px;
    height: 36px;
  }
  
  .task-item {
    padding: 12px;
  }
  
  .task-input {
    font-size: 16px;
  }
  
  .calendar-day {
    font-size: 0.75rem;
  }
  
  .theme-options {
    grid-template-columns: 1fr;
  }
  
  .ai-panel {
    width: calc(100vw - 20px);
    right: 10px;
  }
  
  .dock {
    padding: 6px 10px;
    gap: 6px;
  }
  
  .dock-item {
    width: 36px;
    height: 36px;
    font-size: 0.9rem;
  }
}

/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: var(--background);
}

::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

/* Focus Styles for Accessibility */
a, button, input, select, .task-item, .calendar-day {
  --focus-ring-color: var(--primary);
}

:is(a, button, input, select, .task-item, .calendar-day):focus-visible {
  outline: 2px solid var(--focus-ring-color);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(139, 95, 191, 0.2);
}
</style>
</head>
<body class="theme-cozy">
<div class="app-container">
  <!-- Header -->
  <header class="main-header">
    <h1 class="header-title">
      <i class="fas fa-check-circle"></i>
      Chrono Focus Pro
    </h1>
    <div class="header-controls">
      <button class="header-btn" id="themeButton" title="Change Theme">
        <i class="fas fa-palette"></i>
      </button>
      <button class="header-btn" id="settingsButton" title="Settings">
        <i class="fas fa-cog"></i>
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="content-grid">
      <!-- Tasks Section -->
      <section class="tasks-section">
        <div class="tasks-header">
          <div class="task-input-container">
            <div class="task-input-wrapper">
              <textarea
                class="task-input"
                id="taskInput"
                placeholder="Add a new task..."
                rows="1"
              ></textarea>
            </div>
            <button class="add-task-btn" id="addTaskBtn">
              <i class="fas fa-plus"></i>
              Add
            </button>
          </div>
          <div class="task-options">
            <select class="task-option-select" id="taskPriority" aria-label="Task Priority">
              <option value="low">Low Priority</option>
              <option value="medium" selected>Medium Priority</option>
              <option value="high">High Priority</option>
            </select>
            <select class="task-option-select" id="taskCategory" aria-label="Task Category">
              <option value="general">📋 General</option>
              <option value="work">💼 Work</option>
              <option value="personal">👤 Personal</option>
              <option value="shopping">🛒 Shopping</option>
              <option value="health">❤️ Health</option>
              <option value="learning">📚 Learning</option>
            </select>
            <input type="date" class="task-option-select" id="taskDate" aria-label="Task Date">
          </div>
        </div>

        <div class="tasks-content">
          <div class="task-list-header">
            <div class="task-count" id="taskCount">0 tasks</div>
            <div class="task-filters">
              <button class="filter-btn active" data-filter="all">All</button>
              <button class="filter-btn" data-filter="pending">Active</button>
              <button class="filter-btn" data-filter="completed">Done</button>
            </div>
          </div>

          <ul class="tasks-list" id="tasksList"></ul>

          <div class="empty-state" id="emptyState">
            <i class="fas fa-clipboard-list"></i>
            <h3>No tasks yet</h3>
            <p>Add your first task to get started!</p>
          </div>
        </div>
      </section>

      <!-- Calendar Section -->
      <section class="calendar-section">
        <div class="calendar-header">
          <div class="calendar-top-controls">
            <div class="calendar-nav">
              <button id="prevMonth" aria-label="Previous Month"><i class="fas fa-chevron-left"></i></button>
              <div class="calendar-title" id="calendarTitle"></div>
              <button id="nextMonth" aria-label="Next Month"><i class="fas fa-chevron-right"></i></button>
            </div>
          </div>
          <button class="add-task-btn" id="todayBtn" style="padding: 8px 16px; font-size: 0.875rem;">Today</button>
        </div>
        <div class="calendar-grid">
          <div class="calendar-weekdays">
            <div class="calendar-weekday">Sun</div>
            <div class="calendar-weekday">Mon</div>
            <div class="calendar-weekday">Tue</div>
            <div class="calendar-weekday">Wed</div>
            <div class="calendar-weekday">Thu</div>
            <div class="calendar-weekday">Fri</div>
            <div class="calendar-weekday">Sat</div>
          </div>
          <div class="calendar-days" id="calendarDays"></div>
        </div>
      </section>
    </div>
  </main>
</div>

<!-- Dock -->
<div class="dock" id="dock">
  <div class="dock-item active" id="dockTasks" title="Tasks">
    <i class="fas fa-tasks"></i>
  </div>
  <div class="dock-item" id="dockCalendar" title="Calendar">
    <i class="fas fa-calendar"></i>
  </div>
  <div class="dock-item" id="dockAdd" title="Add Task">
    <i class="fas fa-plus"></i>
  </div>
  <div class="dock-item" id="dockAI" title="AI Assistant">
    <i class="fas fa-robot"></i>
  </div>
  <div class="dock-item" id="dockStats" title="Statistics">
    <i class="fas fa-chart-bar"></i>
  </div>
</div>

<!-- Settings Panel -->
<div class="settings-panel" id="settingsPanel">
  <div class="settings-header">
    <h2 class="settings-title">Settings</h2>
    <button class="close-settings" id="closeSettings">
      <i class="fas fa-times"></i>
    </button>
  </div>
  
  <div class="settings-section">
    <h3 class="settings-section-title">Appearance</h3>
    <div class="theme-options">
      <div class="theme-option active" data-theme="theme-cozy">
        <div class="theme-preview" style="background: linear-gradient(135deg, #8B5FBF, #E8DEF8);"></div>
        <div class="theme-name">Cozy</div>
      </div>
      <div class="theme-option" data-theme="theme-zen">
        <div class="theme-preview" style="background: linear-gradient(135deg, #4A7C59, #E8F5E9);"></div>
        <div class="theme-name">Zen</div>
      </div>
      <div class="theme-option" data-theme="theme-aurora">
        <div class="theme-preview" style="background: linear-gradient(135deg, #5D8AA8, #E3F2FD);"></div>
        <div class="theme-name">Aurora</div>
      </div>
    </div>
  </div>
  
  <div class="settings-section">
    <h3 class="settings-section-title">Notifications</h3>
    <div style="display: flex; flex-direction: column; gap: 12px;">
      <label style="display: flex; align-items: center; gap: 12px;">
        <input type="checkbox" id="taskNotifications" checked>
        <span>Task reminders</span>
      </label>
      <label style="display: flex; align-items: center; gap: 12px;">
        <input type="checkbox" id="dailyDigest" checked>
        <span>Daily digest</span>
      </label>
      <label style="display: flex; align-items: center; gap: 12px;">
        <input type="checkbox" id="soundEffects" checked>
        <span>Sound effects</span>
      </label>
    </div>
  </div>
  
  <div class="settings-section">
    <h3 class="settings-section-title">Data</h3>
    <div style="display: flex; flex-direction: column; gap: 12px;">
      <button class="task-option-select" id="exportData">Export Data</button>
      <button class="task-option-select" id="importData">Import Data</button>
      <button class="task-option-select" id="clearData" style="color: var(--danger);">Clear All Data</button>
    </div>
  </div>
</div>

<!-- AI Panel -->
<div class="ai-panel" id="aiPanel">
  <div class="ai-header">
    <h3 class="ai-title">Optichain Ultra</h3>
    <span class="ai-status">Online</span>
  </div>
  <div class="ai-messages" id="aiMessages">
    <div class="ai-message assistant">
      Hello! I'm Optichain Ultra, your AI assistant. How can I help you with your tasks today?
    </div>
  </div>
  <div class="ai-input-container">
    <input type="text" class="ai-input" id="aiInput" placeholder="Ask me anything...">
    <button class="ai-send" id="aiSend">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
  <div class="ai-commands">
    <div class="ai-command" data-command="find task">Find a task</div>
    <div class="ai-command" data-command="suggest tasks">Suggest tasks</div>
    <div class="ai-command" data-command="add task">Add a task</div>
    <div class="ai-command" data-command="stats">Show stats</div>
  </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<script>
class ChronoFocusPro {
  constructor() {
    this.currentDate = new Date();
    this.selectedDate = new Date();
    this.currentFilter = 'all';
    this.draggedTask = null;
    this.aiActive = false;

    this.initializeElements();
    this.setupEventListeners();
    this.loadTheme();
    this.renderCalendar();
    this.updateTasksView();
    this.autoResizeTextarea();
    this.setupDock();
  }

  initializeElements() {
    this.elements = {
      // Body
      body: document.body,
      
      // Header
      themeButton: document.getElementById('themeButton'),
      settingsButton: document.getElementById('settingsButton'),
      
      // Tasks
      taskInput: document.getElementById('taskInput'),
      addTaskBtn: document.getElementById('addTaskBtn'),
      taskPriority: document.getElementById('taskPriority'),
      taskCategory: document.getElementById('taskCategory'),
      taskDate: document.getElementById('taskDate'),
      tasksList: document.getElementById('tasksList'),
      taskCount: document.getElementById('taskCount'),
      filterBtns: document.querySelectorAll('.filter-btn'),
      emptyState: document.getElementById('emptyState'),
      
      // Calendar
      calendarTitle: document.getElementById('calendarTitle'),
      calendarDays: document.getElementById('calendarDays'),
      prevMonth: document.getElementById('prevMonth'),
      nextMonth: document.getElementById('nextMonth'),
      todayBtn: document.getElementById('todayBtn'),
      
      // Dock
      dock: document.getElementById('dock'),
      dockTasks: document.getElementById('dockTasks'),
      dockCalendar: document.getElementById('dockCalendar'),
      dockAdd: document.getElementById('dockAdd'),
      dockAI: document.getElementById('dockAI'),
      dockStats: document.getElementById('dockStats'),
      
      // Settings
      settingsPanel: document.getElementById('settingsPanel'),
      closeSettings: document.getElementById('closeSettings'),
      themeOptions: document.querySelectorAll('.theme-option'),
      
      // AI
      aiPanel: document.getElementById('aiPanel'),
      aiMessages: document.getElementById('aiMessages'),
      aiInput: document.getElementById('aiInput'),
      aiSend: document.getElementById('aiSend'),
      aiCommands: document.querySelectorAll('.ai-command'),
      
      // Toast
      toastContainer: document.getElementById('toastContainer')
    };
    
    // Set default date to today
    this.elements.taskDate.value = this.formatDate(new Date());
  }

  setupEventListeners() {
    // Task input and actions
    this.elements.taskInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        this.addTask();
      }
    });
    this.elements.addTaskBtn.addEventListener('click', () => this.addTask());

    // Filters
    this.elements.filterBtns.forEach(btn => {
      btn.addEventListener('click', () => this.setFilter(btn.dataset.filter));
    });

    // Calendar controls
    this.elements.prevMonth.addEventListener('click', () => this.changeMonth(-1));
    this.elements.nextMonth.addEventListener('click', () => this.changeMonth(1));
    this.elements.todayBtn.addEventListener('click', () => this.goToToday());

    // Theme selector
    this.elements.themeButton.addEventListener('click', () => this.toggleSettings());
    
    // Settings
    this.elements.settingsButton.addEventListener('click', () => this.toggleSettings());
    this.elements.closeSettings.addEventListener('click', () => this.toggleSettings());
    
    // Theme options
    this.elements.themeOptions.forEach(option => {
      option.addEventListener('click', () => {
        this.elements.themeOptions.forEach(opt => opt.classList.remove('active'));
        option.classList.add('active');
        this.setTheme(option.dataset.theme);
      });
    });

    // Dock items
    this.elements.dockTasks.addEventListener('click', () => this.scrollToTasks());
    this.elements.dockCalendar.addEventListener('click', () => this.scrollToCalendar());
    this.elements.dockAdd.addEventListener('click', () => this.focusTaskInput());
    this.elements.dockAI.addEventListener('click', () => this.toggleAIPanel());
    this.elements.dockStats.addEventListener('click', () => this.showStats());

    // AI Assistant
    this.elements.aiSend.addEventListener('click', () => this.sendAIMessage());
    this.elements.aiInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        this.sendAIMessage();
      }
    });
    
    // AI commands
    this.elements.aiCommands.forEach(command => {
      command.addEventListener('click', () => {
        const cmd = command.dataset.command;
        this.handleAICommand(cmd);
      });
    });
  }

  setupDock() {
    // Make dock responsive
    window.addEventListener('resize', () => {
      if (window.innerWidth < 480) {
        this.elements.dock.style.padding = '6px 10px';
        this.elements.dock.style.gap = '6px';
      } else if (window.innerWidth < 768) {
        this.elements.dock.style.padding = '8px 12px';
        this.elements.dock.style.gap = '8px';
      } else {
        this.elements.dock.style.padding = '12px 20px';
        this.elements.dock.style.gap = '16px';
      }
    });
  }

  // Task Methods
  addTask() {
    const text = this.elements.taskInput.value.trim();
    if (!text) {
      this.showToast('Please enter a task', 'error');
      return;
    }
    
    const task = {
      id: `task_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
      text,
      completed: false,
      priority: this.elements.taskPriority.value,
      category: this.elements.taskCategory.value,
      date: this.elements.taskDate.value || this.formatDate(new Date()),
      createdAt: new Date().toISOString(),
      notes: ''
    };
    
    const tasks = this.getTasks();
    tasks.push(task);
    this.saveTasks(tasks);
    
    this.elements.taskInput.value = '';
    this.elements.taskInput.style.height = 'auto';
    this.updateTasksView();
    this.renderCalendar();
    this.showToast('Task added!', 'success');
  }

  toggleTask(taskId) {
    const tasks = this.getTasks();
    const task = tasks.find(t => t.id === taskId);
    if (task) {
      task.completed = !task.completed;
      task.completedAt = task.completed ? new Date().toISOString() : null;
      this.saveTasks(tasks);
      this.updateTasksView();
      
      if(task.completed) {
        this.showToast('Task completed! 🎉', 'success');
      }
    }
  }

  deleteTask(taskId, taskElement) {
    if (confirm('Are you sure you want to delete this task?')) {
        taskElement.classList.add('fade-out');
        taskElement.addEventListener('animationend', () => {
            let tasks = this.getTasks();
            tasks = tasks.filter(t => t.id !== taskId);
            this.saveTasks(tasks);
            this.updateTasksView();
            this.renderCalendar();
            this.showToast('Task deleted', 'success');
        }, { once: true });
    }
  }

  editTask(taskId) {
    const tasks = this.getTasks();
    const task = tasks.find(t => t.id === taskId);
    if (task && !task.completed) {
      const newText = prompt('Edit task:', task.text);
      if (newText && newText.trim() && newText.trim() !== task.text) {
        task.text = newText.trim();
        this.saveTasks(tasks);
        this.updateTasksView();
        this.showToast('Task updated!', 'success');
      }
    }
  }

  // View Methods
  updateTasksView() {
    const tasks = this.getFilteredTasks();
    this.renderTasks(tasks);
  }

  getFilteredTasks() {
    let tasks = this.getTasks();
    
    if (this.currentFilter === 'pending') tasks = tasks.filter(task => !task.completed);
    else if (this.currentFilter === 'completed') tasks = tasks.filter(task => task.completed);
    
    tasks.sort((a, b) => {
        if (a.completed !== b.completed) return a.completed - b.completed;
        const priorityOrder = { high: 0, medium: 1, low: 2 };
        if (priorityOrder[a.priority] !== priorityOrder[b.priority]) return priorityOrder[a.priority] - priorityOrder[b.priority];
        return new Date(b.createdAt) - new Date(a.createdAt);
    });
    return tasks;
  }
  
  renderTasks(tasks) {
    this.elements.tasksList.innerHTML = '';
    this.updateTaskCount(tasks.length);

    if (tasks.length === 0) {
      this.elements.emptyState.style.display = 'block';
    } else {
      this.elements.emptyState.style.display = 'none';
      tasks.forEach(task => {
        this.elements.tasksList.appendChild(this.createTaskElement(task));
      });
    }
  }

  createTaskElement(task) {
    const li = document.createElement('li');
    li.className = 'task-item';
    li.dataset.taskId = task.id;
    if (task.completed) li.classList.add('completed');
    const categoryIcons = { general: '📋', work: '💼', personal: '👤', shopping: '🛒', health: '❤️', learning: '📚' };

    li.innerHTML = `
      <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-action="toggle"></div>
      <div class="task-content">
        <div class="task-text-content">
          <div class="task-text">${task.text}</div>
        </div>
        ${task.notes ? `<div class="task-notes">${task.notes}</div>` : ''}
        <div class="task-meta">
          <span class="task-priority ${task.priority}">${task.priority}</span>
          <span class="task-date"><i class="fas fa-calendar-alt"></i> ${new Date(task.date.replace(/-/g, '/')).toLocaleDateString()}</span>
          <span>${categoryIcons[task.category]} ${task.category.charAt(0).toUpperCase() + task.category.slice(1)}</span>
        </div>
      </div>
      <div class="task-actions">
        <button class="task-action-btn edit" data-action="edit" title="Edit"><i class="fas fa-edit"></i></button>
        <button class="task-action-btn delete" data-action="delete" title="Delete"><i class="fas fa-trash"></i></button>
      </div>
    `;

    li.addEventListener('click', (e) => {
        const actionTarget = e.target.closest('[data-action]');
        if (!actionTarget) return;
        const action = actionTarget.dataset.action;
        
        if (action === 'toggle') this.toggleTask(task.id);
        else if (action === 'edit') this.editTask(task.id);
        else if (action === 'delete') this.deleteTask(task.id, li);
    });

    return li;
  }

  setFilter(filter) {
    this.currentFilter = filter;
    this.elements.filterBtns.forEach(btn => btn.classList.toggle('active', btn.dataset.filter === filter));
    this.updateTasksView();
  }

  // Calendar Methods
  renderCalendar() {
    const year = this.currentDate.getFullYear();
    const month = this.currentDate.getMonth();
    this.elements.calendarTitle.textContent = new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
    this.elements.calendarDays.innerHTML = '';
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const daysInPrevMonth = new Date(year, month, 0).getDate();

    for (let i = firstDay; i > 0; i--) {
        const day = daysInPrevMonth - i + 1;
        this.elements.calendarDays.appendChild(this.createCalendarDay(day, true, new Date(year, month - 1, day)));
    }
    for (let day = 1; day <= daysInMonth; day++) {
        this.elements.calendarDays.appendChild(this.createCalendarDay(day, false, new Date(year, month, day)));
    }
    const gridCells = this.elements.calendarDays.children.length;
    const remainingCells = gridCells > 35 ? 42 - gridCells : 35 - gridCells;
    for (let day = 1; day <= remainingCells; day++) {
      this.elements.calendarDays.appendChild(this.createCalendarDay(day, true, new Date(year, month + 1, day)));
    }
  }

  createCalendarDay(day, isOtherMonth, fullDate) {
    const dayElement = document.createElement('div');
    dayElement.className = 'calendar-day';
    dayElement.textContent = day;

    if (isOtherMonth) dayElement.classList.add('other-month');

    const today = new Date();
    if (this.isSameDate(fullDate, today)) dayElement.classList.add('today');
    if (this.isSameDate(fullDate, this.selectedDate)) dayElement.classList.add('selected');

    if (this.getTasksForDate(fullDate).length > 0) dayElement.classList.add('has-tasks');

    dayElement.addEventListener('click', () => {
      this.selectDate(fullDate);
    });

    return dayElement;
  }

  selectDate(date) {
    this.selectedDate = new Date(date);
    this.elements.taskDate.value = this.formatDate(this.selectedDate);
    this.updateTasksView();
    this.renderCalendar();
  }

  changeMonth(delta) {
    this.currentDate.setMonth(this.currentDate.getMonth() + delta);
    this.renderCalendar();
  }

  goToToday() {
    this.currentDate = new Date();
    this.selectedDate = new Date();
    this.elements.taskDate.value = this.formatDate(new Date());
    this.updateTasksView();
    this.renderCalendar();
  }

  // Dock Methods
  scrollToTasks() {
    document.querySelector('.tasks-section').scrollIntoView({ behavior: 'smooth' });
  }

  scrollToCalendar() {
    document.querySelector('.calendar-section').scrollIntoView({ behavior: 'smooth' });
  }

  focusTaskInput() {
    this.elements.taskInput.focus();
  }

  showStats() {
    const tasks = this.getTasks();
    const completed = tasks.filter(t => t.completed).length;
    const pending = tasks.filter(t => !t.completed).length;
    
    this.showToast(`You have ${pending} pending and ${completed} completed tasks`, 'success');
  }

  // AI Assistant Methods
  toggleAIPanel() {
    this.elements.aiPanel.classList.toggle('visible');
    this.aiActive = !this.aiActive;
    
    if (this.aiActive) {
      this.elements.aiInput.focus();
    }
  }

  sendAIMessage() {
    const message = this.elements.aiInput.value.trim();
    if (!message) return;
    
    // Add user message
    this.addAIMessage(message, 'user');
    this.elements.aiInput.value = '';
    
    // Process and respond
    setTimeout(() => {
      this.processAIMessage(message);
    }, 500);
  }

  addAIMessage(text, sender) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `ai-message ${sender}`;
    messageDiv.textContent = text;
    this.elements.aiMessages.appendChild(messageDiv);
    this.elements.aiMessages.scrollTop = this.elements.aiMessages.scrollHeight;
  }

  processAIMessage(message) {
    const lowerMessage = message.toLowerCase();
    let response = "I'm not sure how to help with that. Try asking me to find a task, suggest tasks, add a task, or show stats.";
    
    if (lowerMessage.includes('find') || lowerMessage.includes('search') || lowerMessage.includes('look')) {
      response = this.handleFindTask(message);
    } else if (lowerMessage.includes('suggest') || lowerMessage.includes('recommend')) {
      response = this.handleSuggestTasks(message);
    } else if (lowerMessage.includes('add') || lowerMessage.includes('create') || lowerMessage.includes('new task')) {
      response = this.handleAddTask(message);
    } else if (lowerMessage.includes('stat') || lowerMessage.includes('progress')) {
      response = this.handleShowStats(message);
    } else if (lowerMessage.includes('help') || lowerMessage.includes('what can you do')) {
      response = "I can help you:\n- Find tasks by name or date\n- Suggest tasks based on your habits\n- Add new tasks\n- Show your task statistics\n- And more! Just ask!";
    }
    
    this.addAIMessage(response, 'assistant');
  }

  handleAICommand(command) {
    let message = "";
    
    switch(command) {
      case 'find task':
        message = "Find tasks for today";
        break;
      case 'suggest tasks':
        message = "Suggest some tasks";
        break;
      case 'add task':
        message = "Add a task to exercise";
        break;
      case 'stats':
        message = "Show my stats";
        break;
    }
    
    this.elements.aiInput.value = message;
    this.sendAIMessage();
  }

  handleFindTask(message) {
    const tasks = this.getTasks();
    const lowerMessage = message.toLowerCase();
    
    // Try to extract date information
    let dateFilter = null;
    if (lowerMessage.includes('today')) {
      dateFilter = this.formatDate(new Date());
    } else if (lowerMessage.includes('yesterday')) {
      const yesterday = new Date();
      yesterday.setDate(yesterday.getDate() - 1);
      dateFilter = this.formatDate(yesterday);
    } else if (lowerMessage.includes('tomorrow')) {
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      dateFilter = this.formatDate(tomorrow);
    }
    
    // Filter tasks
    let filteredTasks = tasks;
    if (dateFilter) {
      filteredTasks = tasks.filter(task => task.date === dateFilter);
    }
    
    // Also filter by text if present
    const textParts = message.split(' ').filter(word => 
      !['find', 'search', 'look', 'for', 'task', 'tasks', 'today', 'yesterday', 'tomorrow'].includes(word.toLowerCase())
    );
    
    if (textParts.length > 0) {
      const searchText = textParts.join(' ').toLowerCase();
      filteredTasks = filteredTasks.filter(task => 
        task.text.toLowerCase().includes(searchText)
      );
    }
    
    if (filteredTasks.length === 0) {
      return "I couldn't find any tasks matching your search.";
    }
    
    let response = `I found ${filteredTasks.length} task(s):\n`;
    filteredTasks.slice(0, 5).forEach(task => {
      const status = task.completed ? "✓ Completed" : "○ Pending";
      response += `- "${task.text}" (${status}, ${task.date})\n`;
    });
    
    if (filteredTasks.length > 5) {
      response += `... and ${filteredTasks.length - 5} more tasks.`;
    }
    
    return response;
  }

  handleSuggestTasks(message) {
    const suggestions = [
      "Review your weekly goals",
      "Plan meals for the next few days",
      "Organize your workspace",
      "Schedule time for exercise",
      "Backup important files",
      "Clean out your email inbox",
      "Update your resume or portfolio",
      "Learn something new for 15 minutes",
      "Call a friend or family member",
      "Meditate for 10 minutes"
    ];
    
    let response = "Here are some task suggestions:\n";
    suggestions.forEach((suggestion, index) => {
      response += `${index + 1}. ${suggestion}\n`;
    });
    
    return response;
  }

  handleAddTask(message) {
    // Extract task text from message
    const taskText = message.replace(/add|create|new task|task/gi, '').trim();
    
    if (!taskText) {
      return "Please specify what task you'd like to add.";
    }
    
    // Create the task
    const task = {
      id: `task_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
      text: taskText,
      completed: false,
      priority: 'medium',
      category: 'general',
      date: this.formatDate(new Date()),
      createdAt: new Date().toISOString(),
      notes: ''
    };
    
    const tasks = this.getTasks();
    tasks.push(task);
    this.saveTasks(tasks);
    this.updateTasksView();
    this.renderCalendar();
    
    return `Added task: "${taskText}" for today`;
  }

  handleShowStats(message) {
    const tasks = this.getTasks();
    const completed = tasks.filter(t => t.completed).length;
    const pending = tasks.filter(t => !t.completed).length;
    const total = tasks.length;
    
    const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
    
    let response = `Your task statistics:\n`;
    response += `- Total tasks: ${total}\n`;
    response += `- Completed: ${completed}\n`;
    response += `- Pending: ${pending}\n`;
    response += `- Completion rate: ${completionRate}%\n`;
    
    if (pending > 0) {
      const highPriority = tasks.filter(t => !t.completed && t.priority === 'high').length;
      if (highPriority > 0) {
        response += `- High priority tasks pending: ${highPriority}`;
      }
    }
    
    return response;
  }

  // Settings Methods
  toggleSettings() {
    this.elements.settingsPanel.classList.toggle('open');
  }

  // Theme Methods
  setTheme(theme) {
    this.elements.body.className = theme;
    localStorage.setItem('chronoFocusProTheme', theme);
  }

  loadTheme() {
    const savedTheme = localStorage.getItem('chronoFocusProTheme') || 'theme-cozy';
    this.setTheme(savedTheme);
    
    // Update theme option active state
    this.elements.themeOptions.forEach(option => {
      option.classList.toggle('active', option.dataset.theme === savedTheme);
    });
  }

  // UI Helper Methods
  updateTaskCount(count) { this.elements.taskCount.textContent = `${count} task${count !== 1 ? 's' : ''}`; }
  autoResizeTextarea() {
    this.elements.taskInput.addEventListener('input', () => {
      this.elements.taskInput.style.height = 'auto';
      this.elements.taskInput.style.height = `${Math.min(this.elements.taskInput.scrollHeight, 120)}px`;
    });
  }

  // Toast Methods
  showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    this.elements.toastContainer.appendChild(toast);
    setTimeout(() => toast.classList.add('show'), 10);
    setTimeout(() => {
      toast.classList.remove('show');
      toast.addEventListener('transitionend', () => toast.remove(), { once: true });
    }, 3000);
  }
  
  // Data Methods
  getTasks() { return JSON.parse(localStorage.getItem('chronoFocusProTasks') || '[]'); }
  saveTasks(tasks) { localStorage.setItem('chronoFocusProTasks', JSON.stringify(tasks)); }
  getTasksForDate(date) {
    const dateStr = this.formatDate(date);
    return this.getTasks().filter(task => task.date === dateStr);
  }

  // Utility Methods
  formatDate(date) { return date.toISOString().split('T')[0]; }
  isSameDate(d1, d2) { return this.formatDate(d1) === this.formatDate(d2); }
}

document.addEventListener('DOMContentLoaded', () => {
  window.chronoFocusPro = new ChronoFocusPro();
});
</script>
</body>
</html>
