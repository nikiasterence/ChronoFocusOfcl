<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes App with OptiChain AI</title>
    <style>
        :root {
            --primary-color: #007AFF;
            --background-color: #f5f5f7;
            --text-color: #1d1d1f;
            --sidebar-bg: #f2f2f7;
            --note-bg: #ffffff;
            --border-color: #c6c6c8;
        }

        /* Theme Variables */
        .theme-cotton-candy {
            --primary-color: #FF9FF3;
            --background-color: #F8F9FA;
            --text-color: #2C2C54;
            --sidebar-bg: #FDEBF7;
            --note-bg: #FFFFFF;
            --border-color: #FFC8F0;
        }

        .theme-midnight {
            --primary-color: #5DADE2;
            --background-color: #1C2833;
            --text-color: #EAECEE;
            --sidebar-bg: #2C3E50;
            --note-bg: #34495E;
            --border-color: #5D6D7E;
        }

        .theme-golden {
            --primary-color: #D4AF37;
            --background-color: #FEF9E7;
            --text-color: #5D4037;
            --sidebar-bg: #FFF8E1;
            --note-bg: #FFFFFF;
            --border-color: #FFD54F;
        }

        .theme-extra-dark {
            --primary-color: #BB86FC;
            --background-color: #121212;
            --text-color: #E1E1E1;
            --sidebar-bg: #1E1E1E;
            --note-bg: #2D2D2D;
            --border-color: #383838;
        }

        .theme-white-blue {
            --primary-color: #007AFF;
            --background-color: #FFFFFF;
            --text-color: #1D1D1F;
            --sidebar-bg: #F2F2F7;
            --note-bg: #FFFFFF;
            --border-color: #C6C6C8;
        }

        .theme-blue {
            --primary-color: #0056CC;
            --background-color: #E6F2FF;
            --text-color: #003366;
            --sidebar-bg: #D1E7FF;
            --note-bg: #FFFFFF;
            --border-color: #99CCFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--note-bg);
        }

        .app-title {
            font-size: 22px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .app-title i {
            color: var(--primary-color);
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-selector {
            display: flex;
            gap: 10px;
        }

        .theme-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .theme-option.active {
            border-color: var(--text-color);
        }

        .theme-cotton-candy-option {
            background: linear-gradient(135deg, #FF9FF3, #F368E0);
        }

        .theme-midnight-option {
            background: linear-gradient(135deg, #1C2833, #2C3E50);
        }

        .theme-golden-option {
            background: linear-gradient(135deg, #D4AF37, #B8860B);
        }

        .theme-extra-dark-option {
            background: linear-gradient(135deg, #121212, #2D2D2D);
        }

        .theme-white-blue-option {
            background: linear-gradient(135deg, #FFFFFF, #007AFF);
        }

        .theme-blue-option {
            background: linear-gradient(135deg, #0056CC, #003366);
        }

        .ai-toggle-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .app-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .new-note-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .notes-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
        }

        .note-item {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .note-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .note-item.active {
            background-color: rgba(0, 122, 255, 0.1);
            border-left: 3px solid var(--primary-color);
        }

        .note-title {
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .note-preview {
            font-size: 13px;
            color: #8E8E93;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .note-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .note-header {
            padding: 15px 25px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .note-title-input {
            flex: 1;
            background: transparent;
            border: none;
            font-size: 20px;
            font-weight: 600;
            color: var(--text-color);
            outline: none;
        }

        .note-title-input::placeholder {
            color: #8E8E93;
        }

        .writing-tools {
            display: flex;
            gap: 10px;
            padding: 10px 25px;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--note-bg);
        }

        .tool-group {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 8px;
            background-color: var(--sidebar-bg);
        }

        .tool-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tool-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .tool-btn.active {
            background-color: var(--primary-color);
            color: white;
        }

        .font-select, .size-select {
            background-color: var(--sidebar-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            border-radius: 4px;
            padding: 4px 8px;
            outline: none;
        }

        .note-editor {
            flex: 1;
            padding: 20px 25px;
            overflow-y: auto;
            background-color: var(--note-bg);
        }

        .note-editor-content {
            min-height: 100%;
            outline: none;
            line-height: 1.6;
        }

        .note-editor-content img {
            max-width: 100%;
            border-radius: 8px;
            margin: 10px 0;
        }

        .ai-panel {
            width: 350px;
            background-color: var(--sidebar-bg);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .ai-panel.hidden {
            transform: translateX(100%);
            width: 0;
            border-left: none;
        }

        .ai-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-badge {
            background-color: var(--primary-color);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .ai-actions {
            padding: 15px 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .ai-action-btn {
            background-color: var(--note-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
        }

        .ai-action-btn:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .ai-output {
            flex: 1;
            padding: 15px 20px;
            overflow-y: auto;
            border-top: 1px solid var(--border-color);
        }

        .ai-response {
            background-color: var(--note-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-line;
        }

        .ai-prompt {
            display: flex;
            gap: 10px;
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
        }

        .ai-input {
            flex: 1;
            background-color: var(--note-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px 15px;
            color: var(--text-color);
            outline: none;
        }

        .ai-send-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hidden {
            display: none;
        }

        .emoji-picker {
            position: absolute;
            background: var(--note-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .emoji-option {
            padding: 5px;
            cursor: pointer;
            text-align: center;
            border-radius: 4px;
        }

        .emoji-option:hover {
            background-color: var(--sidebar-bg);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .ai-panel {
                width: 300px;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 200px;
            }
            
            .ai-panel {
                width: 100%;
                height: 300px;
            }
        }
    </style>
</head>
<body class="theme-cotton-candy">
    <div class="app-header">
        <div class="app-title">
            <i>📝</i> Notes with OptiChain AI
        </div>
        <div class="header-controls">
            <div class="theme-selector" id="themeSelector">
                <div class="theme-option theme-cotton-candy-option active" data-theme="cotton-candy"></div>
                <div class="theme-option theme-midnight-option" data-theme="midnight"></div>
                <div class="theme-option theme-golden-option" data-theme="golden"></div>
                <div class="theme-option theme-extra-dark-option" data-theme="extra-dark"></div>
                <div class="theme-option theme-white-blue-option" data-theme="white-blue"></div>
                <div class="theme-option theme-blue-option" data-theme="blue"></div>
            </div>
            <button class="ai-toggle-btn" id="aiToggleBtn">
                <i>🤖</i> AI Assistant
            </button>
        </div>
    </div>

    <div class="app-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>All Notes</h3>
                <button class="new-note-btn" id="newNoteBtn">
                    <i>+</i> New Note
                </button>
            </div>
            <div class="notes-list" id="notesList">
                <!-- Notes will be dynamically added here -->
            </div>
        </div>

        <div class="note-content">
            <div class="note-header">
                <input type="text" class="note-title-input" id="noteTitle" placeholder="Note Title">
            </div>
            <div class="writing-tools">
                <div class="tool-group">
                    <select class="font-select" id="fontSelect">
                        <option value="Arial">Arial</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Verdana">Verdana</option>
                    </select>
                </div>
                <div class="tool-group">
                    <select class="size-select" id="sizeSelect">
                        <option value="12px">Small</option>
                        <option value="16px" selected>Medium</option>
                        <option value="20px">Large</option>
                        <option value="24px">X-Large</option>
                    </select>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-command="bold" title="Bold">
                        <b>B</b>
                    </button>
                    <button class="tool-btn" data-command="italic" title="Italic">
                        <i>I</i>
                    </button>
                    <button class="tool-btn" data-command="underline" title="Underline">
                        <u>U</u>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" id="insertImage" title="Insert Image">
                        📷
                    </button>
                    <button class="tool-btn" id="insertEmoji" title="Insert Emoji">
                        😊
                    </button>
                </div>
            </div>
            <div class="note-editor">
                <div class="note-editor-content" id="noteEditor" contenteditable="true">
                    <!-- Note content will be edited here -->
                </div>
            </div>
        </div>

        <div class="ai-panel hidden" id="aiPanel">
            <div class="ai-header">
                <div class="ai-title">
                    <i>🤖</i> OptiChain AI <span class="ai-badge">Beta 2.1</span>
                </div>
            </div>
            <div class="ai-actions">
                <button class="ai-action-btn" data-action="find">
                    <i>🔍</i> Find in Note
                </button>
                <button class="ai-action-btn" data-action="grammar">
                    <i>✏️</i> Fix Grammar
                </button>
                <button class="ai-action-btn" data-action="keynotes">
                    <i>📋</i> Create Key Notes
                </button>
                <button class="ai-action-btn" data-action="summarize-small">
                    <i>📄</i> Summarize (Small)
                </button>
                <button class="ai-action-btn" data-action="summarize-medium">
                    <i>📄</i> Summarize (Medium)
                </button>
                <button class="ai-action-btn" data-action="summarize-large">
                    <i>📄</i> Summarize (Large)
                </button>
            </div>
            <div class="ai-output" id="aiOutput">
                <!-- AI responses will appear here -->
            </div>
            <div class="ai-prompt">
                <input type="text" class="ai-input" id="aiInput" placeholder="Ask OptiChain AI...">
                <button class="ai-send-btn" id="aiSendBtn">
                    <i>➤</i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Notes data structure
        let notes = JSON.parse(localStorage.getItem('notes')) || [];
        let currentNoteId = null;
        let aiPanelVisible = false;

        // DOM Elements
        const notesList = document.getElementById('notesList');
        const noteTitle = document.getElementById('noteTitle');
        const noteEditor = document.getElementById('noteEditor');
        const newNoteBtn = document.getElementById('newNoteBtn');
        const themeSelector = document.getElementById('themeSelector');
        const themeOptions = document.querySelectorAll('.theme-option');
        const aiToggleBtn = document.getElementById('aiToggleBtn');
        const aiPanel = document.getElementById('aiPanel');
        const toolBtns = document.querySelectorAll('.tool-btn');
        const fontSelect = document.getElementById('fontSelect');
        const sizeSelect = document.getElementById('sizeSelect');
        const insertImageBtn = document.getElementById('insertImage');
        const insertEmojiBtn = document.getElementById('insertEmoji');
        const aiActionBtns = document.querySelectorAll('.ai-action-btn');
        const aiOutput = document.getElementById('aiOutput');
        const aiInput = document.getElementById('aiInput');
        const aiSendBtn = document.getElementById('aiSendBtn');

        // Initialize the app
        function init() {
            renderNotesList();
            setupEventListeners();
            
            // Select first note if available
            if (notes.length > 0) {
                selectNote(notes[0].id);
            } else {
                createNewNote();
            }
        }

        // Set up event listeners
        function setupEventListeners() {
            // Theme selection
            themeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const theme = option.getAttribute('data-theme');
                    document.body.className = `theme-${theme}`;
                    
                    // Update active theme indicator
                    themeOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    
                    // Hide theme selector after selection
                    themeSelector.style.display = 'none';
                });
            });

            // AI toggle button
            aiToggleBtn.addEventListener('click', toggleAIPanel);

            // New note button
            newNoteBtn.addEventListener('click', createNewNote);

            // Note title input
            noteTitle.addEventListener('input', saveNote);

            // Note editor content
            noteEditor.addEventListener('input', saveNote);

            // Text formatting buttons
            toolBtns.forEach(btn => {
                if (btn.getAttribute('data-command')) {
                    btn.addEventListener('click', () => {
                        const command = btn.getAttribute('data-command');
                        document.execCommand(command, false, null);
                        noteEditor.focus();
                    });
                }
            });

            // Font and size selection
            fontSelect.addEventListener('change', () => {
                document.execCommand('fontName', false, fontSelect.value);
                noteEditor.focus();
            });

            sizeSelect.addEventListener('change', () => {
                document.execCommand('fontSize', false, '7'); // This is a hack for font size
                // Apply the actual size via CSS
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const selectedText = range.extractContents();
                    const span = document.createElement('span');
                    span.style.fontSize = sizeSelect.value;
                    span.appendChild(selectedText);
                    range.insertNode(span);
                }
                noteEditor.focus();
            });

            // Insert image
            insertImageBtn.addEventListener('click', () => {
                const url = prompt('Enter image URL:');
                if (url) {
                    document.execCommand('insertImage', false, url);
                }
            });

            // Insert emoji
            insertEmojiBtn.addEventListener('click', showEmojiPicker);

            // AI actions
            aiActionBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const action = btn.getAttribute('data-action');
                    handleAIAction(action);
                });
            });

            // AI send button
            aiSendBtn.addEventListener('click', handleAIChat);
            aiInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleAIChat();
                }
            });
        }

        // Toggle AI panel visibility
        function toggleAIPanel() {
            aiPanelVisible = !aiPanelVisible;
            if (aiPanelVisible) {
                aiPanel.classList.remove('hidden');
                aiToggleBtn.innerHTML = '<i>🤖</i> Hide AI';
            } else {
                aiPanel.classList.add('hidden');
                aiToggleBtn.innerHTML = '<i>🤖</i> AI Assistant';
            }
        }

        // Show emoji picker
        function showEmojiPicker() {
            // Remove existing emoji picker if any
            const existingPicker = document.querySelector('.emoji-picker');
            if (existingPicker) {
                existingPicker.remove();
                return;
            }

            // Create emoji picker
            const emojiPicker = document.createElement('div');
            emojiPicker.className = 'emoji-picker';
            
            // Position the picker near the emoji button
            const emojiBtnRect = insertEmojiBtn.getBoundingClientRect();
            emojiPicker.style.position = 'absolute';
            emojiPicker.style.top = `${emojiBtnRect.bottom + window.scrollY}px`;
            emojiPicker.style.left = `${emojiBtnRect.left + window.scrollX}px`;
            
            // Common emojis
            const emojis = ['😀', '😃', '😄', '😁', '😆', '😅', '😂', '🤣', '😊', '😇', '🙂', '🙃', '😉', '😌', '😍', '🥰', '😘', '😗', '😙', '😚', '😋', '😛', '😝', '😜', '🤪', '🤨', '🧐', '🤓', '😎', '🤩', '🥳', '😏', '😒', '😞', '😔', '😟', '😕', '🙁', '☹️', '😣', '😖', '😫', '😩', '🥺', '😢', '😭', '😤', '😠', '😡', '🤬', '🤯', '😳', '🥵', '🥶', '😱', '😨', '😰', '😥', '😓', '🤗', '🤔', '🤭', '🤫', '🤥', '😶', '😐', '😑', '😬', '🙄', '😯', '😦', '😧', '😮', '😲', '🥱', '😴', '🤤', '😪', '😵', '🤐', '🥴', '🤢', '🤮', '🤧', '😷', '🤒', '🤕', '🤑', '🤠', '😈', '👿', '👹', '👺', '🤡', '💩', '👻', '💀', '☠️', '👽', '👾', '🤖', '🎃', '😺', '😸', '😹', '😻', '😼', '😽', '🙀', '😿', '😾'];
            
            // Add emojis to picker
            emojis.forEach(emoji => {
                const emojiOption = document.createElement('div');
                emojiOption.className = 'emoji-option';
                emojiOption.textContent = emoji;
                emojiOption.addEventListener('click', () => {
                    insertEmoji(emoji);
                    emojiPicker.remove();
                });
                emojiPicker.appendChild(emojiOption);
            });
            
            document.body.appendChild(emojiPicker);
            
            // Close picker when clicking outside
            document.addEventListener('click', function closePicker(e) {
                if (!emojiPicker.contains(e.target) && e.target !== insertEmojiBtn) {
                    emojiPicker.remove();
                    document.removeEventListener('click', closePicker);
                }
            });
        }

        // Insert emoji at cursor position
        function insertEmoji(emoji) {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                range.deleteContents();
                const textNode = document.createTextNode(emoji);
                range.insertNode(textNode);
                range.setStartAfter(textNode);
                range.setEndAfter(textNode);
                selection.removeAllRanges();
                selection.addRange(range);
            }
            noteEditor.focus();
        }

        // Create a new note
        function createNewNote() {
            const newNote = {
                id: Date.now().toString(),
                title: 'Untitled Note',
                content: '',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            notes.unshift(newNote);
            saveNotesToStorage();
            renderNotesList();
            selectNote(newNote.id);
        }

        // Select a note to edit
        function selectNote(noteId) {
            currentNoteId = noteId;
            const note = notes.find(n => n.id === noteId);
            
            if (note) {
                noteTitle.value = note.title;
                noteEditor.innerHTML = note.content;
                
                // Update active note in list
                document.querySelectorAll('.note-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-id') === noteId) {
                        item.classList.add('active');
                    }
                });
            }
        }

        // Save the current note
        function saveNote() {
            if (!currentNoteId) return;
            
            const noteIndex = notes.findIndex(n => n.id === currentNoteId);
            if (noteIndex !== -1) {
                notes[noteIndex].title = noteTitle.value;
                notes[noteIndex].content = noteEditor.innerHTML;
                notes[noteIndex].updatedAt = new Date().toISOString();
                
                saveNotesToStorage();
                renderNotesList();
            }
        }

        // Save notes to localStorage
        function saveNotesToStorage() {
            localStorage.setItem('notes', JSON.stringify(notes));
        }

        // Render the notes list
        function renderNotesList() {
            notesList.innerHTML = '';
            
            notes.forEach(note => {
                const noteItem = document.createElement('div');
                noteItem.className = 'note-item';
                noteItem.setAttribute('data-id', note.id);
                
                // Create a preview of the content (text only)
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = note.content;
                const textContent = tempDiv.textContent || tempDiv.innerText || '';
                const preview = textContent.substring(0, 50) + (textContent.length > 50 ? '...' : '');
                
                noteItem.innerHTML = `
                    <div class="note-title">${note.title || 'Untitled Note'}</div>
                    <div class="note-preview">${preview || 'Empty note'}</div>
                `;
                
                noteItem.addEventListener('click', () => selectNote(note.id));
                notesList.appendChild(noteItem);
            });
        }

        // Handle AI actions
        function handleAIAction(action) {
            const noteContent = noteEditor.textContent || noteEditor.innerText;
            
            if (!noteContent.trim()) {
                addAIResponse('Please add some content to your note first.');
                return;
            }
            
            let response = '';
            
            switch(action) {
                case 'find':
                    const searchTerm = prompt('What would you like to find in your note?');
                    if (searchTerm) {
                        // Count occurrences
                        const regex = new RegExp(searchTerm, 'gi');
                        const matches = noteContent.match(regex);
                        const count = matches ? matches.length : 0;
                        
                        if (count > 0) {
                            response = `I found "${searchTerm}" ${count} time(s) in your note.`;
                        } else {
                            response = `I couldn't find "${searchTerm}" in your note.`;
                        }
                    }
                    break;
                    
                case 'grammar':
                    // Simple grammar check simulation
                    const sentences = noteContent.split(/[.!?]+/).filter(s => s.trim().length > 0);
                    const issues = [];
                    
                    if (sentences.length > 0) {
                        // Check for capitalization
                        if (!/^[A-Z]/.test(sentences[0].trim())) {
                            issues.push("First sentence should start with a capital letter");
                        }
                        
                        // Check for common issues
                        if (noteContent.includes(' alot ')) {
                            issues.push("Use 'a lot' instead of 'alot'");
                        }
                        
                        if (noteContent.includes(' its ') && !noteContent.includes(" it's ")) {
                            issues.push("Check usage of 'its' vs 'it's'");
                        }
                        
                        if (issues.length === 0) {
                            issues.push("No major grammar issues found. Your writing looks good!");
                        }
                    } else {
                        issues.push("Not enough content to analyze grammar");
                    }
                    
                    response = "Grammar Check Results:\n\n" + issues.map((issue, i) => `${i+1}. ${issue}`).join('\n');
                    break;
                    
                case 'keynotes':
                    // Extract key points (simplified)
                    const lines = noteContent.split('\n').filter(line => line.trim().length > 10);
                    const keyPoints = lines.slice(0, 5).map((line, i) => `• ${line.substring(0, 50)}${line.length > 50 ? '...' : ''}`);
                    
                    if (keyPoints.length > 0) {
                        response = "Key Points from Your Note:\n\n" + keyPoints.join('\n');
                    } else {
                        response = "I couldn't identify clear key points. Try adding more content or structure to your note.";
                    }
                    break;
                    
                case 'summarize-small':
                    response = "Small Summary:\n\n" + 
                               generateSummary(noteContent, 1);
                    break;
                    
                case 'summarize-medium':
                    response = "Medium Summary:\n\n" + 
                               generateSummary(noteContent, 2);
                    break;
                    
                case 'summarize-large':
                    response = "Detailed Summary:\n\n" + 
                               generateSummary(noteContent, 3);
                    break;
            }
            
            if (response) {
                addAIResponse(response);
            }
        }

        // Generate a summary based on content length
        function generateSummary(content, level) {
            const sentences = content.split(/[.!?]+/).filter(s => s.trim().length > 0);
            
            if (sentences.length === 0) {
                return "Not enough content to summarize.";
            }
            
            let summaryLength;
            switch(level) {
                case 1: summaryLength = Math.min(1, sentences.length); break;
                case 2: summaryLength = Math.min(3, sentences.length); break;
                case 3: summaryLength = Math.min(5, sentences.length); break;
                default: summaryLength = 2;
            }
            
            return sentences.slice(0, summaryLength).map(s => `• ${s.trim()}`).join('\n');
        }

        // Handle AI chat
        function handleAIChat() {
            const prompt = aiInput.value.trim();
            if (!prompt) return;
            
            addAIResponse(`You: ${prompt}`, 'user');
            aiInput.value = '';
            
            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'ai-response';
            typingIndicator.textContent = 'OptiChain AI is thinking...';
            typingIndicator.style.fontStyle = 'italic';
            typingIndicator.style.color = '#8E8E93';
            aiOutput.appendChild(typingIndicator);
            aiOutput.scrollTop = aiOutput.scrollHeight;
            
            // Simulate AI thinking
            setTimeout(() => {
                typingIndicator.remove();
                
                let response = "I'm OptiChain AI Beta 2.1. I can help you with your notes by finding information, fixing grammar, creating key notes, and summarizing content. How can I assist you with your current note?";
                
                const lowerPrompt = prompt.toLowerCase();
                
                if (lowerPrompt.includes('hello') || lowerPrompt.includes('hi') || lowerPrompt.includes('hey')) {
                    response = "Hello! I'm OptiChain AI. How can I help you with your notes today?";
                } else if (lowerPrompt.includes('thank')) {
                    response = "You're welcome! Is there anything else I can help you with?";
                } else if (lowerPrompt.includes('note') && lowerPrompt.includes('create')) {
                    response = "To create a new note, click the 'New Note' button in the sidebar. You can then give it a title and start adding content.";
                } else if (lowerPrompt.includes('theme') || lowerPrompt.includes('color')) {
                    response = "You can change the theme using the color dots in the top right corner. We have several themes available including Cotton Candy, Midnight, Golden, Extra Dark, White & Blue, and Blue themes.";
                } else if (lowerPrompt.includes('emoji')) {
                    response = "To insert emojis, click the smiley face button in the writing tools. A picker will appear with various emojis you can add to your note.";
                } else if (lowerPrompt.includes('help')) {
                    response = "I can help you with:\n• Finding text in your notes\n• Checking grammar\n• Creating key points\n• Summarizing content\n• Answering questions about the app\n\nJust ask or use one of the action buttons!";
                } else if (lowerPrompt.includes('how are you')) {
                    response = "I'm functioning well, thank you for asking! Ready to help you with your notes.";
                } else if (lowerPrompt.includes('what can you do')) {
                    response = "I can help you with various note-related tasks:\n• Find specific text in your notes\n• Check grammar and suggest improvements\n• Extract key points from your content\n• Create summaries of different lengths\n• Answer questions about using the app\n\nTry one of the action buttons or ask me anything!";
                }
                
                addAIResponse(`OptiChain AI: ${response}`, 'ai');
            }, 1500);
        }

        // Add AI response to the output area
        function addAIResponse(text, type = 'ai') {
            const responseEl = document.createElement('div');
            responseEl.className = 'ai-response';
            
            if (type === 'user') {
                responseEl.style.backgroundColor = 'var(--primary-color)';
                responseEl.style.color = 'white';
                responseEl.textContent = text;
            } else {
                responseEl.innerHTML = text.replace(/\n/g, '<br>');
            }
            
            aiOutput.appendChild(responseEl);
            aiOutput.scrollTop = aiOutput.scrollHeight;
        }

        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
